"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[356],{3356:(ne,y,c)=>{c.r(y),c.d(y,{QrGeneratorModule:()=>W});var m=c(6895),Q=c(100),e=c(4650),d=c(529),M=c(4004);let k=(()=>{class o{constructor(t){this.http=t,this.headers=new d.WM({"Content-Type":"application/json"})}shorten(t,n){let a="";return n&&(a=`&alias=${encodeURIComponent(n)}`),this.http.get("https://tinyurl.com/api-create.php?url="+encodeURIComponent(t)+a,{headers:this.headers,responseType:"text"}).pipe((0,M.U)(r=>r.toString()))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(d.eN))},o.\u0275prov=(0,e.Yz7)({factory:function(){return new o((0,e.LFG)(d.eN))},token:o,providedIn:"root"}),o})(),D=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.JF]}),o})();var g=c(9549),p=c(4006),C=c(7392),v=c(1572),Z=c(266),f=c(4392),h=c(7206),b=c(6051);const x=[{key:"journey",label:"S\u1ed5 tay h\xe0nh tr\xecnh",disabled:!1}];var A=c(7009),J=c(5930),E=c(4144),T=c(9101),_=c(3848),I=c(4385),G=c(3238);function N(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyLink(a.qrData))}),e.TgZ(1,"mat-icon"),e._uU(2,"link"),e.qZA()()}2&o&&e.Q6J("matTooltip","Sao ch\xe9p li\xean k\u1ebft")}function q(o,i){if(1&o&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.error)}}function U(o,i){1&o&&(e.TgZ(0,"div",17),e._UZ(1,"mat-spinner"),e.qZA())}function R(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"qrcode",18,19),e.TgZ(3,"div",16)(4,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.MAs(2),r=e.oxw();return e.KtG(r.saveAsImage(a))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("qrdata",t.qrData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}function S(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyLink(a.checkInQRData))}),e.TgZ(1,"mat-icon"),e._uU(2,"link"),e.qZA()()}2&o&&e.Q6J("matTooltip","Sao ch\xe9p li\xean k\u1ebft")}function w(o,i){if(1&o&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",null==t?null:t.key)("disabled",null==t?null:t.disabled),e.xp6(1),e.Oqu(null==t?null:t.label)}}function L(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",22)(1,"mat-label"),e._uU(2,"\u0110\u1ecba \u0111i\u1ec3m m\u1edbi"),e.qZA(),e.TgZ(3,"input",23),e.NdJ("ngModelChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.addedMoreLocation=a)})("ngModelChange",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.generateCheckInQR())}),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("ngModel",t.addedMoreLocation)}}function F(o,i){if(1&o&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.checkInError)}}function B(o,i){1&o&&(e.TgZ(0,"div",17),e._UZ(1,"mat-spinner"),e.qZA())}function Y(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"qrcode",18,24),e.TgZ(3,"div",16)(4,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.MAs(2),r=e.oxw();return e.KtG(r.saveAsImage(a))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("qrdata",t.checkInQRData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}function O(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.copyLink(a.syncQRData))}),e.TgZ(1,"mat-icon"),e._uU(2,"link"),e.qZA()()}2&o&&e.Q6J("matTooltip","Sao ch\xe9p li\xean k\u1ebft")}function H(o,i){if(1&o&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",null==t?null:t.key)("disabled",null==t?null:t.disabled),e.xp6(1),e.Oqu(null==t?null:t.label)}}function $(o,i){if(1&o&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.syncError)}}function j(o,i){1&o&&(e.TgZ(0,"div",17),e._UZ(1,"mat-spinner"),e.qZA())}function K(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"qrcode",18,25),e.TgZ(3,"div",16)(4,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.MAs(2),r=e.oxw();return e.KtG(r.saveAsImage(a))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("qrdata",t.syncQRData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}const P=[{path:"",children:[{path:"",component:(()=>{class o{constructor(t,n,a,r){this.tinyUrl=t,this._snackBar=n,this.commonService=a,this.route=r,this.qrData=location.href,this.data=location.href,this.horizontalPosition="center",this.verticalPosition="bottom",this.durationInSeconds=3,this.error="",this.checkInError="",this.checkInQRData="",this.syncError="",this.syncQRData="",this.checkInTypes=b.g,this.checkInType="",this.syncTypes=x,this.loadingData=!1}ngOnInit(){window.history.state.selectedIndex&&(this.selectedIndex=parseInt(window.history.state.selectedIndex)),this.mergeLocalstorageVariable()}mergeLocalstorageVariable(){(()=>{let n=JSON.parse(localStorage.getItem("addedVariable")||"null")?.location;n&&n?.length>0&&(this.checkInTypes=this.checkInTypes.concat(n.map(a=>({key:a,label:a,disabled:!1}))))})()}convertBase64ToBlob(t){const n=t.split(";base64,"),a=n[0].split(":")[1],r=window.atob(n[1]),s=new Uint8Array(r.length);for(let l=0;l<r.length;++l)s[l]=r.charCodeAt(l);return new Blob([s],{type:a})}saveAsImage(t){let n=null;if(n=t.qrcElement.nativeElement.querySelector("canvas").toDataURL("image/png"),n){let a=this.convertBase64ToBlob(n);const r=new Blob([a],{type:"image/png"}),s=window.URL.createObjectURL(r),l=document.createElement("a");l.href=s,l.download=this.commonService.generatedSlug(`caodaion-qr-${0===this.selectedIndex?"0":1===this.selectedIndex?"checkin-"+this.addedMoreLocation||0:2===this.selectedIndex?"sync":""}`),l.click()}}copyLink(t){navigator.clipboard.writeText(t),this._snackBar.open("\u0110\xe3 sao ch\xe9p li\xean k\u1ebft","\u0110\xf3ng",{duration:1e3*this.durationInSeconds,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}onChangeData(){if(this.data?.length<=350)this.qrData=this.data;else{this.qrData="",this.error="";try{this.loadingData=!0,this.tinyUrl.shorten(this.data).subscribe(t=>{this.qrData=t,this.loadingData=!1})}catch(t){console.log(t),this.loadingData=!1,this.error="Kh\xf4 th\u1ec3 t\u1ea1o m\xe3 QR v\xec d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n qu\xe1 d\xe0i v\xe0 kh\xf4ng c\xf3 k\u1ebft n\u1ed1i m\u1ea1ng"}}}generaToken(t){const n=te=>{let u=h.enc.Base64.stringify(te);return u=u.replace(/=+$/,""),u=u.replace(/\+/g,"-"),u=u.replace(/\//g,"_"),u},s=n(h.enc.Utf8.parse(JSON.stringify({alg:"HS256",typ:"JWT"}))),V=n(h.enc.Utf8.parse(JSON.stringify(t))),X=h.HmacSHA512("caodaiondata","caodaionkey").toString();return`${s}.${V}.${btoa(X)}`}generateCheckInQR(){let n=`${location?.origin}`;if(n+="addMore"==this.checkInType&&this.addedMoreLocation?`/trang-chu/hanh-trinh?l=${this.generaToken(this.addedMoreLocation)}`:"tuGia"==this.checkInType?`/trang-chu/hanh-trinh?l=${this.checkInType}`:`/trang-chu/hanh-trinh?l=${this.generaToken(this.checkInType)}`,n?.length<=350)this.checkInQRData=n;else{this.checkInQRData="",this.checkInError="";try{this.loadingData=!0,this.tinyUrl.shorten(n).subscribe(a=>{this.loadingData=!1,this.checkInQRData=a})}catch(a){this.loadingData=!1,console.log(a),this.checkInError="Kh\xf4 th\u1ec3 t\u1ea1o m\xe3 QR v\xec d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n qu\xe1 d\xe0i v\xe0 kh\xf4ng c\xf3 k\u1ebft n\u1ed1i m\u1ea1ng"}}}generateSyncQR(){let t=null,n=`${location?.origin}/tac-vu/sync`;if(this.syncError="","journey"==this.syncType){const a=localStorage.getItem("journey");JSON.parse(a||"[]")?.length>0?n+=`?token=${this.generaToken({type:"journey",data:a})}`:this.syncError="S\u1ed5 tay h\xe0nh tr\xecnh ch\u01b0a c\xf3 ghi d\u1ea5u n\xe0o c\u1ea3."}else t={t:this.syncType},n+=`?token=${this.generaToken(t)}`;if(console.log(n),n?.length<=350)this.syncQRData=n;else{this.syncQRData="",this.syncError="";try{this.loadingData=!0,this.tinyUrl.shorten(n).subscribe(a=>{this.syncQRData=a,this.loadingData=!1})}catch(a){console.log(a),this.loadingData=!1,this.syncError="Kh\xf4 th\u1ec3 t\u1ea1o m\xe3 QR v\xec d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n qu\xe1 d\xe0i v\xe0 kh\xf4ng c\xf3 k\u1ebft n\u1ed1i m\u1ea1ng"}}}selectedTabChange(t){this.selectedIndex=t.index}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(k),e.Y36(A.ux),e.Y36(J.v),e.Y36(f.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-qr-generator"]],decls:59,vars:26,consts:[[1,"wrapper-container","qr-generator-container"],[1,"container-fluid"],[3,"selectedIndex","selectedTabChange"],[3,"label"],[1,"w-100"],["type","text","matInput","","disabled","",3,"ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",3,"matTooltip","click",4,"ngIf"],["type","text","matInput","",3,"ngModel","ngModelChange","change"],["class","text-center",4,"ngIf"],["class","w-100 d-flex justify-content-center",4,"ngIf"],[4,"ngIf"],[3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value"],["class","w-100",3,"appearance",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"matTooltip","click"],[1,"text-center"],[1,"w-100","d-flex","justify-content-center"],[3,"qrdata","width","imageHeight","imageWidth","cssClass","errorCorrectionLevel","colorDark","colorLight","elementType","margin","scale","imageSrc"],["parent",""],["mat-raised-button","","color","primary",3,"click"],[3,"value","disabled"],[1,"w-100",3,"appearance"],["type","text","matInput","",3,"ngModel","ngModelChange"],["checkIn",""],["sync",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1"),e._uU(3,"T\u1ea1o m\xe3 QR"),e.qZA()(),e.TgZ(4,"mat-tab-group",2),e.NdJ("selectedTabChange",function(r){return n.selectedTabChange(r)}),e.TgZ(5,"mat-tab",3)(6,"div",1)(7,"h2"),e._uU(8,"T\u1ea1o m\xe3 QR theo n\u1ed9i dung"),e.qZA(),e.TgZ(9,"mat-form-field",4)(10,"mat-label"),e._uU(11,"N\u1ed9i dung m\xe3"),e.qZA(),e.TgZ(12,"input",5),e.NdJ("ngModelChange",function(r){return n.qrData=r}),e.qZA(),e.YNc(13,N,3,1,"button",6),e.qZA(),e.TgZ(14,"mat-form-field",4)(15,"mat-label"),e._uU(16,"N\u1ed9i dung t\u1ea1o m\xe3"),e.qZA(),e.TgZ(17,"input",7),e.NdJ("ngModelChange",function(r){return n.data=r})("change",function(){return n.onChangeData()}),e.qZA()(),e.YNc(18,q,2,1,"p",8),e.YNc(19,U,2,0,"div",9),e.YNc(20,R,8,12,"div",10),e.qZA()(),e.TgZ(21,"mat-tab",3)(22,"div",1)(23,"h2"),e._uU(24,"T\u1ea1o m\xe3 QR check-in"),e.qZA(),e.TgZ(25,"mat-form-field",4)(26,"mat-label"),e._uU(27,"N\u1ed9i dung m\xe3"),e.qZA(),e.TgZ(28,"input",5),e.NdJ("ngModelChange",function(r){return n.checkInQRData=r}),e.qZA(),e.YNc(29,S,3,1,"button",6),e.qZA(),e.TgZ(30,"mat-form-field",4)(31,"mat-label"),e._uU(32,"\u0110\u1ecba \u0111i\u1ec3m check-in"),e.qZA(),e.TgZ(33,"mat-select",11),e.NdJ("ngModelChange",function(r){return n.checkInType=r})("ngModelChange",function(){return n.generateCheckInQR()}),e.YNc(34,w,2,3,"mat-option",12),e.TgZ(35,"mat-option",13),e._uU(36,"\u0110\u1ecba \u0111i\u1ec3m m\u1edbi"),e.qZA()()(),e.YNc(37,L,4,2,"mat-form-field",14),e.YNc(38,F,2,1,"p",8),e.YNc(39,B,2,0,"div",9),e.YNc(40,Y,8,12,"div",10),e.qZA()(),e.TgZ(41,"mat-tab",3)(42,"div",1)(43,"h2"),e._uU(44,"T\u1ea1o m\xe3 QR \u0111\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u"),e.qZA(),e.TgZ(45,"div")(46,"mat-form-field",4)(47,"mat-label"),e._uU(48,"N\u1ed9i dung m\xe3"),e.qZA(),e.TgZ(49,"input",5),e.NdJ("ngModelChange",function(r){return n.syncQRData=r}),e.qZA(),e.YNc(50,O,3,1,"button",6),e.qZA(),e.TgZ(51,"mat-form-field",4)(52,"mat-label"),e._uU(53,"Lo\u1ea1i \u0111\u1ed3ng b\u1ed9"),e.qZA(),e.TgZ(54,"mat-select",11),e.NdJ("ngModelChange",function(r){return n.syncType=r})("ngModelChange",function(){return n.generateSyncQR()}),e.YNc(55,H,2,3,"mat-option",12),e.qZA()()(),e.YNc(56,$,2,1,"p",8),e.YNc(57,j,2,0,"div",9),e.YNc(58,K,8,12,"div",10),e.qZA()()()()),2&t&&(e.xp6(4),e.Q6J("selectedIndex",n.selectedIndex),e.xp6(1),e.Q6J("label","T\u1ea0O M\xc3 QR THEO N\u1ed8I DUNG"),e.xp6(7),e.Q6J("ngModel",n.qrData),e.xp6(1),e.Q6J("ngIf",n.qrData),e.xp6(4),e.Q6J("ngModel",n.data),e.xp6(1),e.Q6J("ngIf",n.error),e.xp6(1),e.Q6J("ngIf",n.loadingData),e.xp6(1),e.Q6J("ngIf",!n.error&&n.qrData),e.xp6(1),e.Q6J("label","T\u1ea0O M\xc3 QR CHECK-IN"),e.xp6(7),e.Q6J("ngModel",n.checkInQRData),e.xp6(1),e.Q6J("ngIf",n.checkInQRData),e.xp6(4),e.Q6J("ngModel",n.checkInType),e.xp6(1),e.Q6J("ngForOf",n.checkInTypes),e.xp6(1),e.Q6J("value","addMore"),e.xp6(2),e.Q6J("ngIf","addMore"==n.checkInType),e.xp6(1),e.Q6J("ngIf",n.checkInError),e.xp6(1),e.Q6J("ngIf",n.loadingData),e.xp6(1),e.Q6J("ngIf",!n.checkInError&&n.checkInQRData),e.xp6(1),e.Q6J("label","T\u1ea0O M\xc3 QR \u0110\u1ed2NG B\u1ed8 D\u1eee LI\u1ec6U C\xc1 NH\xc2N"),e.xp6(8),e.Q6J("ngModel",n.syncQRData),e.xp6(1),e.Q6J("ngIf",n.syncQRData),e.xp6(4),e.Q6J("ngModel",n.syncType),e.xp6(1),e.Q6J("ngForOf",n.syncTypes),e.xp6(1),e.Q6J("ngIf",n.syncError),e.xp6(1),e.Q6J("ngIf",n.loadingData),e.xp6(1),e.Q6J("ngIf",!n.syncError&&n.syncQRData))},dependencies:[m.sg,m.O5,Q.V,g.KE,g.hX,g.R9,p.Fj,p.JJ,p.On,C.Hw,v.Ou,Z.gM,E.Nt,T.lW,T.RK,_.uX,_.SP,I.gD,G.ey],styles:[".qr-generator-container .mat-tab-body-content{padding:.5rem}  .qr-generator-container .mat-tab-body-wrapper{flex:1}  .qr-generator-container .mat-mdc-tab-group{flex:1;height:100%;overflow:hidden;background-color:#fff}"]}),o})()}]}];let z=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(P),f.Bz]}),o})(),W=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.ez,z,Q.N,D,g.lN,p.u5,C.Ps,v.Cq,Z.AV,E.c,T.ot,_.Nh,I.LD]}),o})()}}]);