"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[950],{5950:(kt,T,l)=>{l.r(T),l.d(T,{LibraryModule:()=>xt});var p=l(6895),u=l(4392),t=l(4650),v=l(2289),q=l(529);let Z=(()=>{class e{constructor(n){this.http=n}getStaticBooks(){return this.http.get("assets/documents/library/static-library.json")}getBookByKey(n){return this.http.get(`assets/documents/library/${n}.json`)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(q.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var F=l(6256),C=l(3848),d=l(3546),y=l(7392),m=l(9101),_=l(3267),b=l(9549),I=l(4144),h=l(4006),M=l(4850),J=l(6709),x=l(782);function P(e,a){if(1&e&&(t.TgZ(0,"mat-grid-tile",6)(1,"div",11)(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.qZA()(),t.TgZ(7,"mat-card-content")(8,"div",12),t._uU(9),t.qZA()()()()),2&e){const n=t.oxw().$implicit,o=t.oxw();t.Q6J("colspan",2===o.gridForYouCols?3:1)("rowspan",1),t.xp6(4),t.Oqu(null==n?null:n.name),t.xp6(2),t.Oqu(null==n?null:n.subtitle),t.xp6(3),t.Oqu((null==n||null==n.description?null:n.description.length)>290?(null==n||null==n.description?null:n.description.substring(0,290))+"...":null==n?null:n.description)}}function E(e,a){if(1&e&&(t.TgZ(0,"mat-card-header")(1,"mat-card-title"),t._uU(2),t.qZA(),t.TgZ(3,"mat-card-subtitle"),t._uU(4),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.Oqu(null==n?null:n.name),t.xp6(2),t.Oqu(null==n?null:n.subtitle)}}function L(e,a){if(1&e&&(t.TgZ(0,"mat-card-content")(1,"div",12),t._uU(2),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.Oqu((null==n||null==n.description?null:n.description.length)>290?(null==n||null==n.description?null:n.description.substring(0,290))+"...":null==n?null:n.description)}}const Q=function(){return{focused:!0}},U=function(e){return{"card-image-wrapper":e}};function Y(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-grid-tile")(1,"mat-card",4),t.NdJ("click",function(){const s=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.onCardClick(s))}),t.TgZ(2,"mat-grid-list",5)(3,"mat-grid-tile",6)(4,"div",7),t._UZ(5,"img",8),t.qZA()(),t.YNc(6,P,10,5,"mat-grid-tile",9),t.qZA(),t.YNc(7,E,5,2,"mat-card-header",10),t.YNc(8,L,3,1,"mat-card-content",10),t.qZA()()}if(2&e){const n=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",t.DdM(12,Q)),t.xp6(1),t.Q6J("cols",2===o.gridForYouCols?4:1)("gutterSize",2===o.gridForYouCols?"16":"0")("rowHeight",2===o.gridForYouCols?"100%":"2:1"),t.xp6(1),t.Q6J("colspan",1)("rowspan",1),t.xp6(1),t.Q6J("ngClass",t.VKq(13,U,2==o.gridForYouCols)),t.xp6(1),t.Q6J("src",null==n?null:n.image,t.LSH)("alt",null==n?null:n.name),t.xp6(1),t.Q6J("ngIf",2===o.gridForYouCols),t.xp6(1),t.Q6J("ngIf",1==o.gridForYouCols),t.xp6(1),t.Q6J("ngIf",1==o.gridForYouCols)}}let H=(()=>{class e{constructor(n){this.breakpointObserver=n,this.gridForYouCols=2,this.forYouBooks=[],this.onItemFocus=new t.vpe}ngOnInit(){this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(n=>{this.gridForYouCols=n.matches?1:2})}ngOnChanges(){this.getForYouBooks()}onCardClick(n){this.onItemFocus.emit(n)}getForYouBooks(){this.forYouBooks=this.books?.filter(n=>n?.published)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v.Yg))},e.\u0275cmp=t.Xpm({type:e,selectors:[["librarian-books"]],inputs:{books:"books"},outputs:{onItemFocus:"onItemFocus"},features:[t.TTD],decls:6,vars:3,consts:[[1,"container-fluid"],[1,"for-your-books"],["gutterSize","30",3,"cols","rowHeight"],[4,"ngFor","ngForOf"],["appearance","outlined",1,"card-grid",3,"ngClass","click"],[3,"cols","gutterSize","rowHeight"],[3,"colspan","rowspan"],[3,"ngClass"],["mat-card-image","",3,"src","alt"],[3,"colspan","rowspan",4,"ngIf"],[4,"ngIf"],[1,"h-100","w-100"],[1,"card-description"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2"),t._uU(3,"D\xe0nh cho b\u1ea1n"),t.qZA(),t.TgZ(4,"mat-grid-list",2),t.YNc(5,Y,9,15,"mat-grid-tile",3),t.qZA()()()),2&n&&(t.xp6(4),t.Q6J("cols",o.gridForYouCols)("rowHeight",2===o.gridForYouCols?"5:2":"4:5"),t.xp6(1),t.Q6J("ngForOf",o.forYouBooks))},dependencies:[p.mk,p.sg,p.O5,x.Il,x.DX,d.a8,d.dn,d.dk,d.G2,d.$j,d.n5],styles:[".card-grid[_ngcontent-%COMP%]{width:calc(100% - 3px);height:calc(100% - 3px);overflow:hidden;border-radius:1rem;cursor:pointer}.card-grid.focused[_ngcontent-%COMP%]{background-color:#eaf1fb}.card-grid[_ngcontent-%COMP%]   .card-image-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;padding:1rem 0 1rem 1rem}.card-grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:1rem;width:100%;height:100%;object-fit:cover}"]}),e})();function K(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"div",21)(2,"div",22)(3,"mat-label"),t._uU(4,"Published"),t.qZA(),t.TgZ(5,"mat-checkbox",23),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.published=i)}),t.qZA()(),t.TgZ(6,"div",22)(7,"mat-form-field",24)(8,"mat-label"),t._uU(9,"Key"),t.qZA(),t.TgZ(10,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.key=i)}),t.qZA()()(),t.TgZ(11,"div",22)(12,"mat-form-field",24)(13,"mat-label"),t._uU(14,"T\xean"),t.qZA(),t.TgZ(15,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.name=i)}),t.qZA()()(),t.TgZ(16,"div",22)(17,"mat-form-field",24)(18,"mat-label"),t._uU(19,"Subtitle"),t.qZA(),t.TgZ(20,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.subtitle=i)}),t.qZA()()(),t.TgZ(21,"div",22)(22,"mat-form-field",24)(23,"mat-label"),t._uU(24,"Path"),t.qZA(),t.TgZ(25,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.path=i)}),t.qZA()()(),t.TgZ(26,"div",22)(27,"div",26),t._UZ(28,"img",27),t.TgZ(29,"div")(30,"mat-form-field",24)(31,"mat-label"),t._uU(32,"H\xecnh \u1ea3nh"),t.qZA(),t.TgZ(33,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.image=i)}),t.qZA()()()()(),t.TgZ(34,"div",28)(35,"mat-form-field",29)(36,"mat-label"),t._uU(37,"M\xf4 t\u1ea3"),t.qZA(),t.TgZ(38,"textarea",30),t.NdJ("ngModelChange",function(i){const r=t.CHM(n).$implicit;return t.KtG(r.description=i)}),t.qZA()()()(),t._UZ(39,"mat-divider"),t.qZA()}if(2&e){const n=a.$implicit;t.xp6(5),t.Q6J("ngModel",n.published),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",n.key),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",n.name),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",n.subtitle),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",n.path),t.xp6(3),t.Q6J("src",n.image,t.LSH)("alt",n.name),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",n.image),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",n.description)}}function $(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-tab",17)(1,"div",6)(2,"div",18)(3,"h2"),t._uU(4,"Settings"),t.qZA(),t.TgZ(5,"button",16),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.saveSettings())}),t._uU(6," Save "),t.qZA()(),t.YNc(7,K,40,15,"div",19),t.TgZ(8,"button",20),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.addNewSettings())}),t._uU(9,"+ Add new"),t.qZA()()()}if(2&e){const n=t.oxw();t.xp6(5),t.Q6J("color","primary"),t.xp6(2),t.Q6J("ngForOf",n.staticBooks)}}function G(e,a){if(1&e&&(t.TgZ(0,"div",31)(1,"h4"),t._uU(2,"M\xf4 t\u1ea3:"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t._UZ(5,"mat-divider"),t.qZA()),2&e){const n=t.oxw();t.xp6(4),t.Oqu(null==n.previewingItem?null:n.previewingItem.description)}}function j(e,a){if(1&e&&(t.TgZ(0,"span"),t._uU(1," \u0111\u1ebfn \u0111o\u1ea1n: "),t._UZ(2,"br"),t._uU(3),t.qZA()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" ",null==n.previewingItem||null==n.previewingItem.reading?null:n.previewingItem.reading.stopAt," ")}}function D(e,a){if(1&e&&(t.TgZ(0,"div",31)(1,"h4"),t._uU(2,"\u0110ang \u0111\u1ecdc:"),t.qZA(),t.TgZ(3,"p")(4,"strong"),t._uU(5),t.qZA(),t.YNc(6,j,4,1,"span",32),t.qZA()()),2&e){const n=t.oxw();t.xp6(5),t.Oqu(null==n.previewingItem||null==n.previewingItem.reading?null:n.previewingItem.reading.name),t.xp6(1),t.Q6J("ngIf",null==n.previewingItem||null==n.previewingItem.reading?null:n.previewingItem.reading.stopAt)}}function R(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onRead(null==i.previewingItem||null==i.previewingItem.reading?null:i.previewingItem.reading.location))}),t._uU(1," \u0110\u1eccC TI\u1ebeP "),t.qZA()}2&e&&t.Q6J("color","primary")}let z=(()=>{class e{constructor(n,o,i,s,r){this.breakpointObserver=n,this.libraryService=o,this.changeDetector=i,this.authService=s,this.router=r,this.staticBooks=[],this.contentEditable=!1,this.contentEditable=this.authService.contentEditable}ngOnInit(){this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(n=>{this.mode=n.matches?"over":"side"}),this.getBooks()}getBooks(){this.getStaticBooks()}getStaticBooks(){this.libraryService.getStaticBooks().subscribe(n=>{n.data&&(this.staticBooks=n.data,this.getReadingBooks(),this.changeDetector.detectChanges())})}getReadingBooks(){const n=JSON.parse(localStorage.getItem("reading")||"[]");this.staticBooks.forEach(o=>{const i=n.find(s=>s?.key===o?.key);i&&(o.reading=i)})}saveSettings(){const n={data:this.staticBooks.map(o=>({name:o?.name,image:o?.image,description:o?.description,key:o?.key,subtitle:o?.subtitle,path:o?.path,published:o?.published}))};navigator.clipboard.writeText(JSON.stringify(n))}onRead(n,o=!1){o?this.router.navigate([n.replace(location.origin,"")],{queryParams:{tableContent:!0}}):this.router.navigateByUrl(n.replace(location.origin,""))}addNewSettings(){this.staticBooks.push({})}onItemFocus(n,o){this.previewingItem?.key===n.key?o.toggle():(this.previewingItem=n,o.open())}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v.Yg),t.Y36(Z),t.Y36(t.sBO),t.Y36(F.e),t.Y36(u.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-librarian"]],decls:28,vars:12,consts:[[1,"librarian-container"],["label","S\xe1ch"],[3,"books","onItemFocus"],["label","Settings",4,"ngIf"],[3,"mode","position"],["libradianDrawer",""],[1,"container-fluid"],[1,"preview-area"],["mat-icon-button","",1,"preview-close",3,"click"],[1,"d-flex","align-items-center","flex-column"],[1,"text-center"],[1,"preview-image-wrapper"],["mat-card-image","",3,"src","alt"],["class","w-100",4,"ngIf"],[1,"read-now-button"],["mat-flat-button","","style","margin-bottom: 1rem;",3,"color","click",4,"ngIf"],["mat-flat-button","",3,"color","click"],["label","Settings"],[1,"w-100","d-flex","align-items-center","justify-content-between"],[4,"ngFor","ngForOf"],["mat-flat-button","",3,"click"],[1,"d-flex","flex-wrap"],[1,"form-group"],[3,"ngModel","ngModelChange"],[3,"appearance"],["type","text","matInput","",3,"ngModel","ngModelChange"],[1,"d-flex"],["width","150px",3,"src","alt"],[1,"form-group","w-100",2,"margin-top","1rem"],[1,"w-100",3,"appearance"],["matInput","","resize","",3,"ngModel","ngModelChange"],[1,"w-100"],[4,"ngIf"],["mat-flat-button","",2,"margin-bottom","1rem",3,"color","click"]],template:function(n,o){if(1&n){const i=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer-content")(2,"mat-tab-group")(3,"mat-tab",1)(4,"librarian-books",2),t.NdJ("onItemFocus",function(r){t.CHM(i);const c=t.MAs(7);return t.KtG(o.onItemFocus(r,c))}),t.qZA()(),t.YNc(5,$,10,2,"mat-tab",3),t.qZA()(),t.TgZ(6,"mat-drawer",4,5)(8,"div",6)(9,"div",7)(10,"button",8),t.NdJ("click",function(){t.CHM(i);const r=t.MAs(7);return t.KtG(r.close())}),t.TgZ(11,"mat-icon"),t._uU(12,"close"),t.qZA()(),t.TgZ(13,"div",9)(14,"h2",10),t._uU(15,"T\xf3m t\u1eaft"),t.qZA(),t.TgZ(16,"div",11),t._UZ(17,"img",12),t.qZA(),t.TgZ(18,"h3",10),t._uU(19),t.qZA(),t.TgZ(20,"p",10),t._uU(21),t.qZA(),t.YNc(22,G,6,1,"div",13),t.YNc(23,D,7,2,"div",13),t.qZA()()(),t.TgZ(24,"div",14),t.YNc(25,R,2,1,"button",15),t.TgZ(26,"button",16),t.NdJ("click",function(){return o.onRead(null==o.previewingItem?null:o.previewingItem.path,!0)}),t._uU(27," XEM M\u1ee4C L\u1ee4C "),t.qZA()()()()}2&n&&(t.xp6(4),t.Q6J("books",o.staticBooks),t.xp6(1),t.Q6J("ngIf",o.contentEditable),t.xp6(1),t.Q6J("mode","side")("position","end"),t.xp6(11),t.Q6J("src",null==o.previewingItem?null:o.previewingItem.image,t.LSH)("alt",null==o.previewingItem?null:o.previewingItem.name),t.xp6(2),t.Oqu(null==o.previewingItem?null:o.previewingItem.name),t.xp6(2),t.Oqu(null==o.previewingItem?null:o.previewingItem.subtitle),t.xp6(1),t.Q6J("ngIf",!(null==o.previewingItem||!o.previewingItem.description)),t.xp6(1),t.Q6J("ngIf",!(null==o.previewingItem||null==o.previewingItem.reading||!o.previewingItem.reading.key)),t.xp6(2),t.Q6J("ngIf",!(null==o.previewingItem||null==o.previewingItem.reading||!o.previewingItem.reading.key)),t.xp6(1),t.Q6J("color","primary"))},dependencies:[p.sg,p.O5,C.uX,C.SP,d.G2,y.Hw,m.lW,m.RK,_.jA,_.kh,_.LW,b.KE,b.hX,I.Nt,h.Fj,h.JJ,h.On,M.d,J.oG,H],styles:[".librarian-container[_ngcontent-%COMP%]{background-color:#fff}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]{min-width:300px;width:100%;max-width:400px;background-color:#d3e3fd;border-left-color:#d3e3fd;border-top-left-radius:1rem}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-close[_ngcontent-%COMP%]{position:absolute;top:1rem;left:1rem;background-color:#d3e3fd}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]{padding:1rem}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   .preview-image-wrapper[_ngcontent-%COMP%]{width:200px;height:300px;border-radius:1rem;margin:1rem 0}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   .preview-image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.librarian-container[_ngcontent-%COMP%]   .read-now-button[_ngcontent-%COMP%]{width:100%;position:sticky;background-color:#d3e3fd;padding:1rem;bottom:0}.librarian-container[_ngcontent-%COMP%]   .read-now-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;border-radius:50px}.librarian-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{padding:0 1rem}"]}),e})();var W=l(1481),V=l(3646),X=l(8109),A=l(3162),tt=l(8974),nt=l(1746),g=l(7084),k=l(6338);function et(e,a){1&e&&t._UZ(0,"mat-progress-bar",7)}function ot(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"div",10)(1,"cp-content-creator",11),t.NdJ("save",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.onSaveContent())})("nextContent",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.onNextContent())}),t.qZA()()}if(2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("data",n.content)("rootContent",n.rootContent)}}function it(e,a){if(1&e&&(t.TgZ(0,"div",8),t.YNc(1,ot,2,2,"div",9),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.content)}}function at(e,a){if(1&e&&(t.TgZ(0,"p")(1,"strong"),t._uU(2,"\u0110o\u1ea1n: "),t.qZA(),t._uU(3),t.qZA()),2&e){const n=t.oxw(3);t.xp6(3),t.hij("",null==n.reading?null:n.reading.stopAt," ")}}function rt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.continueReading(!0))}),t._uU(1," \u0110\u1eccC TI\u1ebeP V\xc0 NGHE "),t.qZA()}2&e&&t.Q6J("color","primary")}function lt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"div",21)(1,"h2"),t._uU(2,"B\u1ea1n \u0111ang \u0111\u1ecdc: "),t.TgZ(3,"span",22),t._uU(4),t.qZA()(),t.YNc(5,at,4,1,"p",23),t.TgZ(6,"button",24),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.continueReading())}),t._uU(7," \u0110\u1eccC TI\u1ebeP "),t.qZA(),t.YNc(8,rt,2,1,"button",25),t.qZA()}if(2&e){const n=t.oxw(2);t.xp6(4),t.Oqu(null==n.reading?null:n.reading.name),t.xp6(1),t.Q6J("ngIf",null==n.reading?null:n.reading.stopAt),t.xp6(1),t.Q6J("color","primary"),t.xp6(2),t.Q6J("ngIf",null==n.reading?null:n.reading.currentTime)}}function st(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-list-item")(1,"div",28)(2,"div",17),t._uU(3),t.qZA(),t.TgZ(4,"div",18)(5,"button",19),t.NdJ("click",function(){const s=t.CHM(n).$implicit,r=t.oxw(3);return t.KtG(r.readContent(s))}),t._uU(6,"\u0110\u1ecdc"),t.qZA()()()()}if(2&e){const n=a.$implicit,o=t.oxw(3);t.xp6(3),t.Oqu(o.getContentName(n))}}function ct(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-expansion-panel",26)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"h3",17),t._uU(4),t.qZA()(),t.TgZ(5,"div",18)(6,"button",19),t.NdJ("click",function(){const s=t.CHM(n).$implicit,r=t.oxw(2);return t.KtG(r.readContent(s))}),t._uU(7,"\u0110\u1ecdc"),t.qZA()()(),t.TgZ(8,"div")(9,"mat-list"),t.YNc(10,st,7,1,"mat-list-item",27),t.qZA()()()}if(2&e){const n=a.$implicit,o=t.oxw(2);t.Q6J("expanded",!1),t.xp6(4),t.Oqu(o.getContentName(n)),t.xp6(6),t.Q6J("ngForOf",null==n?null:n.content)}}function pt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t.YNc(2,lt,9,4,"div",14),t.qZA(),t.TgZ(3,"mat-accordion",15)(4,"mat-expansion-panel",16)(5,"mat-expansion-panel-header")(6,"mat-panel-title")(7,"h2",17),t._uU(8),t.qZA()(),t.TgZ(9,"div",18)(10,"button",19),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onReadNow())}),t._uU(11,"\u0110\u1ecdc"),t.qZA()()(),t.TgZ(12,"div")(13,"mat-accordion",15),t.YNc(14,ct,11,3,"mat-expansion-panel",20),t.qZA()()()()()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",null==n.reading?null:n.reading.name),t.xp6(2),t.Q6J("expanded",!0),t.xp6(4),t.Oqu(null==n.content?null:n.content.name),t.xp6(6),t.Q6J("ngForOf",null==n.content?null:n.content.content)}}const O=function(e){return{link:e}},dt=function(e){return{text:"Tr\u01b0\u1edbc \u0111\xf3",navigate:e}},ut=function(e){return{text:"Ti\u1ebfp theo",navigate:e}};function gt(e,a){if(1&e&&t._UZ(0,"app-bottom-navigator",29),2&e){const n=t.oxw();t.Q6J("prev",t.VKq(4,dt,t.VKq(2,O,n.navigate.prev.link)))("next",t.VKq(8,ut,t.VKq(6,O,n.navigate.next.link)))}}const mt=function(e,a){return{link:e,queryParams:a}},_t=function(e){return{navigate:e}};let B=(()=>{class e{constructor(n,o,i,s,r){this.router=n,this.route=o,this.breakpointObserver=i,this.libraryService=s,this.titleService=r,this.isLoading=!1,this.isShowTableContent=!1,this.navigate={prev:{link:void 0,queryParams:{}},next:{link:void 0,queryParams:{}}}}ngOnInit(){this.route.queryParamMap.subscribe(n=>{this.isShowTableContent=n.params.tableContent}),this.route.params.subscribe(n=>{n.key&&!n.level&&this.getContent(n.key,n.level),n.key&&n.level&&(this.getContent(n.key,n.level),this.level=n.level,this.router.navigate(["."],{relativeTo:this.route,fragment:location.hash.replace("#","")}))})}getContent(n,o){this.isLoading=!0,this.libraryService.getBookByKey(n).subscribe(i=>{if(i.data){if(this.rootContent=i.data,0===this.rootContent?.content?.length&&this.rootContent?.content.push({type:"block",key:n.replaceAll("-",""),content:[],attrs:{hash:"",pathname:location.pathname}}),this.reading=JSON.parse(localStorage.getItem("reading")||"[]")?.find(c=>c.key==this.rootContent?.key),this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(c=>{c.matches?localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!0,isHideBottomNavBar:!0})):localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!1,isHideBottomNavBar:!1}))}),o){const c=(f,N)=>{let S;return f.some(w=>S=w.key===N?w:c(w.content||[],N)),S};this.content=c(i.data.content,location.pathname.slice(1,location.pathname.length).split("/").slice(1).join("-").replaceAll("-","")),this.titleService.setTitle(`${this.content?.name} | ${this.rootContent?.name} | CaoDaiON`),this.isLoading=!1,this.getNavigateLink()}else this.content=i.data,this.titleService.setTitle(`${this.content.name} | ${this.rootContent.name} | CaoDaiON`),this.isLoading=!1,this.getNavigateLink();location.hash&&setTimeout(()=>{const c=document.getElementById(`${location.pathname.slice(1,location.pathname.length).split("/").slice(1).join("-").replaceAll("-","")}${location.hash.replace("#","")}`),f=document.getElementById("contentCreatorWrapper");c&&(c.style.color="#4285f4",f&&c&&f.scroll({top:c.offsetTop-(this.content.audio?60:0)}))},0);let s=JSON.parse(localStorage.getItem("reading")||"[]");s||(s=[]);let r=s.find(c=>c.key==this.rootContent.key);r?r.content!==this.content.key&&(r.content=this.content.key,r.name=this.content.name,r.location=location.href):s.push({name:this.rootContent.name,content:this.content.key||this.rootContent.key,key:this.rootContent.key,location:location.href}),this.level&&localStorage.setItem("reading",JSON.stringify(s))}})}onSaveContent(){console.log(this.rootContent),navigator.clipboard.writeText(JSON.stringify({data:this.rootContent}))}onNextContent(){this.router.navigate([this.navigate.next.link],{queryParams:{autoplay:!0}}).then(()=>{localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!0,isHideBottomNavBar:!0}))})}getNavigateLink(){this.isShowTableContent?this.navigate.prev.queryParams={}:(this.navigate.prev.queryParams={tableContent:!this.isShowTableContent},this.navigate.prev.link=this.rootContent.content[this.rootContent.content.findIndex(o=>o.key==this.content?.key)-1]?.attrs.pathname+this.rootContent.content[this.rootContent.content.findIndex(o=>o.key==this.content.key)-1]?.attrs.hash||"/",this.navigate.next.link=this.rootContent.content[this.rootContent.content.findIndex(o=>o.key==this.content?.key)+1]?.attrs.pathname+this.rootContent.content[this.rootContent.content.findIndex(o=>o.key==this.content.key)+1]?.attrs.hash||"/")}getContentName(n){if(!n?.name){let o="";return n?.content[0]?.content.forEach(i=>{"text"==i.type&&(o+=i?.text)}),o}return n?.name}readContent(n){n?.attrs?.hash?.includes("#")?this.router.navigate([n?.attrs?.pathname],{fragment:n?.attrs?.hash.replace("#","")}):this.router.navigate([`${n?.attrs?.pathname}${n?.attrs?.hash||""}`])}onReadNow(){this.isLoading=!0,setTimeout(()=>{this.router.navigate([],{queryParams:{tableContent:null},queryParamsHandling:"merge"}).then(()=>{this.isLoading=!1})},0)}getBackLink(){return this.level||this.isShowTableContent?this.level&&!this.isShowTableContent?(this.navigate.prev.queryParams={tableContent:!this.isShowTableContent},""):(this.navigate.prev.queryParams={},""):(this.navigate.prev.queryParams={tableContent:!this.isShowTableContent},location.pathname)}continueReading(n=!1){n?this.router.navigateByUrl(`${this.reading.location.replace(location.origin,"")}`,{state:{autoplay:!0}}):this.router.navigateByUrl(this.reading.location.replace(location.origin,""))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.F0),t.Y36(u.gz),t.Y36(v.Yg),t.Y36(Z),t.Y36(W.Dx))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-book"]],decls:9,vars:11,consts:[[1,"wrapper-container","book-content-container"],[1,"header",3,"prevPage"],[1,"book-header"],["mode","indeterminate",4,"ngIf"],["class","book-container-wrapper",4,"ngIf"],["class","book-table-content-container-wrapper",4,"ngIf"],[3,"prev","next",4,"ngIf"],["mode","indeterminate"],[1,"book-container-wrapper"],["class","h-100",4,"ngIf"],[1,"h-100"],[3,"data","rootContent","save","nextContent"],[1,"book-table-content-container-wrapper"],[1,"container-fluid"],["class","reading-section",4,"ngIf"],["multi",""],["disabled","","hideToggle","",3,"expanded"],[1,"content-name"],[1,"d-flex","align-items-center"],["mat-stroked-button","",3,"click"],["hideToggle","",3,"expanded",4,"ngFor","ngForOf"],[1,"reading-section"],[2,"font-weight","400"],[4,"ngIf"],["mat-flat-button","",1,"w-100",3,"color","click"],["mat-flat-button","","class","w-100",3,"color","click",4,"ngIf"],["hideToggle","",3,"expanded"],[4,"ngFor","ngForOf"],[1,"w-100","d-flex","justify-content-between","align-items-center"],[3,"prev","next"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"app-header",1)(2,"div",2)(3,"app-header-title"),t._uU(4),t.qZA()()(),t.YNc(5,et,1,0,"mat-progress-bar",3),t.YNc(6,it,2,1,"div",4),t.YNc(7,pt,15,4,"div",5),t.YNc(8,gt,1,10,"app-bottom-navigator",6),t.qZA()),2&n&&(t.xp6(1),t.Q6J("prevPage",t.VKq(9,_t,t.WLB(6,mt,o.getBackLink(),o.navigate.prev.queryParams))),t.xp6(3),t.Oqu(null==o.content?null:o.content.name),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Q6J("ngIf",!o.isShowTableContent),t.xp6(1),t.Q6J("ngIf",o.isShowTableContent),t.xp6(1),t.Q6J("ngIf","block"==(null==o.content?null:o.content.type)))},dependencies:[p.sg,p.O5,m.lW,V.G,X.d,A.pW,tt.S,nt.T,g.pp,g.ib,g.yz,g.yK,k.i$,k.Tg],styles:["app-book{display:flex;flex-direction:column;height:100%;max-height:100%;overflow:hidden}  app-book .book-content-title{padding:2rem;margin:0}  app-book .book-container-wrapper{flex:1;overflow:hidden}  app-book .book-table-content-container-wrapper{flex:1;overflow:auto}  app-book .book-header{white-space:normal;overflow:hidden;width:100%}  app-book .content-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}  app-book .reading-section button{margin-bottom:1rem}"]}),e})();const ht=[{path:"",children:[{path:"",component:z},{path:":key",component:B},{path:":key/:level",component:B}]}];let ft=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.Bz.forChild(ht),u.Bz]}),e})();var vt=l(4546),Ct=l(6038),bt=l(7726);let xt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.ez,ft,C.Nh,x.N6,d.QW,y.Ps,m.ot,_.SJ,b.lN,I.c,h.u5,M.t,J.p9,vt.O,A.Cv,Ct.m,bt.e,g.To,k.ie]}),e})()}}]);