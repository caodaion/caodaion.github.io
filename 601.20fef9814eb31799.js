"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[601],{9601:(ne,M,s)=>{s.r(M),s.d(M,{LibraryModule:()=>Xt});var p=s(6814),f=s(2787),t=s(5879),T=s(1088),k=s(5592),g=s(1094),h=s(553),P=s(9862);let S=(()=>{var n;class a{constructor(o){this.http=o}getStaticBooks(){return this.http.get("assets/documents/library/static-library.json")}getBookFromLibrary(){return new k.y(o=>{this.http.get(`https://api.github.com/repos/${g.c.caodaionLibrady.user}/${g.c.caodaionLibrady.repo}/contents/library.json${h.N.production?"":"?ref=dev"}`).subscribe(i=>{o.next(JSON.parse(decodeURIComponent(escape(atob(i.content))))),o.complete()})})}getTableContentByKey(o,i=!1){return i?this.http.get(`assets/documents/library/${o}/table-content.json`):new k.y(r=>{this.http.get(`https://api.github.com/repos/${g.c.caodaionLibrady.user}/${g.c.caodaionLibrady.repo}/contents/${o}/table-content.json${h.N.production?"":"?ref=dev"}`).subscribe(l=>{r.next(JSON.parse(decodeURIComponent(escape(atob(l.content))))),r.complete()})})}getBookByKey(o,i=!1){return i?this.http.get(`assets/documents/library/${o}/${o}.txt`,{responseType:"text"}):new k.y(r=>{this.http.get(`https://api.github.com/repos/${g.c.caodaionLibrady.user}/${g.c.caodaionLibrady.repo}/contents/${o}/${o}.md${h.N.production?"":"?ref=draft/"+o}`).subscribe(l=>{const c={};c.data=decodeURIComponent(escape(atob(l.content))),r.next(c),r.complete()})})}getDataOfTableContent(o,i=!1){return i?this.http.get(`assets/documents/library/${o}.txt`,{responseType:"text"}):new k.y(r=>{this.http.get(`https://api.github.com/repos/${g.c.caodaionLibrady.user}/${g.c.caodaionLibrady.repo}/contents/${o}.md${h.N.production?"":"?ref=dev"}`).subscribe(l=>{r.next(decodeURIComponent(escape(atob(l.content)))),r.complete()})})}}return(n=a).\u0275fac=function(o){return new(o||n)(t.LFG(P.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),a})();var A=s(3096),b=s(4104),d=s(5195),w=s(617),v=s(2296),u=s(2651),x=s(4170),O=s(2032),_=s(6223),Z=s(6385),Q=s(5986),J=s(3176);function q(n,a){if(1&n&&t._UZ(0,"img",12),2&n){const e=t.oxw().$implicit;t.Q6J("src",null==e?null:e.image,t.LSH)("alt",null==e?null:e.name)}}const E=function(){return{fontSize:"170px",height:"170px",width:"170px"}};function j(n,a){1&n&&(t.TgZ(0,"div",13)(1,"mat-icon",14),t._uU(2,"receipt_long"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("ngStyle",t.DdM(1,E)))}function K(n,a){if(1&n&&(t.TgZ(0,"mat-grid-tile",6)(1,"div",15)(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.qZA()(),t.TgZ(7,"mat-card-content")(8,"div",16),t._uU(9),t.qZA()()()()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.Q6J("colspan",2===o.gridForYouCols?3:1)("rowspan",1),t.xp6(4),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.subtitle),t.xp6(3),t.hij(" ",(null==e||null==e.description?null:e.description.length)>290?(null==e||null==e.description?null:e.description.substring(0,290))+"...":null==e?null:e.description," ")}}function D(n,a){if(1&n&&(t.TgZ(0,"mat-card-header")(1,"mat-card-title"),t._uU(2),t.qZA(),t.TgZ(3,"mat-card-subtitle"),t._uU(4),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.subtitle)}}function z(n,a){if(1&n&&(t.TgZ(0,"mat-card-content")(1,"div",16),t._uU(2),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",(null==e||null==e.description?null:e.description.length)>290?(null==e||null==e.description?null:e.description.substring(0,290))+"...":null==e?null:e.description," ")}}const R=function(){return{focused:!0}},G=function(n){return{"card-image-wrapper":n}};function W(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"mat-grid-tile")(1,"mat-card",4),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onCardClick(r))}),t.TgZ(2,"mat-grid-list",5)(3,"mat-grid-tile",6)(4,"div",7),t.YNc(5,q,1,2,"img",8),t.YNc(6,j,3,2,"div",9),t.qZA()(),t.YNc(7,K,10,5,"mat-grid-tile",10),t.qZA(),t.YNc(8,D,5,2,"mat-card-header",11),t.YNc(9,z,3,1,"mat-card-content",11),t.qZA()()}if(2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",t.DdM(12,R)),t.xp6(1),t.Q6J("cols",2===o.gridForYouCols?4:1)("gutterSize",2===o.gridForYouCols?"16":"0")("rowHeight",2===o.gridForYouCols?"100%":"2:1"),t.xp6(1),t.Q6J("colspan",1)("rowspan",1),t.xp6(1),t.Q6J("ngClass",t.VKq(13,G,2==o.gridForYouCols)),t.xp6(1),t.Q6J("ngIf",null==e?null:e.cover),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.cover)),t.xp6(1),t.Q6J("ngIf",2===o.gridForYouCols),t.xp6(1),t.Q6J("ngIf",1==o.gridForYouCols),t.xp6(1),t.Q6J("ngIf",1==o.gridForYouCols)}}let X=(()=>{var n;class a{constructor(o){this.breakpointObserver=o,this.gridForYouCols=2,this.forYouBooks=[],this.onItemFocus=new t.vpe}ngOnInit(){this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(o=>{this.gridForYouCols=o.matches?1:2})}ngOnChanges(){this.getBooks()}getBooks(){this.books.forEach(o=>{!o.isStatic&&o.cover&&(o.image=`https://raw.githubusercontent.com/caodaion-library/caodaion-library.github.io/${h.N.production?"main":"dev"}/${o.key}/cover.png${h.N.production?"":"?ref=dev"}`)}),this.getForYouBooks()}onCardClick(o){this.onItemFocus.emit(o)}getForYouBooks(){this.forYouBooks=this.books?.filter(o=>o?.published)}}return(n=a).\u0275fac=function(o){return new(o||n)(t.Y36(T.Yg))},n.\u0275cmp=t.Xpm({type:n,selectors:[["librarian-books"]],inputs:{books:"books"},outputs:{onItemFocus:"onItemFocus"},features:[t.TTD],decls:6,vars:3,consts:[[1,"container-fluid"],[1,"for-your-books"],["gutterSize","30",3,"cols","rowHeight"],[4,"ngFor","ngForOf"],["appearance","outlined",1,"card-grid",3,"ngClass","click"],[3,"cols","gutterSize","rowHeight"],[3,"colspan","rowspan"],[3,"ngClass"],["mat-card-image","",3,"src","alt",4,"ngIf"],["mat-card-image","","class","h-full w-full flex items-center justify-center",4,"ngIf"],[3,"colspan","rowspan",4,"ngIf"],[4,"ngIf"],["mat-card-image","",3,"src","alt"],["mat-card-image","",1,"h-full","w-full","flex","items-center","justify-center"],[3,"ngStyle"],[1,"h-100","w-100"],[1,"card-description"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2"),t._uU(3,"D\xe0nh cho b\u1ea1n"),t.qZA(),t.TgZ(4,"mat-grid-list",2),t.YNc(5,W,10,15,"mat-grid-tile",3),t.qZA()()()),2&o&&(t.xp6(4),t.Q6J("cols",i.gridForYouCols)("rowHeight",2===i.gridForYouCols?"5:2":"4:5"),t.xp6(1),t.Q6J("ngForOf",i.forYouBooks))},dependencies:[p.mk,p.sg,p.O5,p.PC,J.Il,J.DX,d.a8,d.dn,d.dk,d.G2,d.$j,d.n5,w.Hw],styles:[".card-grid[_ngcontent-%COMP%]{width:calc(100% - 3px);height:calc(100% - 3px);overflow:hidden;border-radius:1rem;cursor:pointer}.card-grid.focused[_ngcontent-%COMP%]{background-color:#eaf1fb}.card-grid[_ngcontent-%COMP%]   .card-image-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;padding:1rem 0 1rem 1rem}.card-grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:1rem;width:100%;height:100%;object-fit:cover}"]}),a})();function V(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",21)(2,"div",22)(3,"mat-label"),t._uU(4,"Published"),t.qZA(),t.TgZ(5,"mat-checkbox",23),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.published=i)}),t.qZA()(),t.TgZ(6,"div",22)(7,"mat-form-field",24)(8,"mat-label"),t._uU(9,"Key"),t.qZA(),t.TgZ(10,"input",25),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.key=i)}),t.qZA()()(),t.TgZ(11,"div",22)(12,"mat-form-field",24)(13,"mat-label"),t._uU(14,"T\xean"),t.qZA(),t.TgZ(15,"input",25),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.name=i)}),t.qZA()()(),t.TgZ(16,"div",22)(17,"mat-form-field",24)(18,"mat-label"),t._uU(19,"Subtitle"),t.qZA(),t.TgZ(20,"input",25),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.subtitle=i)}),t.qZA()()(),t.TgZ(21,"div",22)(22,"mat-form-field",24)(23,"mat-label"),t._uU(24,"Path"),t.qZA(),t.TgZ(25,"input",25),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.path=i)}),t.qZA()()(),t.TgZ(26,"div",22)(27,"div",26),t._UZ(28,"img",27),t.TgZ(29,"div")(30,"mat-form-field",24)(31,"mat-label"),t._uU(32,"H\xecnh \u1ea3nh"),t.qZA(),t.TgZ(33,"input",25),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.image=i)}),t.qZA()()()()(),t.TgZ(34,"div",28)(35,"mat-form-field",29)(36,"mat-label"),t._uU(37,"M\xf4 t\u1ea3"),t.qZA(),t.TgZ(38,"textarea",30),t.NdJ("ngModelChange",function(i){const l=t.CHM(e).$implicit;return t.KtG(l.description=i)}),t.qZA()()()(),t._UZ(39,"mat-divider"),t.qZA()}if(2&n){const e=a.$implicit;t.xp6(5),t.Q6J("ngModel",e.published),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.key),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.name),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.subtitle),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.path),t.xp6(3),t.Q6J("src",e.image,t.LSH)("alt",e.name),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.image),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.description)}}function tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"mat-tab",17)(1,"div",6)(2,"div",18)(3,"h2"),t._uU(4,"Settings"),t.qZA(),t.TgZ(5,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveSettings())}),t._uU(6," Save "),t.qZA()(),t.YNc(7,V,40,15,"div",19),t.TgZ(8,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addNewSettings())}),t._uU(9,"+ Add new"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("color","primary"),t.xp6(2),t.Q6J("ngForOf",e.library)}}function et(n,a){if(1&n&&t._UZ(0,"img",31),2&n){const e=t.oxw();t.Q6J("src",null==e.previewingItem?null:e.previewingItem.image,t.LSH)("alt",null==e.previewingItem?null:e.previewingItem.name)}}const nt=function(){return{fontSize:"170px",height:"170px",width:"170px"}};function ot(n,a){1&n&&(t.TgZ(0,"div",32)(1,"mat-icon",33),t._uU(2,"receipt_long"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("ngStyle",t.DdM(1,nt)))}function it(n,a){if(1&n&&(t.TgZ(0,"div",34)(1,"h4"),t._uU(2,"M\xf4 t\u1ea3:"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t._UZ(5,"mat-divider"),t.qZA()),2&n){const e=t.oxw();t.xp6(4),t.Oqu(null==e.previewingItem?null:e.previewingItem.description)}}function at(n,a){if(1&n&&(t.TgZ(0,"span"),t._uU(1," \u0111\u1ebfn \u0111o\u1ea1n: "),t._UZ(2,"br"),t._uU(3),t.qZA()),2&n){const e=t.oxw(2);t.xp6(3),t.hij(" ",null==e.previewingItem||null==e.previewingItem.reading?null:e.previewingItem.reading.stopAt," ")}}function rt(n,a){if(1&n&&(t.TgZ(0,"div",34)(1,"h4"),t._uU(2,"\u0110ang \u0111\u1ecdc:"),t.qZA(),t.TgZ(3,"p")(4,"strong"),t._uU(5),t.qZA(),t.YNc(6,at,4,1,"span",35),t.qZA()()),2&n){const e=t.oxw();t.xp6(5),t.Oqu(null==e.previewingItem||null==e.previewingItem.reading?null:e.previewingItem.reading.name),t.xp6(1),t.Q6J("ngIf",null==e.previewingItem||null==e.previewingItem.reading?null:e.previewingItem.reading.stopAt)}}let lt=(()=>{var n;class a{constructor(o,i,r,l,c){this.breakpointObserver=o,this.libraryService=i,this.changeDetector=r,this.authService=l,this.router=c,this.library=[],this.contentEditable=!1,this.contentEditable=this.authService.contentEditable}ngOnInit(){this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(o=>{this.mode=o.matches?"over":"side"}),this.getBooks()}getBooks(){this.getStaticBooks()}getStaticBooks(){this.libraryService.getStaticBooks().subscribe(o=>{o.data&&(this.library=this.library.concat(o.data),this.getBookFromLibrary(),this.getReadingBooks(),this.changeDetector.detectChanges())})}getBookFromLibrary(){this.libraryService.getBookFromLibrary().subscribe({next:o=>{this.getReadingBooks(),o.data&&(this.library=this.library.concat(o.data)?.filter(i=>i.published))}})}getReadingBooks(){const o=JSON.parse(localStorage.getItem("reading")||"[]");this.library.forEach(i=>{const r=o.find(l=>l?.key===i?.key);r&&(i.reading=r)})}saveSettings(){const o={data:this.library.map(i=>({name:i?.name,image:i?.image,description:i?.description,key:i?.key,subtitle:i?.subtitle,path:i?.path,published:i?.published}))};navigator.clipboard.writeText(JSON.stringify(o))}onRead(o,i=!1){i?this.router.navigate([`thu-vien/${o.key?.replace(location.origin,"")}`],{queryParams:{tableContent:!0}}):this.router.navigate([`thu-vien/${o.key?.replace(location.origin,"")}`])}addNewSettings(){this.library.push({})}onItemFocus(o,i){this.previewingItem?.key===o.key?i.toggle():(this.previewingItem=o,i.open())}}return(n=a).\u0275fac=function(o){return new(o||n)(t.Y36(T.Yg),t.Y36(S),t.Y36(t.sBO),t.Y36(A.e),t.Y36(f.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-librarian"]],decls:28,vars:11,consts:[[1,"librarian-container"],["label","S\xe1ch"],[3,"books","onItemFocus"],["label","Settings",4,"ngIf"],[3,"mode","position"],["libradianDrawer",""],[1,"container-fluid"],[1,"preview-area"],["mat-icon-button","",1,"preview-close",3,"click"],[1,"d-flex","align-items-center","flex-column"],[1,"text-center"],[1,"preview-image-wrapper"],["mat-card-image","",3,"src","alt",4,"ngIf"],["mat-card-image","","class","h-full w-full flex items-center justify-center",4,"ngIf"],["class","w-100",4,"ngIf"],[1,"read-now-button"],["mat-flat-button","",3,"color","click"],["label","Settings"],[1,"w-100","d-flex","align-items-center","justify-content-between"],[4,"ngFor","ngForOf"],["mat-flat-button","",3,"click"],[1,"d-flex","flex-wrap"],[1,"form-group"],[3,"ngModel","ngModelChange"],[3,"appearance"],["type","text","matInput","",3,"ngModel","ngModelChange"],[1,"d-flex"],["width","150px",3,"src","alt"],[1,"form-group","w-100",2,"margin-top","1rem"],[1,"w-100",3,"appearance"],["matInput","","resize","",3,"ngModel","ngModelChange"],["mat-card-image","",3,"src","alt"],["mat-card-image","",1,"h-full","w-full","flex","items-center","justify-center"],[3,"ngStyle"],[1,"w-100"],[4,"ngIf"]],template:function(o,i){if(1&o){const r=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer-content")(2,"mat-tab-group")(3,"mat-tab",1)(4,"librarian-books",2),t.NdJ("onItemFocus",function(c){t.CHM(r);const C=t.MAs(7);return t.KtG(i.onItemFocus(c,C))}),t.qZA()(),t.YNc(5,tt,10,2,"mat-tab",3),t.qZA()(),t.TgZ(6,"mat-drawer",4,5)(8,"div",6)(9,"div",7)(10,"button",8),t.NdJ("click",function(){t.CHM(r);const c=t.MAs(7);return t.KtG(c.close())}),t.TgZ(11,"mat-icon"),t._uU(12,"close"),t.qZA()(),t.TgZ(13,"div",9)(14,"h2",10),t._uU(15,"T\xf3m t\u1eaft"),t.qZA(),t.TgZ(16,"div",11),t.YNc(17,et,1,2,"img",12),t.YNc(18,ot,3,2,"div",13),t.qZA(),t.TgZ(19,"h3",10),t._uU(20),t.qZA(),t.TgZ(21,"p",10),t._uU(22),t.qZA(),t.YNc(23,it,6,1,"div",14),t.YNc(24,rt,7,2,"div",14),t.qZA()()(),t.TgZ(25,"div",15)(26,"button",16),t.NdJ("click",function(){return i.onRead(i.previewingItem,!1)}),t._uU(27," \u0110\u1eccC S\xc1CH "),t.qZA()()()()}2&o&&(t.xp6(4),t.Q6J("books",i.library),t.xp6(1),t.Q6J("ngIf",i.contentEditable),t.xp6(1),t.Q6J("mode","side")("position","end"),t.xp6(11),t.Q6J("ngIf",null==i.previewingItem?null:i.previewingItem.cover),t.xp6(1),t.Q6J("ngIf",!(null!=i.previewingItem&&i.previewingItem.cover)),t.xp6(2),t.Oqu(null==i.previewingItem?null:i.previewingItem.name),t.xp6(2),t.Oqu(null==i.previewingItem?null:i.previewingItem.subtitle),t.xp6(1),t.Q6J("ngIf",!(null==i.previewingItem||!i.previewingItem.description)),t.xp6(1),t.Q6J("ngIf",!(null==i.previewingItem||null==i.previewingItem.reading||!i.previewingItem.reading.key)),t.xp6(2),t.Q6J("color","primary"))},dependencies:[p.sg,p.O5,p.PC,b.uX,b.SP,d.G2,w.Hw,v.lW,v.RK,u.jA,u.kh,u.LW,x.KE,x.hX,O.Nt,_.Fj,_.JJ,_.On,Z.d,Q.oG,X],styles:[".librarian-container[_ngcontent-%COMP%]{background-color:#fff}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]{min-width:300px;width:100%;max-width:400px;background-color:#d3e3fd;border-left-color:#d3e3fd;border-top-left-radius:1rem}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-close[_ngcontent-%COMP%]{position:absolute;top:1rem;left:1rem;background-color:#d3e3fd}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]{padding:1rem}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   .preview-image-wrapper[_ngcontent-%COMP%]{width:200px;height:300px;border-radius:1rem;margin:1rem 0}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   .preview-image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.librarian-container[_ngcontent-%COMP%]   .read-now-button[_ngcontent-%COMP%]{width:100%;position:sticky;background-color:#d3e3fd;padding:1rem;bottom:0}.librarian-container[_ngcontent-%COMP%]   .read-now-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;border-radius:50px}.librarian-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{padding:0 1rem}"]}),a})();var st=s(6091),y=s(7874),ct=s(6593),pt=s(6471),gt=s(5185),L=s(6007),dt=s(9020),Y=s(4611);let ut=(()=>{var n;class a{constructor(){this.id=""}}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-cp-markdown"]],inputs:{data:"data",id:"id"},decls:1,vars:2,consts:[["emoji","","katex","","mermaid","","clipboard","",1,"variable-binding","w-full","text-justify","bg-white","select-text",3,"data","id"]],template:function(o,i){1&o&&t._UZ(0,"markdown",0),2&o&&t.Q6J("data",i.data)("id","markdownContent")},dependencies:[Y.lF]}),a})();var $=s(8525),I=s(3680),F=s(2596),mt=s(7134);function ht(n,a){1&n&&t._UZ(0,"mat-progress-bar",6)}function _t(n,a){if(1&n&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function ft(n,a){if(1&n&&t._UZ(0,"app-cp-markdown",24),2&n){const e=t.oxw(3);t.Q6J("data",e.content)}}const bt=function(n){return{fontSize:n}};function vt(n,a){if(1&n&&(t.TgZ(0,"div",22),t.YNc(1,ft,1,1,"app-cp-markdown",23),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("ngStyle",t.VKq(2,bt,e.fontSize+"px")),t.xp6(1),t.Q6J("ngIf",e.content)}}function xt(n,a){if(1&n&&(t.TgZ(0,"span",29),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" -",e.description," ")}}function Ct(n,a){if(1&n&&(t.TgZ(0,"span",30),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" --",e.description," ")}}function kt(n,a){if(1&n&&(t.TgZ(0,"span",31),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ---",e.description," ")}}function wt(n,a){if(1&n&&(t.TgZ(0,"span",31),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ----",e.description," ")}}function yt(n,a){if(1&n&&(t.TgZ(0,"span",31),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" -----",e.description," ")}}function Tt(n,a){if(1&n&&(t.TgZ(0,"span",31),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" -------",e.description," ")}}function Zt(n,a){if(1&n&&(t.TgZ(0,"span",31),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.description)}}function Jt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"a",25),t.NdJ("click",function(){t.CHM(e),t.oxw();const i=t.MAs(17),r=t.oxw();return t.KtG(r.isPhone?i.toggle():"")}),t.YNc(2,xt,2,1,"span",26),t.YNc(3,Ct,2,1,"span",27),t.YNc(4,kt,2,1,"span",28),t.YNc(5,wt,2,1,"span",28),t.YNc(6,yt,2,1,"span",28),t.YNc(7,Tt,2,1,"span",28),t.YNc(8,Zt,2,1,"span",28),t.qZA(),t._UZ(9,"mat-divider"),t.BQk()}if(2&n){const e=a.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("href","thu-vien/"+o.key+"/"+(null==e?null:e.key),t.LSH),t.xp6(1),t.Q6J("ngIf","H1"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H2"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H3"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H4"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H5"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H6"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.tagName))}}function It(n,a){if(1&n&&(t._UZ(0,"iframe",33),t.ALo(1,"safe")),2&n){const e=t.oxw(3);t.Q6J("src",t.lcZ(1,1,"https://drive.google.com/file/d/"+e.origin+"/preview"),t.uOi)}}function Nt(n,a){if(1&n&&(t.TgZ(0,"mat-tab",9),t.YNc(1,It,2,3,"iframe",32),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("label","T\xe0i li\u1ec7u g\u1ed1c"),t.xp6(1),t.Q6J("ngIf",1===e.selectedIndex)}}function Bt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",7)(1,"mat-tab-group",8),t.NdJ("selectedIndexChange",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.selectedIndex=i)}),t.TgZ(2,"mat-tab",9)(3,"mat-drawer-container")(4,"mat-drawer-content")(5,"div",10)(6,"div",11)(7,"mat-form-field",12)(8,"mat-label"),t._uU(9,"C\u1ee1 ch\u1eef"),t.qZA(),t.TgZ(10,"mat-select",13),t.NdJ("ngModelChange",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.fontSize=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateFontSize())}),t.YNc(11,_t,2,2,"mat-option",14),t.qZA()(),t.TgZ(12,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(17);return t.KtG(i.toggle())}),t.TgZ(13,"mat-icon"),t._uU(14,"list"),t.qZA()()(),t.YNc(15,vt,2,4,"div",16),t.qZA()(),t.TgZ(16,"mat-drawer",17,18),t.YNc(18,Jt,10,8,"ng-container",19),t.qZA()()(),t.YNc(19,Nt,2,2,"mat-tab",20),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("label","N\u1ed9i dung"),t.xp6(8),t.Q6J("ngModel",e.fontSize),t.xp6(1),t.Q6J("ngForOf",e.fontSizeRange),t.xp6(1),t.Q6J("matTooltip","M\u1ee5c l\u1ee5c")("color","primary"),t.xp6(3),t.Q6J("ngIf",e.content),t.xp6(1),t.Q6J("mode","side")("position","end"),t.xp6(2),t.Q6J("ngForOf",e.tableContent),t.xp6(1),t.Q6J("ngIf",e.origin)}}function Mt(n,a){1&n&&t._UZ(0,"mat-progress-bar",6)}function St(n,a){if(1&n&&(t.TgZ(0,"h1"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function At(n,a){if(1&n&&(t.TgZ(0,"h2"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function Ot(n,a){if(1&n&&(t.TgZ(0,"h3"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function Qt(n,a){if(1&n&&(t.TgZ(0,"h4"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function Lt(n,a){if(1&n&&(t.TgZ(0,"h5"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function Yt(n,a){if(1&n&&(t.TgZ(0,"h6"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.description," ")}}function $t(n,a){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.description)}}function Ft(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"a",35),t.YNc(2,St,2,1,"h1",36),t.YNc(3,At,2,1,"h2",36),t.YNc(4,Ot,2,1,"h3",36),t.YNc(5,Qt,2,1,"h4",36),t.YNc(6,Lt,2,1,"h5",36),t.YNc(7,Yt,2,1,"h6",36),t.YNc(8,$t,2,1,"span",36),t.qZA(),t._UZ(9,"mat-divider"),t.BQk()),2&n){const e=a.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("href","thu-vien/"+o.key+"/"+(null==e?null:e.key),t.LSH),t.xp6(1),t.Q6J("ngIf","H1"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H2"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H3"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H4"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H5"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf","H6"==(null==e?null:e.tagName)),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.tagName))}}function Ut(n,a){if(1&n&&(t.TgZ(0,"div",7),t.YNc(1,Mt,1,0,"mat-progress-bar",3),t.TgZ(2,"a",34),t._uU(3," \u0110\u1ecdc h\u1ebft "),t.qZA(),t.YNc(4,Ft,10,8,"ng-container",19),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.isLoading),t.xp6(1),t.Q6J("href","thu-vien/"+e.key,t.LSH)("color","primary"),t.xp6(2),t.Q6J("ngForOf",e.tableContent)}}const N=function(n){return{link:n}},U=function(n,a){return{text:n,navigate:a}};function Ht(n,a){if(1&n&&t._UZ(0,"app-bottom-navigator",37),2&n){const e=t.oxw();t.Q6J("prev",t.WLB(4,U,null==e.navigate||null==e.navigate.prev?null:e.navigate.prev.text,t.VKq(2,N,null==e.navigate||null==e.navigate.prev?null:e.navigate.prev.link)))("next",t.WLB(9,U,null==e.navigate||null==e.navigate.next?null:e.navigate.next.text,t.VKq(7,N,null==e.navigate||null==e.navigate.next?null:e.navigate.next.link)))}}const Pt=function(n){return{navigate:n}};let H=(()=>{var n;class a{constructor(o,i,r,l,c,C,B){this.router=o,this.route=i,this.breakpointObserver=r,this.libraryService=l,this.titleService=c,this.authService=C,this.changeDetector=B,this.isLoading=!1,this.isNavigation=!1,this.isShowTableContent=!1,this.contentEditable=!1,this.isPhone=!1,this.navigate={},this.fontSize=18,this.fontSizeRange=[10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46],this.library=[],this.tableContent=[],this.selectedIndex=0}ngOnInit(){this.isNavigation=!1,this.getBooks(),this.updateLayout()}ngOnChanges(o){this.updateLayout(),this.changeDetector.detectChanges()}ngAfterViewChecked(){this.getTableContentByKey()}updateLayout(){setTimeout(()=>{this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(o=>{this.isPhone=o.matches,o.matches?localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!0,isHideBottomNavBar:!0})):localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!1,isHideBottomNavBar:!1})),this.changeDetector.detectChanges()})},0)}getBooks(){this.updateLayout(),this.getStaticBooks()}getBook(){this.route.params.subscribe(o=>{this.key=o.key,o.key&&!o.level&&(this.isShowTableContent||this.getContent(o.key,o.level)),o.key&&o.level&&(this.level=o.level,this.isShowTableContent||(this.getContent(o.key,o.level),this.router.navigate(["."],{relativeTo:this.route,fragment:location.hash.replace("#","")})))})}getStaticBooks(){this.libraryService.getStaticBooks().subscribe(o=>{o.data&&(this.library=this.library.concat(o.data)?.filter(i=>i.published),this.getBookFromLibrary(),this.getReadingBooks(),this.route.queryParamMap.subscribe(i=>{this.isShowTableContent=i.params.tableContent}),this.getBook(),this.authService.getCurrentUser(),this.contentEditable=this.authService.contentEditable,this.changeDetector.detectChanges())})}getBookFromLibrary(){this.libraryService.getBookFromLibrary().subscribe({next:o=>{this.getReadingBooks(),o.data&&(this.library=this.library.concat(o.data)?.filter(i=>i.published),this.getBook())},complete:()=>{this.isShowTableContent&&(this.library.find(i=>i.key===this.key),this.getTableContentByKey())}})}getReadingBooks(){const o=JSON.parse(localStorage.getItem("reading")||"[]");this.library.forEach(i=>{const r=o.find(l=>l?.key===i?.key);r&&(i.reading=r)})}getContent(o,i){this.isLoading=!0,this.origin=null;const r=this.library.find(l=>l.key===o);this.contentName=r?.name,this.changeDetector.detectChanges(),this.libraryService.getBookByKey(o,r?.isStatic).subscribe(l=>{l&&(this.content=l.data,this.origin=r?.origin,this.isLoading=!1,this.getTableContentByKey())})}getTableContentByKey(){0===this.tableContent?.length&&document.getElementById("markdownContent")?.childNodes.forEach(i=>{i.id&&this.tableContent.push({key:i.id,description:i.textContent,tagName:i.tagName}),this.tableContent=[...new Set(this.tableContent)],this.changeDetector.detectChanges()})}onSaveContent(){navigator.clipboard.writeText(JSON.stringify({data:this.rootContent}))}onNextContent(){this.router.navigate([this.navigate.next.link],{queryParams:{autoplay:!0}}).then(()=>{localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!0,isHideBottomNavBar:!0}))})}getNavigateLink(){if(!this.isShowTableContent&&this.level){const i=this.tableContent.find(l=>l.key===this.level),r=this.tableContent.indexOf(i);this.navigate.prev={},this.tableContent[r-1]?(this.isNavigation=!0,this.navigate.prev.text=`${this.tableContent[r-1].description}`,this.navigate.prev.link=`thu-vien/${this.key}/${this.tableContent[r-1].key}`):this.navigate.prev.link="/",this.navigate.next={},this.tableContent[r+1]?(this.isNavigation=!0,this.navigate.next.text=`${this.tableContent[r+1].description}`,this.navigate.next.link=`thu-vien/${this.key}/${this.tableContent[r+1].key}`):this.navigate.next.link="/"}}readContent(o){o?.attrs?.hash?.includes("#")?this.router.navigate([o?.attrs?.pathname],{fragment:o?.attrs?.hash.replace("#","")}):this.router.navigate([`${o?.attrs?.pathname}${o?.attrs?.hash||""}`])}onReadNow(){this.isLoading=!0,setTimeout(()=>{this.router.navigate([],{queryParams:{tableContent:null},queryParamsHandling:"merge"}).then(()=>{this.isLoading=!1})},0)}getBackLink(){return"thu-vien"}continueReading(o=!1){o?this.router.navigateByUrl(`${this.reading.location.replace(location.origin,"")}`,{state:{autoplay:!0}}):this.router.navigateByUrl(this.reading.location.replace(location.origin,""))}generaToken(o){const i=ee=>{let m=y.enc.Base64.stringify(ee);return m=m.replace(/=+$/,""),m=m.replace(/\+/g,"-"),m=m.replace(/\//g,"_"),m},c=i(y.enc.Utf8.parse(JSON.stringify({alg:"HS256",typ:"JWT"}))),B=i(y.enc.Utf8.parse(JSON.stringify(o))),Vt=y.HmacSHA512("caodaiondata","caodaionkey").toString();return`${c}.${B}.${btoa(Vt)}`}updateFontSize(){const o=JSON.parse(localStorage.getItem("users")||"{}"),i=localStorage.getItem("token");if(i){const l=(new st.N0).decodeToken(i);l.fontSize=this.fontSize,o[l.userName]&&(o[l.userName]=this.generaToken(l),localStorage.setItem("users",JSON.stringify(o)),localStorage.setItem("token",JSON.stringify(this.generaToken(l))))}}}return(n=a).\u0275fac=function(o){return new(o||n)(t.Y36(f.F0),t.Y36(f.gz),t.Y36(T.Yg),t.Y36(S),t.Y36(ct.Dx),t.Y36(A.e),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-book"]],features:[t.TTD],decls:9,vars:10,consts:[[1,"wrapper-container","book-content-container"],[1,"header",3,"prevPage"],[1,"book-header"],["mode","indeterminate",4,"ngIf"],["class","book-container-wrapper",4,"ngIf"],[3,"prev","next",4,"ngIf"],["mode","indeterminate"],[1,"book-container-wrapper"],[1,"h-full",3,"selectedIndexChange"],[3,"label"],[1,"flex","flex-col","overflow-hidden","h-full"],[1,"w-full","flex","items-center"],[1,"w-full"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",3,"matTooltip","color","click"],["class","h-100 px-3 flex-1 overflow-auto",3,"ngStyle",4,"ngIf"],[3,"mode","position"],["libradianDrawer",""],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"value"],[1,"h-100","px-3","flex-1","overflow-auto",3,"ngStyle"],["class","variable-binding w-full text-justify bg-white select-text",3,"data",4,"ngIf"],[1,"variable-binding","w-full","text-justify","bg-white","select-text",3,"data"],["matRipple","",1,"block","p-3",3,"href","click"],["class","font-black",4,"ngIf"],["class","pl-1 font-bold",4,"ngIf"],["class","",4,"ngIf"],[1,"font-black"],[1,"pl-1","font-bold"],[1,""],["class","w-full h-full","allow","autoplay",3,"src",4,"ngIf"],["allow","autoplay",1,"w-full","h-full",3,"src"],["mat-flat-button","",1,"w-full",3,"href","color"],["matRipple","",1,"w-full","block","p-3",3,"href"],[4,"ngIf"],[3,"prev","next"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"app-header",1)(2,"div",2)(3,"app-header-title"),t._uU(4),t.qZA()()(),t.YNc(5,ht,1,0,"mat-progress-bar",3),t.YNc(6,Bt,20,10,"div",4),t.YNc(7,Ut,5,4,"div",4),t.YNc(8,Ht,1,12,"app-bottom-navigator",5),t.qZA()),2&o&&(t.xp6(1),t.Q6J("prevPage",t.VKq(8,Pt,t.VKq(6,N,i.getBackLink()))),t.xp6(3),t.Oqu(i.contentName),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",!i.isShowTableContent),t.xp6(1),t.Q6J("ngIf",i.isShowTableContent),t.xp6(1),t.Q6J("ngIf",i.isNavigation))},dependencies:[p.sg,p.O5,p.PC,b.uX,b.SP,w.Hw,v.zs,v.lW,u.jA,u.kh,u.LW,x.KE,x.hX,_.JJ,_.On,Z.d,pt.G,gt.d,L.pW,dt.T,ut,$.gD,I.ey,F.gM,I.wG,mt.y],styles:["app-book{display:flex;flex-direction:column;height:100%;max-height:100%;overflow:hidden}  app-book .mat-expansion-panel-header[aria-disabled=true]{color:unset}  app-book .book-content-title{padding:2rem;margin:0}  app-book .book-container-wrapper{flex:1;overflow:hidden}  app-book .book-table-content-container-wrapper{flex:1;overflow:auto}  app-book .book-header{white-space:normal;overflow:hidden;width:100%}  app-book .content-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}  app-book .reading-section button{margin-bottom:1rem}  app-book blockquote{display:block;margin-block-start:1em;margin-block-end:1em;margin-inline-start:40px;margin-inline-end:40px}  app-book p{display:block;margin-block-start:1em;margin-block-end:1em;margin-inline-start:0px;margin-inline-end:0px}  app-book .mat-mdc-tab-body-wrapper{height:100%}  app-book .mat-drawer{width:200px}"]}),a})();const qt=[{path:"",children:[{path:"",component:lt},{path:":key",component:H},{path:":key/:level",component:H}]}];let Et=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[f.Bz.forChild(qt),f.Bz]}),a})();var jt=s(4085),Kt=s(4649),Dt=s(8955),zt=s(3305),Rt=s(9038);let Gt=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,Y.JP]}),a})();var Wt=s(8554);let Xt=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,Et,b.Nh,J.N6,d.QW,w.Ps,v.ot,u.SJ,x.lN,O.c,_.u5,Z.t,Q.p9,jt.O,L.Cv,Kt.m,Dt.e,zt.To,Rt.ie,Gt,$.LD,F.AV,I.si,Wt.m]}),a})()}}]);