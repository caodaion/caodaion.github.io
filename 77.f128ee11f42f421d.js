"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[77],{8077:(Ct,T,l)=>{l.r(T),l.d(T,{LibraryModule:()=>ft});var p=l(6895),u=l(9299),t=l(4650),f=l(2289),F=l(529);let Z=(()=>{class o{constructor(e){this.http=e}getStaticBooks(){return this.http.get("assets/documents/library/static-library.json")}getBookByKey(e){return this.http.get(`assets/documents/library/${e}.json`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(F.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var q=l(4797),C=l(3848),d=l(3546),y=l(7392),g=l(4859),h=l(3267),b=l(9549),M=l(4144),_=l(4006),I=l(4850),O=l(6709),x=l(782);function P(o,a){if(1&o&&(t.TgZ(0,"mat-grid-tile",6)(1,"div",11)(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.qZA()(),t.TgZ(7,"mat-card-content")(8,"div",12),t._uU(9),t.qZA()()()()),2&o){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("colspan",2===n.gridForYouCols?3:1)("rowspan",1),t.xp6(4),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.subtitle),t.xp6(3),t.Oqu((null==e||null==e.description?null:e.description.length)>290?(null==e||null==e.description?null:e.description.substring(0,290))+"...":null==e?null:e.description)}}function L(o,a){if(1&o&&(t.TgZ(0,"mat-card-header")(1,"mat-card-title"),t._uU(2),t.qZA(),t.TgZ(3,"mat-card-subtitle"),t._uU(4),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.subtitle)}}function Q(o,a){if(1&o&&(t.TgZ(0,"mat-card-content")(1,"div",12),t._uU(2),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu((null==e||null==e.description?null:e.description.length)>290?(null==e||null==e.description?null:e.description.substring(0,290))+"...":null==e?null:e.description)}}const Y=function(){return{focused:!0}},U=function(o){return{"card-image-wrapper":o}};function E(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-grid-tile")(1,"mat-card",4),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.onCardClick(s))}),t.TgZ(2,"mat-grid-list",5)(3,"mat-grid-tile",6)(4,"div",7),t._UZ(5,"img",8),t.qZA()(),t.YNc(6,P,10,5,"mat-grid-tile",9),t.qZA(),t.YNc(7,L,5,2,"mat-card-header",10),t.YNc(8,Q,3,1,"mat-card-content",10),t.qZA()()}if(2&o){const e=a.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.DdM(12,Y)),t.xp6(1),t.Q6J("cols",2===n.gridForYouCols?4:1)("gutterSize",2===n.gridForYouCols?"16":"0")("rowHeight",2===n.gridForYouCols?"100%":"2:1"),t.xp6(1),t.Q6J("colspan",1)("rowspan",1),t.xp6(1),t.Q6J("ngClass",t.VKq(13,U,2==n.gridForYouCols)),t.xp6(1),t.Q6J("src",null==e?null:e.image,t.LSH)("alt",null==e?null:e.name),t.xp6(1),t.Q6J("ngIf",2===n.gridForYouCols),t.xp6(1),t.Q6J("ngIf",1==n.gridForYouCols),t.xp6(1),t.Q6J("ngIf",1==n.gridForYouCols)}}let H=(()=>{class o{constructor(e){this.breakpointObserver=e,this.gridForYouCols=2,this.forYouBooks=[],this.onItemFocus=new t.vpe}ngOnInit(){this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(e=>{this.gridForYouCols=e.matches?1:2})}ngOnChanges(){this.getForYouBooks()}onCardClick(e){this.onItemFocus.emit(e)}getForYouBooks(){this.forYouBooks=this.books?.filter(e=>e?.published)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(f.Yg))},o.\u0275cmp=t.Xpm({type:o,selectors:[["librarian-books"]],inputs:{books:"books"},outputs:{onItemFocus:"onItemFocus"},features:[t.TTD],decls:6,vars:3,consts:[[1,"container-fluid"],[1,"for-your-books"],["gutterSize","30",3,"cols","rowHeight"],[4,"ngFor","ngForOf"],["appearance","outlined",1,"card-grid",3,"ngClass","click"],[3,"cols","gutterSize","rowHeight"],[3,"colspan","rowspan"],[3,"ngClass"],["mat-card-image","",3,"src","alt"],[3,"colspan","rowspan",4,"ngIf"],[4,"ngIf"],[1,"h-100","w-100"],[1,"card-description"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2"),t._uU(3,"D\xe0nh cho b\u1ea1n"),t.qZA(),t.TgZ(4,"mat-grid-list",2),t.YNc(5,E,9,15,"mat-grid-tile",3),t.qZA()()()),2&e&&(t.xp6(4),t.Q6J("cols",n.gridForYouCols)("rowHeight",2===n.gridForYouCols?"5:2":"4:5"),t.xp6(1),t.Q6J("ngForOf",n.forYouBooks))},dependencies:[p.mk,p.sg,p.O5,x.Il,x.DX,d.a8,d.dn,d.dk,d.G2,d.$j,d.n5],styles:[".card-grid[_ngcontent-%COMP%]{width:calc(100% - 3px);height:calc(100% - 3px);overflow:hidden;border-radius:1rem;cursor:pointer}.card-grid.focused[_ngcontent-%COMP%]{background-color:#eaf1fb}.card-grid[_ngcontent-%COMP%]   .card-image-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;padding:1rem 0 1rem 1rem}.card-grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:1rem;width:100%;height:100%;object-fit:cover}"]}),o})();function K(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",21)(2,"div",22)(3,"mat-label"),t._uU(4,"Published"),t.qZA(),t.TgZ(5,"mat-checkbox",23),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.published=i)}),t.qZA()(),t.TgZ(6,"div",22)(7,"mat-form-field",24)(8,"mat-label"),t._uU(9,"Key"),t.qZA(),t.TgZ(10,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.key=i)}),t.qZA()()(),t.TgZ(11,"div",22)(12,"mat-form-field",24)(13,"mat-label"),t._uU(14,"T\xean"),t.qZA(),t.TgZ(15,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.name=i)}),t.qZA()()(),t.TgZ(16,"div",22)(17,"mat-form-field",24)(18,"mat-label"),t._uU(19,"Subtitle"),t.qZA(),t.TgZ(20,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.subtitle=i)}),t.qZA()()(),t.TgZ(21,"div",22)(22,"mat-form-field",24)(23,"mat-label"),t._uU(24,"Path"),t.qZA(),t.TgZ(25,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.path=i)}),t.qZA()()(),t.TgZ(26,"div",22)(27,"div",26),t._UZ(28,"img",27),t.TgZ(29,"div")(30,"mat-form-field",24)(31,"mat-label"),t._uU(32,"H\xecnh \u1ea3nh"),t.qZA(),t.TgZ(33,"input",25),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.image=i)}),t.qZA()()()()(),t.TgZ(34,"div",28)(35,"mat-form-field",29)(36,"mat-label"),t._uU(37,"M\xf4 t\u1ea3"),t.qZA(),t.TgZ(38,"textarea",30),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.description=i)}),t.qZA()()()(),t._UZ(39,"mat-divider"),t.qZA()}if(2&o){const e=a.$implicit;t.xp6(5),t.Q6J("ngModel",e.published),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.key),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.name),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.subtitle),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.path),t.xp6(3),t.Q6J("src",e.image,t.LSH)("alt",e.name),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.image),t.xp6(2),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("ngModel",e.description)}}function $(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-tab",17)(1,"div",6)(2,"div",18)(3,"h2"),t._uU(4,"Settings"),t.qZA(),t.TgZ(5,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveSettings())}),t._uU(6," Save "),t.qZA()(),t.YNc(7,K,40,15,"div",19),t.TgZ(8,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addNewSettings())}),t._uU(9,"+ Add new"),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Q6J("color","primary"),t.xp6(2),t.Q6J("ngForOf",e.staticBooks)}}function G(o,a){if(1&o&&(t.TgZ(0,"div",31)(1,"h4"),t._uU(2,"M\xf4 t\u1ea3:"),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t._UZ(5,"mat-divider"),t.qZA()),2&o){const e=t.oxw();t.xp6(4),t.Oqu(null==e.previewingItem?null:e.previewingItem.description)}}function j(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1," \u0111\u1ebfn \u0111o\u1ea1n: "),t._UZ(2,"br"),t._uU(3),t.qZA()),2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",null==e.previewingItem||null==e.previewingItem.reading?null:e.previewingItem.reading.stopAt," ")}}function D(o,a){if(1&o&&(t.TgZ(0,"div",31)(1,"h4"),t._uU(2,"\u0110ang \u0111\u1ecdc:"),t.qZA(),t.TgZ(3,"p")(4,"strong"),t._uU(5),t.qZA(),t.YNc(6,j,4,1,"span",32),t.qZA()()),2&o){const e=t.oxw();t.xp6(5),t.Oqu(null==e.previewingItem||null==e.previewingItem.reading?null:e.previewingItem.reading.name),t.xp6(1),t.Q6J("ngIf",null==e.previewingItem||null==e.previewingItem.reading?null:e.previewingItem.reading.stopAt)}}function R(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onRead(null==i.previewingItem||null==i.previewingItem.reading?null:i.previewingItem.reading.location))}),t._uU(1," \u0110\u1eccC TI\u1ebeP "),t.qZA()}2&o&&t.Q6J("color","primary")}let z=(()=>{class o{constructor(e,n,i,s,r){this.breakpointObserver=e,this.libraryService=n,this.changeDetector=i,this.authService=s,this.router=r,this.staticBooks=[],this.contentEditable=!1,this.contentEditable=this.authService.contentEditable}ngOnInit(){this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(e=>{this.mode=e.matches?"over":"side"}),this.getBooks()}getBooks(){this.getStaticBooks()}getStaticBooks(){this.libraryService.getStaticBooks().subscribe(e=>{e.data&&(this.staticBooks=e.data,this.getReadingBooks(),this.changeDetector.detectChanges())})}getReadingBooks(){const e=JSON.parse(localStorage.getItem("reading")||"[]");this.staticBooks.forEach(n=>{const i=e.find(s=>s?.key===n?.key);i&&(n.reading=i)})}saveSettings(){const e={data:this.staticBooks.map(n=>({name:n?.name,image:n?.image,description:n?.description,key:n?.key,subtitle:n?.subtitle,path:n?.path,published:n?.published}))};navigator.clipboard.writeText(JSON.stringify(e))}onRead(e,n=!1){n?this.router.navigate([e.replace(location.origin,"")],{queryParams:{tableContent:!0}}):this.router.navigateByUrl(e.replace(location.origin,""))}addNewSettings(){this.staticBooks.push({})}onItemFocus(e,n){this.previewingItem?.key===e.key?n.toggle():(this.previewingItem=e,n.open())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(f.Yg),t.Y36(Z),t.Y36(t.sBO),t.Y36(q.e),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-librarian"]],decls:28,vars:12,consts:[[1,"librarian-container"],["label","S\xe1ch"],[3,"books","onItemFocus"],["label","Settings",4,"ngIf"],[3,"mode","position"],["libradianDrawer",""],[1,"container-fluid"],[1,"preview-area"],["mat-icon-button","",1,"preview-close",3,"click"],[1,"d-flex","align-items-center","flex-column"],[1,"text-center"],[1,"preview-image-wrapper"],["mat-card-image","",3,"src","alt"],["class","w-100",4,"ngIf"],[1,"read-now-button"],["mat-flat-button","","style","margin-bottom: 1rem;",3,"color","click",4,"ngIf"],["mat-flat-button","",3,"color","click"],["label","Settings"],[1,"w-100","d-flex","align-items-center","justify-content-between"],[4,"ngFor","ngForOf"],["mat-flat-button","",3,"click"],[1,"d-flex","flex-wrap"],[1,"form-group"],[3,"ngModel","ngModelChange"],[3,"appearance"],["type","text","matInput","",3,"ngModel","ngModelChange"],[1,"d-flex"],["width","150px",3,"src","alt"],[1,"form-group","w-100",2,"margin-top","1rem"],[1,"w-100",3,"appearance"],["matInput","","resize","",3,"ngModel","ngModelChange"],[1,"w-100"],[4,"ngIf"],["mat-flat-button","",2,"margin-bottom","1rem",3,"color","click"]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer-content")(2,"mat-tab-group")(3,"mat-tab",1)(4,"librarian-books",2),t.NdJ("onItemFocus",function(r){t.CHM(i);const c=t.MAs(7);return t.KtG(n.onItemFocus(r,c))}),t.qZA()(),t.YNc(5,$,10,2,"mat-tab",3),t.qZA()(),t.TgZ(6,"mat-drawer",4,5)(8,"div",6)(9,"div",7)(10,"button",8),t.NdJ("click",function(){t.CHM(i);const r=t.MAs(7);return t.KtG(r.close())}),t.TgZ(11,"mat-icon"),t._uU(12,"close"),t.qZA()(),t.TgZ(13,"div",9)(14,"h2",10),t._uU(15,"T\xf3m t\u1eaft"),t.qZA(),t.TgZ(16,"div",11),t._UZ(17,"img",12),t.qZA(),t.TgZ(18,"h3",10),t._uU(19),t.qZA(),t.TgZ(20,"p",10),t._uU(21),t.qZA(),t.YNc(22,G,6,1,"div",13),t.YNc(23,D,7,2,"div",13),t.qZA()()(),t.TgZ(24,"div",14),t.YNc(25,R,2,1,"button",15),t.TgZ(26,"button",16),t.NdJ("click",function(){return n.onRead(null==n.previewingItem?null:n.previewingItem.path,!0)}),t._uU(27," XEM M\u1ee4C L\u1ee4C "),t.qZA()()()()}2&e&&(t.xp6(4),t.Q6J("books",n.staticBooks),t.xp6(1),t.Q6J("ngIf",n.contentEditable),t.xp6(1),t.Q6J("mode","side")("position","end"),t.xp6(11),t.Q6J("src",null==n.previewingItem?null:n.previewingItem.image,t.LSH)("alt",null==n.previewingItem?null:n.previewingItem.name),t.xp6(2),t.Oqu(null==n.previewingItem?null:n.previewingItem.name),t.xp6(2),t.Oqu(null==n.previewingItem?null:n.previewingItem.subtitle),t.xp6(1),t.Q6J("ngIf",!(null==n.previewingItem||!n.previewingItem.description)),t.xp6(1),t.Q6J("ngIf",!(null==n.previewingItem||null==n.previewingItem.reading||!n.previewingItem.reading.key)),t.xp6(2),t.Q6J("ngIf",!(null==n.previewingItem||null==n.previewingItem.reading||!n.previewingItem.reading.key)),t.xp6(1),t.Q6J("color","primary"))},dependencies:[p.sg,p.O5,C.uX,C.SP,d.G2,y.Hw,g.lW,g.RK,h.jA,h.kh,h.LW,b.KE,b.hX,M.Nt,_.Fj,_.JJ,_.On,I.d,O.oG,H],styles:[".librarian-container[_ngcontent-%COMP%]{background-color:#fff}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]{min-width:300px;width:100%;max-width:400px;background-color:#d3e3fd;border-left-color:#d3e3fd;border-top-left-radius:1rem}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-close[_ngcontent-%COMP%]{position:absolute;top:1rem;left:1rem;background-color:#d3e3fd}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]{padding:1rem}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   .preview-image-wrapper[_ngcontent-%COMP%]{width:200px;height:300px;border-radius:1rem;margin:1rem 0}.librarian-container[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]   .preview-area[_ngcontent-%COMP%]   .preview-image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.librarian-container[_ngcontent-%COMP%]   .read-now-button[_ngcontent-%COMP%]{width:100%;position:sticky;background-color:#d3e3fd;padding:1rem;bottom:0}.librarian-container[_ngcontent-%COMP%]   .read-now-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;border-radius:50px}.librarian-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{padding:0 1rem}"]}),o})();var W=l(1481),X=l(3883),V=l(5203),J=l(3162),tt=l(5895),et=l(7759),m=l(7084),k=l(6338);function nt(o,a){1&o&&t._UZ(0,"mat-progress-bar",7)}function ot(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",10)(1,"cp-content-creator",11),t.NdJ("save",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onSaveContent())})("nextContent",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onNextContent())}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("data",e.content)("rootContent",e.rootContent)}}function it(o,a){if(1&o&&(t.TgZ(0,"div",8),t.YNc(1,ot,2,2,"div",9),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.content)}}function at(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-list-item")(1,"div",21)(2,"div",15),t._uU(3),t.qZA(),t.TgZ(4,"div",16)(5,"button",17),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(3);return t.KtG(r.readContent(s))}),t._uU(6,"\u0110\u1ecdc"),t.qZA()()()()}if(2&o){const e=a.$implicit,n=t.oxw(3);t.xp6(3),t.Oqu(n.getContentName(e))}}function rt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",19)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"h3",15),t._uU(4),t.qZA()(),t.TgZ(5,"div",16)(6,"button",17),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.readContent(s))}),t._uU(7,"\u0110\u1ecdc"),t.qZA()()(),t.TgZ(8,"div")(9,"mat-list"),t.YNc(10,at,7,1,"mat-list-item",20),t.qZA()()()}if(2&o){const e=a.$implicit,n=t.oxw(2);t.Q6J("expanded",!1),t.xp6(4),t.Oqu(n.getContentName(e)),t.xp6(6),t.Q6J("ngForOf",null==e?null:e.content)}}function lt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",12)(1,"mat-accordion",13)(2,"mat-expansion-panel",14)(3,"mat-expansion-panel-header")(4,"mat-panel-title")(5,"h2",15),t._uU(6),t.qZA()(),t.TgZ(7,"div",16)(8,"button",17),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onReadNow())}),t._uU(9,"\u0110\u1ecdc"),t.qZA()()(),t.TgZ(10,"div")(11,"mat-accordion",13),t.YNc(12,rt,11,3,"mat-expansion-panel",18),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("expanded",!0),t.xp6(4),t.Oqu(null==e.content?null:e.content.name),t.xp6(6),t.Q6J("ngForOf",null==e.content?null:e.content.content)}}const A=function(o){return{link:o}},st=function(o){return{text:"Tr\u01b0\u1edbc \u0111\xf3",navigate:o}},ct=function(o){return{text:"Ti\u1ebfp theo",navigate:o}};function pt(o,a){if(1&o&&t._UZ(0,"app-bottom-navigator",22),2&o){const e=t.oxw();t.Q6J("prev",t.VKq(4,st,t.VKq(2,A,e.navigate.prev.link)))("next",t.VKq(8,ct,t.VKq(6,A,e.navigate.next.link)))}}const dt=function(o,a){return{link:o,queryParams:a}},ut=function(o){return{navigate:o}};let B=(()=>{class o{constructor(e,n,i,s,r){this.router=e,this.route=n,this.breakpointObserver=i,this.libraryService=s,this.titleService=r,this.isLoading=!1,this.isShowTableContent=!1,this.navigate={prev:{link:void 0,queryParams:{}},next:{link:void 0,queryParams:{}}}}ngOnInit(){this.route.queryParamMap.subscribe(e=>{this.isShowTableContent=e.params.tableContent}),this.route.params.subscribe(e=>{e.key&&!e.level&&this.getContent(e.key,e.level),e.key&&e.level&&(this.getContent(e.key,e.level),this.level=e.level,this.router.navigate(["."],{relativeTo:this.route,fragment:location.hash.replace("#","")}))})}getContent(e,n){this.isLoading=!0,this.libraryService.getBookByKey(e).subscribe(i=>{if(i.data){if(this.rootContent=i.data,0===this.rootContent?.content?.length&&this.rootContent?.content.push({type:"block",key:e.replaceAll("-",""),content:[],attrs:{hash:"",pathname:location.pathname}}),this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(c=>{c.matches?localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!0,isHideBottomNavBar:!0})):localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!1,isHideBottomNavBar:!1}))}),n){const c=(v,N)=>{let S;return v.some(w=>S=w.key===N?w:c(w.content||[],N)),S};this.content=c(i.data.content,location.pathname.slice(1,location.pathname.length).split("/").slice(1).join("-").replaceAll("-","")),this.titleService.setTitle(`${this.content?.name} | ${this.rootContent?.name} | CaoDaiON`),this.isLoading=!1,this.getNavigateLink()}else this.content=i.data,this.titleService.setTitle(`${this.content.name} | ${this.rootContent.name} | CaoDaiON`),this.isLoading=!1,this.getNavigateLink();location.hash&&setTimeout(()=>{const c=document.getElementById(`${location.pathname.slice(1,location.pathname.length).split("/").slice(1).join("-").replaceAll("-","")}${location.hash.replace("#","")}`),v=document.getElementById("contentCreatorWrapper");c&&(c.style.color="#4285f4",v&&c&&v.scroll({top:c.offsetTop-(this.content.audio?60:0)}))},0);let s=JSON.parse(localStorage.getItem("reading")||"[]");s||(s=[]);let r=s.find(c=>c.key==this.rootContent.key);r?r.content!==this.content.key&&(r.content=this.content.key,r.name=this.content.name,r.location=location.href):s.push({name:this.rootContent.name,content:this.content.key||this.rootContent.key,key:this.rootContent.key,location:location.href}),this.level&&localStorage.setItem("reading",JSON.stringify(s))}})}onSaveContent(){console.log(this.rootContent),navigator.clipboard.writeText(JSON.stringify({data:this.rootContent}))}onNextContent(){this.router.navigate([this.navigate.next.link],{queryParams:{autoplay:!0}}).then(()=>{localStorage.setItem("currentLayout",JSON.stringify({isHideToolbar:!0,isHideBottomNavBar:!0}))})}getNavigateLink(){this.isShowTableContent?this.navigate.prev.queryParams={}:(this.navigate.prev.queryParams={tableContent:!this.isShowTableContent},this.navigate.prev.link=this.rootContent.content[this.rootContent.content.findIndex(n=>n.key==this.content?.key)-1]?.attrs.pathname+this.rootContent.content[this.rootContent.content.findIndex(n=>n.key==this.content.key)-1]?.attrs.hash||"/",this.navigate.next.link=this.rootContent.content[this.rootContent.content.findIndex(n=>n.key==this.content?.key)+1]?.attrs.pathname+this.rootContent.content[this.rootContent.content.findIndex(n=>n.key==this.content.key)+1]?.attrs.hash||"/")}getContentName(e){if(!e?.name){let n="";return e?.content[0]?.content.forEach(i=>{"text"==i.type&&(n+=i?.text)}),n}return e?.name}readContent(e){e?.attrs?.hash?.includes("#")?this.router.navigate([e?.attrs?.pathname],{fragment:e?.attrs?.hash.replace("#","")}):this.router.navigate([`${e?.attrs?.pathname}${e?.attrs?.hash||""}`])}onReadNow(){this.isLoading=!0,setTimeout(()=>{this.router.navigate([],{queryParams:{tableContent:null},queryParamsHandling:"merge"}).then(()=>{this.isLoading=!1})},0)}getBackLink(){return this.level||this.isShowTableContent?this.level&&!this.isShowTableContent?(this.navigate.prev.queryParams={tableContent:!this.isShowTableContent},""):(this.navigate.prev.queryParams={},""):(this.navigate.prev.queryParams={tableContent:!this.isShowTableContent},location.pathname)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.F0),t.Y36(u.gz),t.Y36(f.Yg),t.Y36(Z),t.Y36(W.Dx))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-book"]],decls:9,vars:11,consts:[[1,"wrapper-container","book-content-container"],[1,"header",3,"prevPage"],[1,"book-header"],["mode","indeterminate",4,"ngIf"],["class","book-container-wrapper",4,"ngIf"],["class","book-table-content-container-wrapper",4,"ngIf"],[3,"prev","next",4,"ngIf"],["mode","indeterminate"],[1,"book-container-wrapper"],["class","h-100",4,"ngIf"],[1,"h-100"],[3,"data","rootContent","save","nextContent"],[1,"book-table-content-container-wrapper"],["multi",""],["disabled","","hideToggle","",3,"expanded"],[1,"content-name"],[1,"d-flex","align-items-center"],["mat-stroked-button","",3,"click"],["hideToggle","",3,"expanded",4,"ngFor","ngForOf"],["hideToggle","",3,"expanded"],[4,"ngFor","ngForOf"],[1,"w-100","d-flex","justify-content-between","align-items-center"],[3,"prev","next"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-header",1)(2,"div",2)(3,"app-header-title"),t._uU(4),t.qZA()()(),t.YNc(5,nt,1,0,"mat-progress-bar",3),t.YNc(6,it,2,1,"div",4),t.YNc(7,lt,13,3,"div",5),t.YNc(8,pt,1,10,"app-bottom-navigator",6),t.qZA()),2&e&&(t.xp6(1),t.Q6J("prevPage",t.VKq(9,ut,t.WLB(6,dt,n.getBackLink(),n.navigate.prev.queryParams))),t.xp6(3),t.Oqu(null==n.content?null:n.content.name),t.xp6(1),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngIf",!n.isShowTableContent),t.xp6(1),t.Q6J("ngIf",n.isShowTableContent),t.xp6(1),t.Q6J("ngIf","block"==(null==n.content?null:n.content.type)))},dependencies:[p.sg,p.O5,g.lW,X.G,V.d,J.pW,tt.S,et.T,m.pp,m.ib,m.yz,m.yK,k.i$,k.Tg],styles:["app-book{display:flex;flex-direction:column;height:100%;max-height:100%;overflow:hidden}  app-book .book-content-title{padding:2rem;margin:0}  app-book .book-container-wrapper{flex:1;overflow:hidden}  app-book .book-table-content-container-wrapper{flex:1;overflow:auto}  app-book .book-header{white-space:normal;overflow:hidden;width:100%}  app-book .content-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),o})();const mt=[{path:"",children:[{path:"",component:z},{path:":key",component:B},{path:":key/:level",component:B}]}];let gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.Bz.forChild(mt),u.Bz]}),o})();var ht=l(1259),_t=l(7154),vt=l(7533);let ft=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,gt,C.Nh,x.N6,d.QW,y.Ps,g.ot,h.SJ,b.lN,M.c,_.u5,I.t,O.p9,ht.O,J.Cv,_t.m,vt.e,m.To,k.ie]}),o})()}}]);