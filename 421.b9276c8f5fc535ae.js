"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[421],{2421:(nt,g,u)=>{u.r(g),u.d(g,{SyncModule:()=>tt});var d=u(6814),p=u(2787),D=u(6091),f=u(1158),T=u(9486),t=u(5879),m=u(9347),Z=u(1088),l=u(5313),y=u(9038),v=u(6385),E=u(2296),S=u(617);const x=["confirmSyncJourneyDialog"];function C(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(4);return t.KtG(c.onSyncJourneyData())}),t.TgZ(1,"mat-icon"),t._uU(2,"sync"),t.qZA(),t._uU(3," \u0110\u1ed3ng b\u1ed9 ngay "),t.qZA()}2&n&&t.Q6J("color","primary")}const A=function(n){return{fontSize:n}};function b(n,o){if(1&n&&(t.TgZ(0,"div",7)(1,"span",8),t._uU(2,"\u{1f389}"),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"D\u1eef li\u1ec7u S\u1ed5 tay h\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c \u0111\u1ed3ng b\u1ed9 gi\u1ed1ng nhau"),t.qZA(),t.TgZ(5,"button",9)(6,"mat-icon"),t._uU(7,"trip_origin"),t.qZA(),t._uU(8," Xem S\u1ed5 tay h\xe0nh tr\xecnh "),t.qZA()()),2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngStyle",t.VKq(3,A,e.isShowPhoneLayout?"100px":"200px")),t.xp6(4),t.Q6J("color","primary")("routerLink","/hanh-trinh")}}function J(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Th\u1eddi gian"),t.qZA())}function N(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.timestamp,"dd/MM/YYYY hh:mm:ss")," ")}}function U(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Lo\u1ea1i"),t.qZA())}function w(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(1),t.hij(" ",i.getRowData(e,"type")," ")}}function Y(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"\u0110\u1ecba \u0111i\u1ec3m"),t.qZA())}function k(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(1),t.hij(" ",i.getRowData(e,"location")," ")}}function I(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"\u0110\xe1nh gi\xe1"),t.qZA())}function q(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(1),t.hij(" ",i.ratingPieChartLabels[e.rating-1]||"Ch\u01b0a \u0111\xe1nh gi\xe1"," ")}}function L(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Thi\u1ebft b\u1ecb"),t.qZA())}function Q(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.AsE(" ",e.method," tr\xean ",e.device," ")}}function B(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Ghi ch\xfa"),t.qZA())}function O(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",e.comment," ")}}function F(n,o){1&n&&t._UZ(0,"tr",23)}function j(n,o){1&n&&t._UZ(0,"tr",24)}function R(n,o){if(1&n&&(t.TgZ(0,"table",10),t.ynx(1,11),t.YNc(2,J,2,0,"th",12),t.YNc(3,N,3,4,"td",13),t.BQk(),t.ynx(4,14),t.YNc(5,U,2,0,"th",12),t.YNc(6,w,2,1,"td",13),t.BQk(),t.ynx(7,15),t.YNc(8,Y,2,0,"th",12),t.YNc(9,k,2,1,"td",13),t.BQk(),t.ynx(10,16),t.YNc(11,I,2,0,"th",12),t.YNc(12,q,2,1,"td",13),t.BQk(),t.ynx(13,17),t.YNc(14,L,2,0,"th",12),t.YNc(15,Q,2,2,"td",13),t.BQk(),t.ynx(16,18),t.YNc(17,B,2,0,"th",12),t.YNc(18,O,2,1,"td",13),t.BQk(),t.YNc(19,F,1,0,"tr",19),t.YNc(20,j,1,0,"tr",20),t.qZA()),2&n){const e=t.oxw(4);t.Q6J("dataSource",e.syncData.data),t.xp6(19),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function G(n,o){if(1&n&&(t.TgZ(0,"mat-list-item")(1,"span",26),t._uU(2),t.qZA(),t.TgZ(3,"span",27)(4,"strong"),t._uU(5,"\u0110\u1ecba \u0111i\u1ec3m:"),t.qZA(),t._uU(6),t.qZA(),t.TgZ(7,"span",27)(8,"strong"),t._uU(9,"Th\u1eddi gian:"),t.qZA(),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"span",27)(13,"strong"),t._uU(14,"\u0110\xe1nh gi\xe1: "),t.qZA(),t._uU(15),t.qZA(),t.TgZ(16,"span",27)(17,"strong"),t._uU(18,"Ph\u01b0\u01a1ng th\u1ee9c: "),t.qZA(),t._uU(19),t.qZA(),t.TgZ(20,"span",27)(21,"strong"),t._uU(22,"Ghi ch\xfa: "),t.qZA(),t._uU(23),t.qZA(),t._UZ(24,"mat-divider",27),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(2),t.hij("",i.getRowData(e,"type")," "),t.xp6(4),t.hij(" ",i.getRowData(e,"location"),""),t.xp6(4),t.hij(" ",t.xi3(11,7,e.timestamp,"dd/MM/YYYY hh:mm:ss"),""),t.xp6(5),t.Oqu(i.ratingPieChartLabels[e.rating-1]),t.xp6(4),t.AsE("",e.method," tr\xean ",e.device,""),t.xp6(4),t.Oqu(e.comment)}}function H(n,o){if(1&n&&(t.TgZ(0,"mat-list"),t.YNc(1,G,25,10,"mat-list-item",25),t.qZA()),2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngForOf",e.syncData.data)}}function M(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,C,4,1,"button",3),t.YNc(2,b,9,5,"div",4),t.YNc(3,R,21,3,"table",5),t.YNc(4,H,2,1,"mat-list",1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!e.isSyncSavedLoccaly),t.xp6(1),t.Q6J("ngIf",e.isSyncSavedLoccaly),t.xp6(1),t.Q6J("ngIf",!e.isShowPhoneLayout),t.xp6(1),t.Q6J("ngIf",e.isShowPhoneLayout)}}function P(n,o){if(1&n&&(t.TgZ(0,"div")(1,"p"),t._uU(2," D\u1eef li\u1ec7u \u0111\u01b0\u1ee3c \u0111\u1ed3ng b\u1ed9 l\xe0 d\u1eef li\u1ec7u: "),t.TgZ(3,"strong"),t._uU(4," S\u1ed5 tay h\xe0nh tr\xecnh"),t.qZA()(),t.YNc(5,M,5,4,"div",1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf",e.syncData.data)}}function V(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,P,6,1,"div",1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","journey"===(null==e.syncData?null:e.syncData.type))}}function $(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",28),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.onGoToGenerate())}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA(),t._uU(4," T\u1ea1o m\xe3 \u0111\u1ed3ng b\u1ed9 ngay "),t.qZA()()}2&n&&(t.xp6(1),t.Q6J("color","primary"))}function z(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",29),t._uU(1,"X\xe1c nh\u1eadn \u0111\u1ed3ng b\u1ed9 S\u1ed5 tay h\xe0nh tr\xecnh"),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"strong"),t._uU(4,"L\u01afU \xdd:"),t.qZA(),t.TgZ(5,"p"),t._uU(6," N\u1ea5u ch\u1ea5p nh\u1eadn, S\u1ed5 tay h\xe0nh tr\xecnh hi\u1ec7n t\u1ea1i c\u1ee7a b\u1ea1n s\u1ebd \u0111\u01b0\u1ee3c l\xe0m m\u1edbi theo d\u1eef li\u1ec7u \u0111\u1ed3ng b\u1ed9. "),t.qZA(),t.TgZ(7,"p"),t._uU(8,"B\u1ea1n c\xf3 mu\u1ed1n ti\u1ebfp t\u1ee5c?"),t.qZA()(),t.TgZ(9,"mat-dialog-actions")(10,"button",30),t._uU(11,"H\u1ee7y"),t.qZA(),t.TgZ(12,"button",31),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.storeJourney())}),t._uU(13," Ch\u1ea5p nh\u1eadn "),t.qZA()()}2&n&&(t.xp6(12),t.Q6J("color","primary"))}const K=[{path:"",component:(()=>{var n;class o{constructor(i,c,a,_){this.route=i,this.matDialog=c,this.breakpointObserver=a,this.router=_,this.jwtHelper=new D.N0,this.ratingPieChartLabels=["Ho\xe0n to\xe0n kh\xf4ng","Kh\xf4ng h\xe0i l\xf2ng","B\xecnh th\u01b0\u1eddng","H\xe0i l\xf2ng","R\u1ea5t h\xe0i l\xf2ng","Ch\u01b0a \u0111\xe1nh gi\xe1"],this.isShowPhoneLayout=!0,this.displayedColumns=["timestamp","type","location","rating","device","comment"],this.checkInTypes=f.g,this.checkInEvents=f.j,this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(h=>{this.isShowPhoneLayout=!!h.matches})}mergeLocalstorageVariable(){(()=>{let a=JSON.parse(localStorage.getItem("addedVariable")||"null")?.location;a&&a?.length>0&&(this.checkInTypes=this.checkInTypes.concat(a.map(_=>({key:_,label:_,disabled:!1}))))})(),(()=>{let a=JSON.parse(localStorage.getItem("addedVariable")||"null")?.type;a&&a?.length>0&&(this.checkInEvents=this.checkInEvents.concat(a.map(_=>({key:_,label:_,disabled:!1}))))})()}ngOnInit(){this.mergeLocalstorageVariable(),this.route.queryParams.subscribe(i=>{i.token&&(this.syncData=this.jwtHelper.decodeToken(i.token),this.onGetSyncData())})}onGetSyncData(){if(console.log(this.syncData),"journey"==this.syncData.type){const i=JSON.stringify(JSON.parse(localStorage.getItem("journey")||"[]").sort((c,a)=>c.timestamp>a.timestamp?-1:1));"string"!=typeof this.syncData.data&&(this.syncData.data=JSON.stringify(this.syncData.data?.sort((c,a)=>c.timestamp>a.timestamp?-1:1))),JSON.stringify(JSON.parse(this.syncData.data)?.sort((c,a)=>c.timestamp>a.timestamp?-1:1))==JSON.stringify(JSON.parse(i||"")?.sort((c,a)=>c.timestamp>a.timestamp?-1:1))?(this.syncData.data=JSON.parse(this.syncData.data).sort((c,a)=>c.timestamp>a.timestamp?-1:1),this.isSyncSavedLoccaly=!0):this.syncData.data="string"==typeof this.syncData.data?JSON.parse(this.syncData.data).sort((c,a)=>c.timestamp>a.timestamp?-1:1):this.syncData.data.sort((c,a)=>c.timestamp>a.timestamp?-1:1)}}getRowData(i,c){return"location"==c?this.checkInTypes.find(a=>a.key==i.location)?.label||"Ch\u01b0a x\xe1c \u0111\u1ecbnh":"type"==c?i?.tuThoiType?`C\xfang Th\u1eddi ${T.u.data.find(a=>a.key==i.tuThoiType)?.name.split("|")[0]}`:this.checkInEvents.find(a=>a.key==i.type)?.label||"Ch\u01b0a x\xe1c \u0111\u1ecbnh":""}onSyncJourneyData(){0==JSON.parse(localStorage.getItem("journey")||"[]")?.length?this.storeJourney():this.confirmSyncJourneyDialogRef=this.matDialog.open(this.confirmSyncJourneyDialog)}storeJourney(){let i="";i="string"!=typeof this.syncData.data?JSON.stringify(this.syncData.data):this.syncData.data,(()=>{console.log(this.checkInTypes);let a=JSON.parse(localStorage.getItem("addedVariable")||"null");const _=this.syncData.data?.filter(s=>!this.checkInTypes?.every(r=>r?.key?.includes(s?.location))),h=this.syncData.data?.filter(s=>!this.checkInEvents?.every(r=>r?.key?.includes(s?.type)));a||(a={location:[],type:[]}),_?.length>0&&(a?.location||(a.location=[]),a.location=[...new Set(a.location.concat(_?.filter(s=>!!s?.location&&this.checkInTypes?.every(r=>!r.key?.includes(s?.location)))?.map(s=>s?.location)))]),h?.length>0&&(a?.type||(a.type=[]),a.type=[...new Set(a.type.concat(h?.filter(s=>!!s?.type&&this.checkInEvents?.every(r=>!r.key?.includes(s?.type)))?.map(s=>s?.type)))]),localStorage.setItem("addedVariable",JSON.stringify(a))})(),localStorage.setItem("journey",i),setTimeout(()=>{this.onGetSyncData()},0)}onGoToGenerate(){this.router.navigate(["/qr/tao-ma"],{state:{selectedIndex:2}})}}return(n=o).\u0275fac=function(i){return new(i||n)(t.Y36(p.gz),t.Y36(m.uw),t.Y36(Z.Yg),t.Y36(p.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-sync"]],viewQuery:function(i,c){if(1&i&&t.Gf(x,5),2&i){let a;t.iGM(a=t.CRH())&&(c.confirmSyncJourneyDialog=a.first)}},decls:7,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],["confirmSyncJourneyDialog",""],["mat-flat-button","",3,"color","click",4,"ngIf"],["class","text-center",4,"ngIf"],["mat-table","",3,"dataSource",4,"ngIf"],["mat-flat-button","",3,"color","click"],[1,"text-center"],[3,"ngStyle"],["mat-flat-button","",3,"color","routerLink"],["mat-table","",3,"dataSource"],["matColumnDef","timestamp"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","location"],["matColumnDef","rating"],["matColumnDef","device"],["matColumnDef","comment"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[4,"ngFor","ngForOf"],["matListItemTitle",""],["matListItemLine",""],["mat-flat-button","",1,"w-100",3,"color","click"],["mat-dialog-title",""],["mat-flat-button","","mat-dialog-close","true"],["mat-flat-button","","mat-dialog-close","true",3,"color","click"]],template:function(i,c){1&i&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"\u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u"),t.qZA(),t.YNc(3,V,2,1,"div",1),t.YNc(4,$,5,1,"div",1),t.qZA(),t.YNc(5,z,14,1,"ng-template",null,2,t.W1O)),2&i&&(t.xp6(3),t.Q6J("ngIf",c.syncData),t.xp6(1),t.Q6J("ngIf",!c.syncData))},dependencies:[d.sg,d.O5,d.PC,p.rH,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,y.i$,y.Tg,v.d,y.WW,y.sL,E.lW,S.Hw,m.ZT,m.uh,m.xY,m.H8,d.uU]}),o})()}];let W=(()=>{var n;class o{}return(n=o).\u0275fac=function(i){return new(i||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.Bz.forChild(K),p.Bz]}),o})();var X=u(2596);let tt=(()=>{var n;class o{}return(n=o).\u0275fac=function(i){return new(i||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,W,l.p0,y.ie,v.t,X.AV,E.ot,S.Ps,m.Is]}),o})()}}]);