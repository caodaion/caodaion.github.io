"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[258],{7258:(ee,T,l)=>{l.r(T),l.d(T,{QrGeneratorModule:()=>P});var p=l(6814),Q=l(7742),g=l(4170),h=l(6223),y=l(617),C=l(5940),v=l(2596),Z=l(2787),m=l(7874),k=l(1158);const I=[{key:"journey",label:"S\u1ed5 tay h\xe0nh tr\xecnh",disabled:!1}];var e=l(5879),D=l(5067),x=l(2939),M=l(7022),E=l(2032),f=l(2296),_=l(4104),b=l(8525),A=l(3680);function J(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.copyLink(t.qrData))}),e.TgZ(1,"mat-icon"),e._uU(2,"link"),e.qZA()()}2&n&&e.Q6J("matTooltip","Sao ch\xe9p li\xean k\u1ebft")}function q(n,i){if(1&n&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Oqu(o.error)}}function G(n,i){1&n&&(e.TgZ(0,"div",17),e._UZ(1,"mat-spinner"),e.qZA())}function R(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div"),e._UZ(1,"qrcode",18,19),e.TgZ(3,"div",16)(4,"button",20),e.NdJ("click",function(){e.CHM(o);const t=e.MAs(2),a=e.oxw();return e.KtG(a.saveAsImage(t))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("qrdata",o.qrData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}function N(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.copyLink(t.checkInQRData))}),e.TgZ(1,"mat-icon"),e._uU(2,"link"),e.qZA()()}2&n&&e.Q6J("matTooltip","Sao ch\xe9p li\xean k\u1ebft")}function U(n,i){if(1&n&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&n){const o=i.$implicit;e.Q6J("value",null==o?null:o.key)("disabled",null==o?null:o.disabled),e.xp6(1),e.Oqu(null==o?null:o.label)}}function S(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"mat-form-field",22)(1,"mat-label"),e._uU(2,"\u0110\u1ecba \u0111i\u1ec3m m\u1edbi"),e.qZA(),e.TgZ(3,"input",23),e.NdJ("ngModelChange",function(t){e.CHM(o);const a=e.oxw();return e.KtG(a.addedMoreLocation=t)})("ngModelChange",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.generateCheckInQR())}),e.qZA()()}if(2&n){const o=e.oxw();e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("ngModel",o.addedMoreLocation)}}function w(n,i){if(1&n&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Oqu(o.checkInError)}}function L(n,i){1&n&&(e.TgZ(0,"div",17),e._UZ(1,"mat-spinner"),e.qZA())}function B(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div"),e._UZ(1,"qrcode",18,24),e.TgZ(3,"div",16)(4,"button",20),e.NdJ("click",function(){e.CHM(o);const t=e.MAs(2),a=e.oxw();return e.KtG(a.saveAsImage(t))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("qrdata",o.checkInQRData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}function O(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.copyLink(t.syncQRData))}),e.TgZ(1,"mat-icon"),e._uU(2,"link"),e.qZA()()}2&n&&e.Q6J("matTooltip","Sao ch\xe9p li\xean k\u1ebft")}function H(n,i){if(1&n&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&n){const o=i.$implicit;e.Q6J("value",null==o?null:o.key)("disabled",null==o?null:o.disabled),e.xp6(1),e.Oqu(null==o?null:o.label)}}function Y(n,i){if(1&n&&(e.TgZ(0,"p",16),e._uU(1),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Oqu(o.syncError)}}function F(n,i){1&n&&(e.TgZ(0,"div",17),e._UZ(1,"mat-spinner"),e.qZA())}function K(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div"),e._UZ(1,"qrcode",18,25),e.TgZ(3,"div",16)(4,"button",20),e.NdJ("click",function(){e.CHM(o);const t=e.MAs(2),a=e.oxw();return e.KtG(a.saveAsImage(t))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("qrdata",o.syncQRData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}const $=[{path:"",children:[{path:"",component:(()=>{var n;class i{constructor(r,t,a){this.tinyUrlService=r,this._snackBar=t,this.commonService=a,this.qrData=location.href,this.data=location.href,this.horizontalPosition="center",this.verticalPosition="bottom",this.durationInSeconds=3,this.error="",this.checkInError="",this.checkInQRData="",this.syncError="",this.syncQRData="",this.checkInTypes=k.g,this.checkInType="",this.syncTypes=I,this.loadingData=!1}ngOnInit(){window.history.state.selectedIndex&&(this.selectedIndex=parseInt(window.history.state.selectedIndex)),this.mergeLocalstorageVariable()}mergeLocalstorageVariable(){(()=>{let t=JSON.parse(localStorage.getItem("addedVariable")||"null")?.location;t&&t?.length>0&&(this.checkInTypes=this.checkInTypes.concat(t.map(a=>({key:a,label:a,disabled:!1}))))})()}convertBase64ToBlob(r){const t=r.split(";base64,"),a=t[0].split(":")[1],c=window.atob(t[1]),u=new Uint8Array(c.length);for(let s=0;s<c.length;++s)u[s]=c.charCodeAt(s);return new Blob([u],{type:a})}saveAsImage(r){let t=null;if(t=r.qrcElement.nativeElement.querySelector("canvas").toDataURL("image/png"),t){let a=this.convertBase64ToBlob(t);const c=new Blob([a],{type:"image/png"}),u=window.URL.createObjectURL(c),s=document.createElement("a");s.href=u,s.download=this.commonService.generatedSlug(`caodaion-qr-${0===this.selectedIndex?"0":1===this.selectedIndex?"checkin-"+this.addedMoreLocation||0:2===this.selectedIndex?"sync":""}`),s.click()}}copyLink(r){navigator.clipboard.writeText(r),this._snackBar.open("\u0110\xe3 sao ch\xe9p li\xean k\u1ebft","\u0110\xf3ng",{duration:1e3*this.durationInSeconds,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}onChangeData(){if(this.data?.length<=350)this.qrData=this.data;else{this.qrData="",this.error="";try{this.loadingData=!0,this.tinyUrlService.shortenUrl(this.data).subscribe(r=>{this.qrData=r?.data?.tiny_url,this.loadingData=!1})}catch(r){console.log(r),this.loadingData=!1,this.error="Kh\xf4 th\u1ec3 t\u1ea1o m\xe3 QR v\xec d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n qu\xe1 d\xe0i v\xe0 kh\xf4ng c\xf3 k\u1ebft n\u1ed1i m\u1ea1ng"}}}generaToken(r){const t=X=>{let d=m.enc.Base64.stringify(X);return d=d.replace(/=+$/,""),d=d.replace(/\+/g,"-"),d=d.replace(/\//g,"_"),d},u=t(m.enc.Utf8.parse(JSON.stringify({alg:"HS256",typ:"JWT"}))),z=t(m.enc.Utf8.parse(JSON.stringify(r))),W=m.HmacSHA512("caodaiondata","caodaionkey").toString();return`${u}.${z}.${btoa(W)}`}generateCheckInQR(){let t=`${location?.origin}`;if(t+="addMore"==this.checkInType&&this.addedMoreLocation?`/hanh-trinh?l=${this.generaToken(this.addedMoreLocation)}`:"tuGia"==this.checkInType?`/hanh-trinh?l=${this.checkInType}`:`/hanh-trinh?l=${this.generaToken(this.checkInType)}`,t?.length<=350)this.checkInQRData=t;else{this.checkInQRData="",this.checkInError="";try{this.loadingData=!0,this.tinyUrlService.shortenUrl(t).subscribe(a=>{this.loadingData=!1,this.checkInQRData=a?.data?.tiny_url})}catch(a){this.loadingData=!1,console.log(a),this.checkInError="Kh\xf4 th\u1ec3 t\u1ea1o m\xe3 QR v\xec d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n qu\xe1 d\xe0i v\xe0 kh\xf4ng c\xf3 k\u1ebft n\u1ed1i m\u1ea1ng"}}}generateSyncQR(){let r=null,t=`${location?.origin}/tac-vu/sync`;if(this.syncError="","journey"==this.syncType){const a=localStorage.getItem("journey");JSON.parse(a||"[]")?.length>0?t+=`?token=${this.generaToken({type:"journey",data:a})}`:this.syncError="S\u1ed5 tay h\xe0nh tr\xecnh ch\u01b0a c\xf3 ghi d\u1ea5u n\xe0o c\u1ea3."}else r={t:this.syncType},t+=`?token=${this.generaToken(r)}`;if(console.log(t),t?.length<=350)this.syncQRData=t;else{this.syncQRData="",this.syncError="";try{this.loadingData=!0,this.tinyUrlService.shortenUrl(t).subscribe(a=>{this.syncQRData=a?.data?.tiny_url,this.loadingData=!1})}catch(a){console.log(a),this.loadingData=!1,this.syncError="Kh\xf4 th\u1ec3 t\u1ea1o m\xe3 QR v\xec d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n qu\xe1 d\xe0i v\xe0 kh\xf4ng c\xf3 k\u1ebft n\u1ed1i m\u1ea1ng"}}}selectedTabChange(r){this.selectedIndex=r.index}}return(n=i).\u0275fac=function(r){return new(r||n)(e.Y36(D.u),e.Y36(x.ux),e.Y36(M.v))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-qr-generator"]],decls:59,vars:26,consts:[[1,"wrapper-container","qr-generator-container"],[1,"container-fluid"],[3,"selectedIndex","selectedTabChange"],[3,"label"],[1,"w-100"],["type","text","matInput","","disabled","",3,"ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",3,"matTooltip","click",4,"ngIf"],["type","text","matInput","",3,"ngModel","ngModelChange","change"],["class","text-center",4,"ngIf"],["class","w-100 d-flex justify-content-center",4,"ngIf"],[4,"ngIf"],[3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value"],["class","w-100",3,"appearance",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"matTooltip","click"],[1,"text-center"],[1,"w-100","d-flex","justify-content-center"],[3,"qrdata","width","imageHeight","imageWidth","cssClass","errorCorrectionLevel","colorDark","colorLight","elementType","margin","scale","imageSrc"],["parent",""],["mat-raised-button","","color","primary",3,"click"],[3,"value","disabled"],[1,"w-100",3,"appearance"],["type","text","matInput","",3,"ngModel","ngModelChange"],["checkIn",""],["sync",""]],template:function(r,t){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1"),e._uU(3,"T\u1ea1o m\xe3 QR"),e.qZA()(),e.TgZ(4,"mat-tab-group",2),e.NdJ("selectedTabChange",function(c){return t.selectedTabChange(c)}),e.TgZ(5,"mat-tab",3)(6,"div",1)(7,"h2"),e._uU(8,"T\u1ea1o m\xe3 QR theo n\u1ed9i dung"),e.qZA(),e.TgZ(9,"mat-form-field",4)(10,"mat-label"),e._uU(11,"N\u1ed9i dung m\xe3"),e.qZA(),e.TgZ(12,"input",5),e.NdJ("ngModelChange",function(c){return t.qrData=c}),e.qZA(),e.YNc(13,J,3,1,"button",6),e.qZA(),e.TgZ(14,"mat-form-field",4)(15,"mat-label"),e._uU(16,"N\u1ed9i dung t\u1ea1o m\xe3"),e.qZA(),e.TgZ(17,"input",7),e.NdJ("ngModelChange",function(c){return t.data=c})("change",function(){return t.onChangeData()}),e.qZA()(),e.YNc(18,q,2,1,"p",8),e.YNc(19,G,2,0,"div",9),e.YNc(20,R,8,12,"div",10),e.qZA()(),e.TgZ(21,"mat-tab",3)(22,"div",1)(23,"h2"),e._uU(24,"T\u1ea1o m\xe3 QR check-in"),e.qZA(),e.TgZ(25,"mat-form-field",4)(26,"mat-label"),e._uU(27,"N\u1ed9i dung m\xe3"),e.qZA(),e.TgZ(28,"input",5),e.NdJ("ngModelChange",function(c){return t.checkInQRData=c}),e.qZA(),e.YNc(29,N,3,1,"button",6),e.qZA(),e.TgZ(30,"mat-form-field",4)(31,"mat-label"),e._uU(32,"\u0110\u1ecba \u0111i\u1ec3m check-in"),e.qZA(),e.TgZ(33,"mat-select",11),e.NdJ("ngModelChange",function(c){return t.checkInType=c})("ngModelChange",function(){return t.generateCheckInQR()}),e.YNc(34,U,2,3,"mat-option",12),e.TgZ(35,"mat-option",13),e._uU(36,"\u0110\u1ecba \u0111i\u1ec3m m\u1edbi"),e.qZA()()(),e.YNc(37,S,4,2,"mat-form-field",14),e.YNc(38,w,2,1,"p",8),e.YNc(39,L,2,0,"div",9),e.YNc(40,B,8,12,"div",10),e.qZA()(),e.TgZ(41,"mat-tab",3)(42,"div",1)(43,"h2"),e._uU(44,"T\u1ea1o m\xe3 QR \u0111\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u"),e.qZA(),e.TgZ(45,"div")(46,"mat-form-field",4)(47,"mat-label"),e._uU(48,"N\u1ed9i dung m\xe3"),e.qZA(),e.TgZ(49,"input",5),e.NdJ("ngModelChange",function(c){return t.syncQRData=c}),e.qZA(),e.YNc(50,O,3,1,"button",6),e.qZA(),e.TgZ(51,"mat-form-field",4)(52,"mat-label"),e._uU(53,"Lo\u1ea1i \u0111\u1ed3ng b\u1ed9"),e.qZA(),e.TgZ(54,"mat-select",11),e.NdJ("ngModelChange",function(c){return t.syncType=c})("ngModelChange",function(){return t.generateSyncQR()}),e.YNc(55,H,2,3,"mat-option",12),e.qZA()()(),e.YNc(56,Y,2,1,"p",8),e.YNc(57,F,2,0,"div",9),e.YNc(58,K,8,12,"div",10),e.qZA()()()()),2&r&&(e.xp6(4),e.Q6J("selectedIndex",t.selectedIndex),e.xp6(1),e.Q6J("label","T\u1ea0O M\xc3 QR THEO N\u1ed8I DUNG"),e.xp6(7),e.Q6J("ngModel",t.qrData),e.xp6(1),e.Q6J("ngIf",t.qrData),e.xp6(4),e.Q6J("ngModel",t.data),e.xp6(1),e.Q6J("ngIf",t.error),e.xp6(1),e.Q6J("ngIf",t.loadingData),e.xp6(1),e.Q6J("ngIf",!t.error&&t.qrData),e.xp6(1),e.Q6J("label","T\u1ea0O M\xc3 QR CHECK-IN"),e.xp6(7),e.Q6J("ngModel",t.checkInQRData),e.xp6(1),e.Q6J("ngIf",t.checkInQRData),e.xp6(4),e.Q6J("ngModel",t.checkInType),e.xp6(1),e.Q6J("ngForOf",t.checkInTypes),e.xp6(1),e.Q6J("value","addMore"),e.xp6(2),e.Q6J("ngIf","addMore"==t.checkInType),e.xp6(1),e.Q6J("ngIf",t.checkInError),e.xp6(1),e.Q6J("ngIf",t.loadingData),e.xp6(1),e.Q6J("ngIf",!t.checkInError&&t.checkInQRData),e.xp6(1),e.Q6J("label","T\u1ea0O M\xc3 QR \u0110\u1ed2NG B\u1ed8 D\u1eee LI\u1ec6U C\xc1 NH\xc2N"),e.xp6(8),e.Q6J("ngModel",t.syncQRData),e.xp6(1),e.Q6J("ngIf",t.syncQRData),e.xp6(4),e.Q6J("ngModel",t.syncType),e.xp6(1),e.Q6J("ngForOf",t.syncTypes),e.xp6(1),e.Q6J("ngIf",t.syncError),e.xp6(1),e.Q6J("ngIf",t.loadingData),e.xp6(1),e.Q6J("ngIf",!t.syncError&&t.syncQRData))},dependencies:[p.sg,p.O5,Q.V,g.KE,g.hX,g.R9,h.Fj,h.JJ,h.On,y.Hw,C.Ou,v.gM,E.Nt,f.lW,f.RK,_.uX,_.SP,b.gD,A.ey],styles:[".qr-generator-container .mat-tab-body-content{padding:.5rem}  .qr-generator-container .mat-tab-body-wrapper{flex:1}  .qr-generator-container .mat-mdc-tab-group{flex:1;height:100%;overflow:hidden;background-color:#fff}"]}),i})()}]}];let j=(()=>{var n;class i{}return(n=i).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[Z.Bz.forChild($),Z.Bz]}),i})(),P=(()=>{var n;class i{}return(n=i).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.ez,j,Q.N,g.lN,h.u5,y.Ps,C.Cq,v.AV,E.c,f.ot,_.Nh,b.LD]}),i})()}}]);