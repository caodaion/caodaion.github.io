<mat-drawer-container autosize class="cp-content-creator-mat-drawer">
  <mat-drawer-content id="contentCreatorWrapper">
    <div class="block-audio-player">
      <mat-progress-bar
        mode="indeterminate"
        *ngIf="!audioReadyToPlay && data?.type === 'block' && data?.audio?.src"
      ></mat-progress-bar>
      <div class="flex hide-print">
        <audio
          #audioPlayer
          class="w-100"
          *ngIf="data?.type === 'block' && data?.audio?.src"
          [src]="data?.audio?.src"
        ></audio>
        <mat-form-field *ngIf="isShowFontSizeSelect">
          <mat-label>Cỡ chữ</mat-label>
          <mat-select
            [(ngModel)]="contentFormat.fontSize"
            (ngModelChange)="updateFontSize()"
          >
            <mat-option *ngFor="let item of fontSizeRange" [value]="item"
              >{{ item }}px</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>
    </div>
    <div style="text-align: right; " *ngIf="topGuide"><i><small>{{topGuide}}</small></i></div>
    <div
      class="cp-creator-block-group"
      [ngClass]="{ contentEditable: isShowController }"
    >
      <ng-container *ngFor="let block of data?.content">
        <cp-creator-block
          *ngIf="block?.type == 'block'"
          [data]="block"
          [rootContent]="rootContent"
          [contentEditable]="contentEditable"
          [isShowFontSizeSelect]="isShowFontSizeSelect"
          [contentFormat]="contentFormat"
          [id]="getId(block)"
          (focusedBlock)="focusedBlock = $event"
        ></cp-creator-block>
        <cp-creator-content
          #creatorContent
          *ngIf="block?.type == 'contentBlock'"
          [data]="block"
          [topGuide]="topGuide"
          [rootContent]="rootContent"
          [contentEditable]="contentEditable"
          [isShowFontSizeSelect]="isShowFontSizeSelect"
          [contentFormat]="contentFormat"
          [id]="getId(block)"
          (focusedBlock)="focusedBlock = $event"
          (contentToContent)="contentToContent($event)"
          [ngClass]="{ targetBlock: block.type == 'contentBlock' }"
        ></cp-creator-content>
      </ng-container>
    </div>
  </mat-drawer-content>
  <mat-drawer mode="side" opened [position]="'end'" [opened]="isShowController">
    <cp-content-creator-toolbar
      [focusedBlock]="focusedBlock"
      [contentEditable]="contentEditable"
      [data]="data"
      (save)="saveData()"
      (reset)="reset.emit()"
    ></cp-content-creator-toolbar>
  </mat-drawer>
</mat-drawer-container>
<ng-template #comboLocation>
  <div mat-dialog-title>Cập nhật {{ addedComboLocation.title }}</div>
  <mat-dialog-content>
    <div class="pt-8">
      <mat-checkbox [(ngModel)]="isShowCountry">Hiển thị quốc gia</mat-checkbox>
      <mat-form-field *ngIf="isShowCountry" [appearance]="'outline'">
        <mat-label>Quốc gia</mat-label>
        <input type="text" matInput [(ngModel)]="addedComboLocation.country" />
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Tỉnh/Thành phố</mat-label>
        <mat-select [(ngModel)]="addedComboLocation.province">
          <input type="text" #provinceFilter class="w-full p-2 sticky top-0 bg-white z-10" [placeholder]="'Tìm kiếm hoặc tạo mới'"
            (keydown)="onPress($event)">
          <mat-option
            *ngFor="let item of provinces | divisionFilter: {level: 'province', searchText: provinceFilter['value']}"
            [value]="item?.id">{{ item?.name }}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Quận/Huyện</mat-label>
        <mat-select [(ngModel)]="addedComboLocation.district">
          <input type="text" #districtFilter class="w-full p-2 sticky top-0 bg-white z-10" [placeholder]="'Tìm kiếm hoặc tạo mới'"
            (keydown)="onPress($event)">
          <mat-option
            *ngFor="let item of districts | divisionFilter: {level: 'district', parent: addedComboLocation.province, searchText: districtFilter['value']}"
            [value]="item?.id">{{ item?.name }}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Phường/Xã</mat-label>
        <mat-select [(ngModel)]="addedComboLocation.ward">
          <input type="text" #wardFilter class="w-full p-2 sticky top-0 bg-white z-10" [placeholder]="'Tìm kiếm hoặc tạo mới'"
            (keydown)="onPress($event)">
          <mat-option
            *ngFor="let item of wards | divisionFilter: {level: 'ward', parent: addedComboLocation.district, searchText: wardFilter['value']}"
            [value]="item?.id">{{ item?.name }}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field [appearance]="'outline'">
        <mat-label>Thôn/Lộ</mat-label>
        <input type="text" matInput [(ngModel)]="addedComboLocation.village" />
      </mat-form-field>
      <!-- <mat-form-field [appearance]="'outline'" class="w-full">
        <mat-label>Nhập tay</mat-label>
        <textarea [cols]="100" matInput [(ngModel)]="addedComboLocation.text"></textarea>
      </mat-form-field> -->
    </div>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button
      mat-flat-button
      [color]="'primary'"
      (click)="addComboLocation()"
      [matDialogClose]="true"
    >
      Cập nhật
    </button>
  </mat-dialog-actions>
</ng-template>

<button
  mat-fab
  class="!fixed bottom-[80px] lg:bottom-8 right-8 z-[999999999999]"
  *ngIf="!contentEditable"
  [color]="'primary'"
  (click)="onPrint()"
>
  <mat-icon>print</mat-icon>
</button>
