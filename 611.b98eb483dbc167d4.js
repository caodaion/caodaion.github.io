"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[611],{2611:(X,x,a)=>{a.r(x),a.d(x,{ProfileModule:()=>L});var f=a(6814),h=a(2787),_=a(7874),P=a(6245),e=a(5879),y=a(3096),N=a(7022),D=a(2939),g=a(9347),J=a(5067),T=a(617),E=a(2296),A=a(7742),m=a(4170),p=a(6223),M=a(2032),C=a(7466),v=a(8034),Z=a(8525),U=a(3680);const w=["passwordDialog"];function b(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"div",23),e._UZ(1,"qrcode",24,25),e.TgZ(3,"div",26)(4,"button",27),e.NdJ("click",function(){e.CHM(r);const t=e.MAs(2),i=e.oxw(3);return e.KtG(i.saveAsImage(t))}),e.TgZ(5,"mat-icon"),e._uU(6,"download"),e.qZA(),e._uU(7," T\u1ea3i M\xe3 QR "),e.qZA()()()}if(2&o){const r=e.oxw(3);e.xp6(1),e.Q6J("qrdata",r.qrData)("width",300)("imageHeight",75)("imageWidth",75)("cssClass","text-center")("errorCorrectionLevel","M")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","canvas")("margin",4)("scale",128)("imageSrc","assets/icons/assets/circle-logo.svg")}}function q(o,l){if(1&o&&(e.TgZ(0,"div",19)(1,"div",8)(2,"div",20),e._uU(3," M\xe3 QR \u0111\u0103ng nh\u1eadp/\u0111\u1ed3ng b\u1ed9 t\xe0i kho\u1ea3n "),e.qZA(),e.TgZ(4,"div",21),e._uU(5," Qu\xe9t m\xe3 t\u1ea1i trang \u0111\u0103ng nh\u1eadp \u0111\u1ec3 \u0111\u0103ng nh\u1eadp nhanh b\u1eb1ng m\xe3 QR "),e.qZA(),e.YNc(6,b,8,12,"div",22),e.qZA()()),2&o){const r=e.oxw(2);e.xp6(6),e.Q6J("ngIf",r.qrData)}}function S(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"div")(1,"button",28),e.NdJ("click",function(){e.CHM(r);const t=e.oxw(2);return e.KtG(t.activeAccount())}),e._uU(2," K\xcdCH HO\u1ea0T "),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("color","warn"))}function H(o,l){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"B\u1ea1n c\u1ea7n c\u1eadp nh\u1eadt T\xean \u0111\u0103ng nh\u1eadp m\u1edbi c\xf3 th\u1ec3 k\xedch ho\u1ea1t. N\u1ebfu b\u1ea1n kh\xf4ng bi\u1ebft t\u1ea1o t\xean g\xec? H\xe3y nh\u1eadp th\xf4ng tin c\u1ee7a b\u1ea1n, h\u1ec7 th\u1ed1ng s\u1ebd gi\xfap b\u1ea1n t\u1ea1o t\xean \u0111\u0103ng nh\u1eadp t\u1ef1 \u0111\u1ed9ng."),e.qZA())}function Q(o,l){if(1&o&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&o){const r=l.$implicit;e.Q6J("value",null==r?null:r.key),e.xp6(1),e.Oqu(null==r?null:r.name)}}const k=function(o){return{background:o}};function I(o,l){if(1&o&&(e.TgZ(0,"mat-option",30),e._uU(1),e.qZA()),2&o){const r=l.$implicit;e.Q6J("value",r.key)("ngStyle",e.VKq(3,k,r.color)),e.xp6(1),e.Oqu(r.name)}}function F(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"div",7)(1,"mat-form-field",8)(2,"mat-label"),e._uU(3,"S\u1eafc ph\xe1i"),e.qZA(),e.TgZ(4,"mat-select",11),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw(2);return e.KtG(i.currentUser.color=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw(2);return e.KtG(t.updateUserProfile())}),e.YNc(5,I,2,5,"mat-option",29),e.qZA()()()}if(2&o){const r=e.oxw(2);e.xp6(4),e.Q6J("ngModel",r.currentUser.color),e.xp6(1),e.Q6J("ngForOf",r.colors)}}function G(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"div",7)(1,"mat-form-field",8)(2,"mat-label"),e._uU(3,"Th\xe1nh Danh"),e.qZA(),e.TgZ(4,"input",31),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw(2);return e.KtG(i.currentUser.holyName=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw(2);return e.KtG(t.updateUserProfile())}),e.qZA()()()}if(2&o){const r=e.oxw(2);e.xp6(4),e.Q6J("required",r.isHolyNameRequired)("ngModel",r.currentUser.holyName)}}function K(o,l){if(1&o&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&o){const r=l.$implicit;e.Q6J("value",null==r?null:r.key),e.xp6(1),e.Oqu(null==r?null:r.name)}}function O(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"div",3)(1,"h1"),e._uU(2),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.TgZ(5,"div"),e.YNc(6,q,7,1,"div",4),e.YNc(7,S,3,1,"div",5),e.TgZ(8,"div",6)(9,"div",7)(10,"mat-form-field",8)(11,"mat-label"),e._uU(12,"T\xean \u0111\u0103ng nh\u1eadp"),e.qZA(),e.TgZ(13,"input",9),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.userName=t)}),e.qZA()(),e.YNc(14,H,2,0,"mat-error",5),e.qZA(),e.TgZ(15,"div",7)(16,"mat-form-field",8)(17,"mat-label"),e._uU(18,"H\u1ecd v\xe0 T\xean"),e.qZA(),e.TgZ(19,"input",10),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.name=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.updateUserProfile())}),e.qZA()()(),e.TgZ(20,"div",7)(21,"div",8)(22,"mat-label"),e._uU(23,"Gi\u1edbi t\xednh"),e.qZA(),e.TgZ(24,"div")(25,"mat-radio-group",11),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.sex=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.updateUserProfile())}),e.TgZ(26,"mat-radio-button",12),e._uU(27,"Nam"),e.qZA(),e.TgZ(28,"mat-radio-button",12),e._uU(29,"N\u1eef"),e.qZA()()()()(),e.TgZ(30,"div",7)(31,"mat-form-field",8)(32,"mat-label"),e._uU(33,"Ng\xe0y sinh"),e.qZA(),e.TgZ(34,"input",13),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.birthday=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.updateUserProfile())}),e.qZA(),e._UZ(35,"mat-datepicker-toggle",14)(36,"mat-datepicker",null,15),e.qZA()(),e.TgZ(38,"div",7)(39,"mat-form-field",8)(40,"mat-label"),e._uU(41,"Ch\u1ee9c \u0111\u1ea1o"),e.qZA(),e.TgZ(42,"mat-select",11),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.title=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.updateUserProfile())}),e.YNc(43,Q,2,2,"mat-option",16),e.qZA()()(),e.YNc(44,F,6,2,"div",17),e.YNc(45,G,5,2,"div",17),e.TgZ(46,"div",7)(47,"mat-form-field",8)(48,"mat-label"),e._uU(49,"Th\xe1nh S\u1edf"),e.qZA(),e.TgZ(50,"input",10),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.thanhSo=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.updateUserProfile())}),e.qZA()()(),e.TgZ(51,"div",7)(52,"mat-form-field",8)(53,"mat-label"),e._uU(54,"Nhi\u1ec7m v\u1ee5 h\xe0nh ch\xe1nh"),e.qZA(),e.TgZ(55,"mat-select",18),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.role=t)})("ngModelChange",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.updateUserProfile())}),e.YNc(56,K,2,2,"mat-option",16),e.qZA()()()()()()}if(2&o){const r=e.MAs(37),n=e.oxw();e.xp6(2),e.Oqu((null==n.currentUser?null:n.currentUser.holyName)||(null==n.currentUser?null:n.currentUser.name)),e.xp6(2),e.hij("@",null==n.currentUser?null:n.currentUser.userName,""),e.xp6(2),e.Q6J("ngIf",!n.currentUser.isGuest),e.xp6(1),e.Q6J("ngIf",n.currentUser.isGuest),e.xp6(6),e.Q6J("disabled",!n.currentUser.isGuest)("ngModel",n.currentUser.userName),e.xp6(1),e.Q6J("ngIf",n.userNameRequired),e.xp6(5),e.Q6J("ngModel",n.currentUser.name),e.xp6(6),e.Q6J("ngModel",n.currentUser.sex),e.xp6(1),e.Q6J("value","male"),e.xp6(2),e.Q6J("value","female"),e.xp6(6),e.Q6J("matDatepicker",r)("ngModel",n.currentUser.birthday),e.xp6(1),e.Q6J("for",r),e.xp6(7),e.Q6J("ngModel",n.currentUser.title),e.xp6(1),e.Q6J("ngForOf",n.caodaiTitle),e.xp6(1),e.Q6J("ngIf","male"===n.currentUser.sex&&n.isHolyNameRequired),e.xp6(1),e.Q6J("ngIf",n.isHolyNameRequired),e.xp6(5),e.Q6J("ngModel",n.currentUser.thanhSo),e.xp6(5),e.Q6J("ngModel",n.currentUser.role)("multiple",!0),e.xp6(1),e.Q6J("ngForOf",n.roles)}}function R(o,l){1&o&&(e.TgZ(0,"div",32)(1,"h1"),e._uU(2,"H\xe3y \u0111\u0103ng nh\u1eadp \u0111\u1ec3 truy c\u1eadp th\xf4ng tin c\xe1 nh\xe2n."),e.qZA(),e.TgZ(3,"button",33),e._uU(4," \u0110\u0103ng nh\u1eadp "),e.qZA()()),2&o&&(e.xp6(3),e.Q6J("routerLink","/auth/dang-nhap")("color","primary"))}function B(o,l){if(1&o){const r=e.EpF();e.TgZ(0,"div",34),e._uU(1,"C\u1eadp nh\u1eadt nh\u1eadt m\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(2,"mat-dialog-content")(3,"mat-form-field",35)(4,"mat-label"),e._uU(5,"M\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(6,"input",36),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.currentUser.password=t)}),e.qZA()(),e.TgZ(7,"mat-form-field",35)(8,"mat-label"),e._uU(9,"Nh\u1eadp l\u1ea1i m\u1eadt kh\u1ea9u"),e.qZA(),e.TgZ(10,"input",36),e.NdJ("ngModelChange",function(t){e.CHM(r);const i=e.oxw();return e.KtG(i.confirmPassword=t)}),e.qZA()()(),e.TgZ(11,"mat-dialog-actions")(12,"button",37),e._uU(13,"H\u1ee7y"),e.qZA(),e.TgZ(14,"button",38),e._uU(15," C\u1eadp nh\u1eadt "),e.qZA()()}if(2&o){const r=e.oxw();e.xp6(3),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("ngModel",r.currentUser.password),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("ngModel",r.confirmPassword),e.xp6(2),e.Q6J("matDialogClose",!0),e.xp6(2),e.Q6J("color","primary")("disabled",r.currentUser.password&&r.currentUser.password!==r.confirmPassword)("matDialogClose",!0)}}const Y=[{path:"",children:[{path:"",component:(()=>{var o;class l{constructor(n,t,i,u,c,s){this.authService=n,this.commonService=t,this._snackBar=i,this.matDiaLog=u,this.route=c,this.tinyUrlService=s,this.horizontalPosition="center",this.verticalPosition="bottom",this.durationInSeconds=3,this.currentUser={},this.caodaiTitle=P.h.data,this.roles=[],this.colors=[{key:"thai",name:"Th\xe1i",color:"#fbbc05"},{key:"thuong",name:"Th\u01b0\u1ee3ng",color:"#4285f4"},{key:"ngoc",name:"Ng\u1ecdc",color:"#ea4335"}],this.userNameRequired=!1,this.isHolyNameRequired=!1,this.confirmPassword=""}ngOnInit(){localStorage.getItem("token")?(this.getCurrentUser(),this.getRoles(),this.updateUserProfile()):this.route.params.subscribe(t=>{t?.username&&this.route.queryParams.subscribe(i=>{i.t&&(localStorage.setItem("token",i.t),location.href=location.href.split("?")[0])})})}getRoles(){this.roles=[],this.roles=this.caodaiTitle?.find(n=>"chuc-viec"===n.key)?.subTitle}getCurrentUser(){this.currentUser=this.authService.getCurrentUser();let n=`${location.href}?t=${this.generaToken(this.currentUser)}`;if("string"==typeof this.currentUser?.role&&(this.currentUser.role=JSON.parse(this.currentUser?.role)),1===this.currentUser?.role?.length&&"kids"===this.currentUser?.role[0]&&(n=`${location.origin}@${this.currentUser?.userName}`),n?.length>=350)try{this.tinyUrlService.shortenUrl(n).subscribe(t=>{0===t.code&&(this.qrData=t?.data?.tiny_url)})}catch(t){console.log(t)}else this.qrData=n;this.qrData=n}saveAsImage(n){let t=null;if(t=n.qrcElement.nativeElement.querySelector("canvas").toDataURL("image/png"),t){let i=this.convertBase64ToBlob(t);const u=new Blob([i],{type:"image/png"}),c=window.URL.createObjectURL(u),s=document.createElement("a");s.href=c,s.download=this.commonService.generatedSlug(`caodaion-qr-${this.currentUser.userName}`),s.click()}}convertBase64ToBlob(n){const t=n.split(";base64,"),i=t[0].split(":")[1],u=window.atob(t[1]),c=new Uint8Array(u.length);for(let s=0;s<u.length;++s)c[s]=u.charCodeAt(s);return new Blob([c],{type:i})}generaToken(n){const t=V=>{let d=_.enc.Base64.stringify(V);return d=d.replace(/=+$/,""),d=d.replace(/\+/g,"-"),d=d.replace(/\//g,"_"),d},c=t(_.enc.Utf8.parse(JSON.stringify({alg:"HS256",typ:"JWT"}))),z=t(_.enc.Utf8.parse(JSON.stringify(n))),j=_.HmacSHA512("caodaiondata","caodaionkey").toString();return`${c}.${z}.${btoa(j)}`}updateUserProfile(){this.isHolyNameRequired=this.caodaiTitle.find(t=>t.key===this.currentUser.title)?.isHolyNameRequired||!1;let n=this.caodaiTitle.find(t=>t.key===this.currentUser.title);if(n?.subTitle&&(this.roles=n?.subTitle),this.currentUser.name&&this.isHolyNameRequired&&("male"===this.currentUser.sex&&this.currentUser.color&&(this.currentUser.holyName=`${this.colors.find(t=>t.key===this.currentUser.color)?.name} ${this.currentUser.name?.split(" ")[this.currentUser.name?.split(" ").length-1]} Thanh`),"female"===this.currentUser.sex&&(this.currentUser.holyName=`H\u01b0\u01a1ng ${this.currentUser.name?.split(" ")[this.currentUser.name?.split(" ").length-1]}`)),!this.currentUser.isGuest&&"Invalid Date"===new Date(parseInt(this.currentUser.userName)).toString()){let t={};t=JSON.parse(localStorage.getItem("users")||"{}");const i=this.generaToken(this.currentUser);t[this.currentUser.userName]=i,localStorage.setItem("users",JSON.stringify(t)),localStorage.setItem("token",JSON.stringify(i)),this.getCurrentUser(),this._snackBar.open("\u0110\xe3 c\u1eadp nh\u1eadt th\xf4ng tin","\u0110\xf3ng",{duration:1e3*this.durationInSeconds,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})}if(this.currentUser.isGuest){const t=this.currentUser?.name?.trim()?.split(" ");let i="";t?.length>1&&(i=this.commonService.generatedSlug(t[t.length-1]),t.forEach((u,c)=>{c<t.length-1&&(i+=`${this.commonService.generatedSlug(u)[0]}`)}),this.currentUser?.birthday?.getFullYear()&&(i+=this.currentUser?.birthday?.getFullYear()?.toString()?.split("")?.splice(2,2)?.join("")),this.currentUser.userName=i)}}activeAccount(){this.currentUser.userName&&("Invalid Date"===new Date(parseInt(this.currentUser.userName)).toString()?this.currentUser.password?(delete this.currentUser.isGuest,this.updateUserProfile(),this._snackBar.open(`B\u1ea1n \u0111\xe3 l\xe0m r\u1ea5t t\u1ed1t ${this.currentUser.name}`,"\u0110\xf3ng",{duration:1e3*this.durationInSeconds,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition}),location.reload(),location.href=""):(this.currentUser.password="",this.matDiaLog.open(this.passwordDialog,{disableClose:!0})):this.userNameRequired=!0)}}return(o=l).\u0275fac=function(n){return new(n||o)(e.Y36(y.e),e.Y36(N.v),e.Y36(D.ux),e.Y36(g.uw),e.Y36(h.gz),e.Y36(J.u))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-profile"]],viewQuery:function(n,t){if(1&n&&e.Gf(w,5),2&n){let i;e.iGM(i=e.CRH())&&(t.passwordDialog=i.first)}},decls:4,vars:2,consts:[["class","container-fluid",4,"ngIf"],["class","container-fluid text-center",4,"ngIf"],["passwordDialog",""],[1,"container-fluid"],["class","block lg:flex",4,"ngIf"],[4,"ngIf"],[1,"block","lg:flex","lg:flex-wrap","mx-[-0.5rem]","my-8"],[1,"form-group","w-full","lg:w-1/5"],[1,"w-full"],["type","text","matInput","",3,"disabled","ngModel","ngModelChange"],["type","text","matInput","",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"value"],["matInput","",3,"matDatepicker","ngModel","ngModelChange"],["matIconSuffix","",3,"for"],["picker",""],[3,"value",4,"ngFor","ngForOf"],["class","form-group w-full lg:w-1/5",4,"ngIf"],[3,"ngModel","multiple","ngModelChange"],[1,"block","lg:flex"],[1,"text-2xl","text-center"],[1,"text-lg","text-center"],["class","w-full flex flex-column items-center",4,"ngIf"],[1,"w-full","flex","flex-column","items-center"],[3,"qrdata","width","imageHeight","imageWidth","cssClass","errorCorrectionLevel","colorDark","colorLight","elementType","margin","scale","imageSrc"],["parent",""],[1,"text-center"],["mat-raised-button","","color","primary",3,"click"],["mat-flat-button","",1,"w-full",3,"color","click"],[3,"value","ngStyle",4,"ngFor","ngForOf"],[3,"value","ngStyle"],["type","text","matInput","",3,"required","ngModel","ngModelChange"],[1,"container-fluid","text-center"],["mat-flat-button","",3,"routerLink","color"],["mat-dialog-title",""],[3,"appearance"],["type","password","matInput","",3,"ngModel","ngModelChange"],["mat-flat-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose"]],template:function(n,t){1&n&&(e.YNc(0,O,57,22,"div",0),e.YNc(1,R,5,2,"div",1),e.YNc(2,B,16,8,"ng-template",null,2,e.W1O)),2&n&&(e.Q6J("ngIf",null==t.currentUser?null:t.currentUser.userName),e.xp6(1),e.Q6J("ngIf",!(null!=t.currentUser&&t.currentUser.isGuest||null!=t.currentUser&&t.currentUser.userName)))},dependencies:[f.sg,f.O5,f.PC,h.rH,T.Hw,E.lW,A.V,m.KE,m.hX,m.TO,m.R9,p.Fj,p.JJ,p.Q7,p.On,M.Nt,C.VQ,C.U0,v.Mq,v.hl,v.nW,Z.gD,U.ey,g.ZT,g.uh,g.xY,g.H8],styles:[".form-group[_ngcontent-%COMP%]{padding:0 .5rem}"]}),l})()}]}];let $=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.Bz.forChild(Y),h.Bz]}),l})(),L=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[{provide:U.Ad,useValue:"vi-VN"}],imports:[f.ez,$,T.Ps,E.ot,A.N,m.lN,p.u5,M.c,C.Fk,v.FA,U.XK,Z.LD,g.Is]}),l})()}}]);