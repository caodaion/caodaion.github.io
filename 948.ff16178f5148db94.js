"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[948],{6948:(tt,h,c)=>{c.r(h),c.d(h,{SyncModule:()=>X});var r=c(6895),d=c(4392),S=c(3175),g=c(6051),D=c(3351),t=c(4650),m=c(5938),T=c(2289),s=c(671),p=c(6338),f=c(4850),v=c(9101),E=c(7392);const Z=["confirmSyncJourneyDialog"];function x(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(4);return t.KtG(a.onSyncJourneyData())}),t.TgZ(1,"mat-icon"),t._uU(2,"sync"),t.qZA(),t._uU(3," \u0110\u1ed3ng b\u1ed9 ngay "),t.qZA()}2&n&&t.Q6J("color","primary")}const C=function(n){return{fontSize:n}};function A(n,o){if(1&n&&(t.TgZ(0,"div",7)(1,"span",8),t._uU(2,"\u{1f389}"),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"D\u1eef li\u1ec7u S\u1ed5 tay h\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c \u0111\u1ed3ng b\u1ed9 gi\u1ed1ng nhau"),t.qZA(),t.TgZ(5,"button",9)(6,"mat-icon"),t._uU(7,"trip_origin"),t.qZA(),t._uU(8," Xem S\u1ed5 tay h\xe0nh tr\xecnh "),t.qZA()()),2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngStyle",t.VKq(3,C,e.isShowPhoneLayout?"100px":"200px")),t.xp6(4),t.Q6J("color","primary")("routerLink","/trang-chu/hanh-trinh")}}function b(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Th\u1eddi gian"),t.qZA())}function J(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.timestamp,"dd/MM/YYYY hh:mm:ss")," ")}}function N(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Lo\u1ea1i"),t.qZA())}function U(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(1),t.hij(" ",i.getRowData(e,"type")," ")}}function w(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"\u0110\u1ecba \u0111i\u1ec3m"),t.qZA())}function Y(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(1),t.hij(" ",i.getRowData(e,"location")," ")}}function k(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"\u0110\xe1nh gi\xe1"),t.qZA())}function I(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(1),t.hij(" ",i.ratingPieChartLabels[e.rating-1]||"Ch\u01b0a \u0111\xe1nh gi\xe1"," ")}}function q(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Thi\u1ebft b\u1ecb"),t.qZA())}function L(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.AsE(" ",e.method," tr\xean ",e.device," ")}}function Q(n,o){1&n&&(t.TgZ(0,"th",21),t._uU(1,"Ghi ch\xfa"),t.qZA())}function B(n,o){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",e.comment," ")}}function O(n,o){1&n&&t._UZ(0,"tr",23)}function F(n,o){1&n&&t._UZ(0,"tr",24)}function j(n,o){if(1&n&&(t.TgZ(0,"table",10),t.ynx(1,11),t.YNc(2,b,2,0,"th",12),t.YNc(3,J,3,4,"td",13),t.BQk(),t.ynx(4,14),t.YNc(5,N,2,0,"th",12),t.YNc(6,U,2,1,"td",13),t.BQk(),t.ynx(7,15),t.YNc(8,w,2,0,"th",12),t.YNc(9,Y,2,1,"td",13),t.BQk(),t.ynx(10,16),t.YNc(11,k,2,0,"th",12),t.YNc(12,I,2,1,"td",13),t.BQk(),t.ynx(13,17),t.YNc(14,q,2,0,"th",12),t.YNc(15,L,2,2,"td",13),t.BQk(),t.ynx(16,18),t.YNc(17,Q,2,0,"th",12),t.YNc(18,B,2,1,"td",13),t.BQk(),t.YNc(19,O,1,0,"tr",19),t.YNc(20,F,1,0,"tr",20),t.qZA()),2&n){const e=t.oxw(4);t.Q6J("dataSource",e.syncData.data),t.xp6(19),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function R(n,o){if(1&n&&(t.TgZ(0,"mat-list-item")(1,"span",26),t._uU(2),t.qZA(),t.TgZ(3,"span",27)(4,"strong"),t._uU(5,"\u0110\u1ecba \u0111i\u1ec3m:"),t.qZA(),t._uU(6),t.qZA(),t.TgZ(7,"span",27)(8,"strong"),t._uU(9,"Th\u1eddi gian:"),t.qZA(),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"span",27)(13,"strong"),t._uU(14,"\u0110\xe1nh gi\xe1: "),t.qZA(),t._uU(15),t.qZA(),t.TgZ(16,"span",27)(17,"strong"),t._uU(18,"Ph\u01b0\u01a1ng th\u1ee9c: "),t.qZA(),t._uU(19),t.qZA(),t.TgZ(20,"span",27)(21,"strong"),t._uU(22,"Ghi ch\xfa: "),t.qZA(),t._uU(23),t.qZA(),t._UZ(24,"mat-divider",27),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(5);t.xp6(2),t.hij("",i.getRowData(e,"type")," "),t.xp6(4),t.hij(" ",i.getRowData(e,"location"),""),t.xp6(4),t.hij(" ",t.xi3(11,7,e.timestamp,"dd/MM/YYYY hh:mm:ss"),""),t.xp6(5),t.Oqu(i.ratingPieChartLabels[e.rating-1]),t.xp6(4),t.AsE("",e.method," tr\xean ",e.device,""),t.xp6(4),t.Oqu(e.comment)}}function G(n,o){if(1&n&&(t.TgZ(0,"mat-list"),t.YNc(1,R,25,10,"mat-list-item",25),t.qZA()),2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngForOf",e.syncData.data)}}function H(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,x,4,1,"button",3),t.YNc(2,A,9,5,"div",4),t.YNc(3,j,21,3,"table",5),t.YNc(4,G,2,1,"mat-list",1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!e.isSyncSavedLoccaly),t.xp6(1),t.Q6J("ngIf",e.isSyncSavedLoccaly),t.xp6(1),t.Q6J("ngIf",!e.isShowPhoneLayout),t.xp6(1),t.Q6J("ngIf",e.isShowPhoneLayout)}}function M(n,o){if(1&n&&(t.TgZ(0,"div")(1,"p"),t._uU(2," D\u1eef li\u1ec7u \u0111\u01b0\u1ee3c \u0111\u1ed3ng b\u1ed9 l\xe0 d\u1eef li\u1ec7u: "),t.TgZ(3,"strong"),t._uU(4," S\u1ed5 tay h\xe0nh tr\xecnh"),t.qZA()(),t.YNc(5,H,5,4,"div",1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf",e.syncData.data)}}function P(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,M,6,1,"div",1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","journey"===(null==e.syncData?null:e.syncData.type))}}function V(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onGoToGenerate())}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA(),t._uU(4," T\u1ea1o m\xe3 \u0111\u1ed3ng b\u1ed9 ngay "),t.qZA()()}2&n&&(t.xp6(1),t.Q6J("color","primary"))}function $(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",29),t._uU(1,"X\xe1c nh\u1eadn \u0111\u1ed3ng b\u1ed9 S\u1ed5 tay h\xe0nh tr\xecnh"),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"strong"),t._uU(4,"L\u01afU \xdd:"),t.qZA(),t.TgZ(5,"p"),t._uU(6," N\u1ea5u ch\u1ea5p nh\u1eadn, S\u1ed5 tay h\xe0nh tr\xecnh hi\u1ec7n t\u1ea1i c\u1ee7a b\u1ea1n s\u1ebd \u0111\u01b0\u1ee3c l\xe0m m\u1edbi theo d\u1eef li\u1ec7u \u0111\u1ed3ng b\u1ed9. "),t.qZA(),t.TgZ(7,"p"),t._uU(8,"B\u1ea1n c\xf3 mu\u1ed1n ti\u1ebfp t\u1ee5c?"),t.qZA()(),t.TgZ(9,"mat-dialog-actions")(10,"button",30),t._uU(11,"H\u1ee7y"),t.qZA(),t.TgZ(12,"button",31),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.storeJourney())}),t._uU(13," Ch\u1ea5p nh\u1eadn "),t.qZA()()}2&n&&(t.xp6(12),t.Q6J("color","primary"))}const z=[{path:"",component:(()=>{class n{constructor(e,i,a,l){this.route=e,this.matDialog=i,this.breakpointObserver=a,this.router=l,this.jwtHelper=new S.N0,this.ratingPieChartLabels=["Ho\xe0n to\xe0n kh\xf4ng","Kh\xf4ng h\xe0i l\xf2ng","B\xecnh th\u01b0\u1eddng","H\xe0i l\xf2ng","R\u1ea5t h\xe0i l\xf2ng","Ch\u01b0a \u0111\xe1nh gi\xe1"],this.isShowPhoneLayout=!0,this.displayedColumns=["timestamp","type","location","rating","device","comment"],this.checkInTypes=g.g,this.checkInEvents=g.j,this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(y=>{this.isShowPhoneLayout=!!y.matches})}mergeLocalstorageVariable(){(()=>{let a=JSON.parse(localStorage.getItem("addedVariable")||"null")?.location;a&&a?.length>0&&(this.checkInTypes=this.checkInTypes.concat(a.map(l=>({key:l,label:l,disabled:!1}))))})(),(()=>{let a=JSON.parse(localStorage.getItem("addedVariable")||"null")?.type;a&&a?.length>0&&(this.checkInEvents=this.checkInEvents.concat(a.map(l=>({key:l,label:l,disabled:!1}))))})()}ngOnInit(){this.mergeLocalstorageVariable(),this.route.queryParams.subscribe(e=>{e.token&&(this.syncData=this.jwtHelper.decodeToken(e.token),this.onGetSyncData())})}onGetSyncData(){if(console.log(this.syncData),"journey"==this.syncData.type){const e=JSON.stringify(JSON.parse(localStorage.getItem("journey")||"[]").sort((i,a)=>i.timestamp>a.timestamp?-1:1));"string"!=typeof this.syncData.data&&(this.syncData.data=JSON.stringify(this.syncData.data?.sort((i,a)=>i.timestamp>a.timestamp?-1:1))),JSON.stringify(JSON.parse(this.syncData.data)?.sort((i,a)=>i.timestamp>a.timestamp?-1:1))==JSON.stringify(JSON.parse(e||"")?.sort((i,a)=>i.timestamp>a.timestamp?-1:1))?(this.syncData.data=JSON.parse(this.syncData.data).sort((i,a)=>i.timestamp>a.timestamp?-1:1),this.isSyncSavedLoccaly=!0):this.syncData.data="string"==typeof this.syncData.data?JSON.parse(this.syncData.data).sort((i,a)=>i.timestamp>a.timestamp?-1:1):this.syncData.data.sort((i,a)=>i.timestamp>a.timestamp?-1:1)}}getRowData(e,i){return"location"==i?this.checkInTypes.find(a=>a.key==e.location)?.label||"Ch\u01b0a x\xe1c \u0111\u1ecbnh":"type"==i?e?.tuThoiType?`C\xfang Th\u1eddi ${D.u.data.find(a=>a.key==e.tuThoiType)?.name.split("|")[0]}`:this.checkInEvents.find(a=>a.key==e.type)?.label||"Ch\u01b0a x\xe1c \u0111\u1ecbnh":""}onSyncJourneyData(){0==JSON.parse(localStorage.getItem("journey")||"[]")?.length?this.storeJourney():this.confirmSyncJourneyDialogRef=this.matDialog.open(this.confirmSyncJourneyDialog)}storeJourney(){let e="";e="string"!=typeof this.syncData.data?JSON.stringify(this.syncData.data):this.syncData.data,(()=>{console.log(this.checkInTypes);let a=JSON.parse(localStorage.getItem("addedVariable")||"null");const l=this.syncData.data?.filter(u=>!this.checkInTypes?.every(_=>_?.key?.includes(u?.location))),y=this.syncData.data?.filter(u=>!this.checkInEvents?.every(_=>_?.key?.includes(u?.type)));a||(a={location:[],type:[]}),l?.length>0&&(a?.location||(a.location=[]),a.location=[...new Set(a.location.concat(l?.filter(u=>!!u?.location&&this.checkInTypes?.every(_=>!_.key?.includes(u?.location)))?.map(u=>u?.location)))]),y?.length>0&&(a?.type||(a.type=[]),a.type=[...new Set(a.type.concat(y?.filter(u=>!!u?.type&&this.checkInEvents?.every(_=>!_.key?.includes(u?.type)))?.map(u=>u?.type)))]),localStorage.setItem("addedVariable",JSON.stringify(a))})(),localStorage.setItem("journey",e),setTimeout(()=>{this.onGetSyncData()},0)}onGoToGenerate(){this.router.navigate(["/qr/tao-ma"],{state:{selectedIndex:2}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.gz),t.Y36(m.uw),t.Y36(T.Yg),t.Y36(d.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-sync"]],viewQuery:function(e,i){if(1&e&&t.Gf(Z,5),2&e){let a;t.iGM(a=t.CRH())&&(i.confirmSyncJourneyDialog=a.first)}},decls:7,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],["confirmSyncJourneyDialog",""],["mat-flat-button","",3,"color","click",4,"ngIf"],["class","text-center",4,"ngIf"],["mat-table","",3,"dataSource",4,"ngIf"],["mat-flat-button","",3,"color","click"],[1,"text-center"],[3,"ngStyle"],["mat-flat-button","",3,"color","routerLink"],["mat-table","",3,"dataSource"],["matColumnDef","timestamp"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","location"],["matColumnDef","rating"],["matColumnDef","device"],["matColumnDef","comment"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[4,"ngFor","ngForOf"],["matListItemTitle",""],["matListItemLine",""],["mat-flat-button","",1,"w-100",3,"color","click"],["mat-dialog-title",""],["mat-flat-button","","mat-dialog-close","true"],["mat-flat-button","","mat-dialog-close","true",3,"color","click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"\u0110\u1ed3ng b\u1ed9 d\u1eef li\u1ec7u"),t.qZA(),t.YNc(3,P,2,1,"div",1),t.YNc(4,V,5,1,"div",1),t.qZA(),t.YNc(5,$,14,1,"ng-template",null,2,t.W1O)),2&e&&(t.xp6(3),t.Q6J("ngIf",i.syncData),t.xp6(1),t.Q6J("ngIf",!i.syncData))},dependencies:[r.sg,r.O5,r.PC,d.rH,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,p.i$,p.Tg,f.d,p.WW,p.sL,v.lW,E.Hw,m.ZT,m.uh,m.xY,m.H8,r.uU]}),n})()}];let K=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.Bz.forChild(z),d.Bz]}),n})();var W=c(266);let X=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[r.ez,K,s.p0,p.ie,f.t,W.AV,v.ot,E.Ps,m.Is]}),n})()}}]);