"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[33],{33:(nt,J,r)=>{r.r(J),r.d(J,{CalendarModule:()=>tt});var m=r(6895),T=r(4392),F=r(2516),e=r(4650),U=r(7154),q=r(5930),P=r(665),g=r(5938),R=r(2289),Q=r(1481),O=r(3683),D=r(9101),b=r(7392),A=r(4850),S=r(4385),x=r(3238),k=r(3546),C=r(6338),I=r(266),f=r(4006);function K(n,l){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",null==t?null:t.key),e.xp6(1),e.Oqu(null==t?null:t.name)}}function z(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"mat-select",11),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.monthSelectValue=o)})("selectionChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onChangeSelectedCalendar(o.calendarMode,o.monthSelectValue))}),e.YNc(2,K,2,2,"mat-option",12),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.monthSelectValue),e.xp6(1),e.Q6J("ngForOf",t.commonDateTimeValue.month)}}function G(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onChangeSelectedCalendar("before"))}),e.TgZ(1,"mat-icon"),e._uU(2,"navigate_before"),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("matTooltip","day"===t.calendarMode?"ng\xe0y tr\u01b0\u1edbc":"th\xe1ng tr\u01b0\u1edbc")}}function j(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onChangeSelectedCalendar("next"))}),e.TgZ(1,"mat-icon"),e._uU(2,"navigate_next"),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("matTooltip","day"===t.calendarMode?"ng\xe0y sau":"th\xe1ng sau")}}function V(n,l){if(1&n&&(e.TgZ(0,"span",15),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.AsE(" ","day"===t.calendarMode||"month"===t.calendarMode?"th\xe1ng "+((null==t.selectedDate.solar?null:t.selectedDate.solar.getMonth())+1):""," ",t.selectedDate.solar.getFullYear(),"")}}function X(n,l){if(1&n&&(e.TgZ(0,"span",28),e._uU(1,"NH"),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("matTooltip","Nhu\u1eadn th\xe1ng "+(null==t||null==t.lunar||null==t.lunar.convertSolar2Lunar?null:t.lunar.convertSolar2Lunar.lunarMonth))}}function W(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"mat-list-item",29),e.NdJ("click",function(){const i=e.CHM(t).$implicit,u=e.oxw().$implicit,s=e.oxw(2),h=e.MAs(14);return e.KtG(s.openEventSummaryDialog(u,i,h))}),e._uU(1),e.qZA()}if(2&n){const t=l.$implicit;e.Q6J("ngClass","yearly-monthly-daily"===(null==t||null==t.event?null:t.event.date)?"yearly-monthly-daily":"yearly-monthly-daily"!==(null==t||null==t.event?null:t.event.date)&&null!=t&&null!=t.event&&null!=t.event.date&&t.event.date.includes("yearly-monthly-")?"yearly-monthly-special":"yearly-monthly-daily"===(null==t||null==t.event?null:t.event.date)||null!=t&&null!=t.event&&null!=t.event.date&&t.event.date.includes("yearly-monthly-")||null==t||null==t.event||null==t.event.date||!t.event.date.includes("yearly-")?"":"yearly-special-special"),e.xp6(1),e.hij(" ",(null==t||null==t.event?null:t.event.name)||(null==t||null==t.event?null:t.event.eventName)," ")}}const ee=function(n,l){return{height:n,maxHeight:l}};function te(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"mat-card",21)(1,"button",22),e.NdJ("click",function(){const i=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.onChangeCalendarMode("day",i))}),e.TgZ(2,"div",23),e._uU(3),e.qZA(),e.TgZ(4,"div",24),e.YNc(5,X,2,1,"span",25),e._uU(6),e.qZA()(),e.TgZ(7,"div",26)(8,"mat-list"),e.YNc(9,W,2,2,"mat-list-item",27),e.qZA()()()}if(2&n){const t=l.$implicit,a=e.oxw(2);e.Q6J("ngStyle",e.WLB(7,ee,a.selectedMonth.length%6==0?"calc(100%/6)":"calc(100%/5)",a.selectedMonth.length%6==0?"calc(100%/6)":"calc(100%/5)")),e.xp6(1),e.Q6J("ngClass",a.getCurrentDate(t)?"current-date":""),e.xp6(2),e.Oqu(null==t||null==t.solar?null:t.solar.getDate()),e.xp6(2),e.Q6J("ngIf",!(null==t||null==t.lunar||null==t.lunar.convertSolar2Lunar||!t.lunar.convertSolar2Lunar.lunarLeap)),e.xp6(1),e.AsE(" ",null==t||null==t.lunar||null==t.lunar.convertSolar2Lunar?null:t.lunar.convertSolar2Lunar.lunarDay,"/",null==t||null==t.lunar||null==t.lunar.convertSolar2Lunar?null:t.lunar.convertSolar2Lunar.lunarMonth," "),e.xp6(3),e.Q6J("ngForOf",t.event)}}function ne(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",16),e.NdJ("touchstart",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.swipe(o,"start"))})("touchend",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.swipe(o,"end"))}),e.TgZ(1,"div",17)(2,"div",18),e._uU(3,"T2"),e.qZA(),e.TgZ(4,"div",18),e._uU(5,"T3"),e.qZA(),e.TgZ(6,"div",18),e._uU(7,"T4"),e.qZA(),e.TgZ(8,"div",18),e._uU(9,"T5"),e.qZA(),e.TgZ(10,"div",18),e._uU(11,"T6"),e.qZA(),e.TgZ(12,"div",18),e._uU(13,"T7"),e.qZA(),e.TgZ(14,"div",18),e._uU(15,"CN"),e.qZA()(),e.TgZ(16,"div",19),e.NdJ("mousewheel",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.onMouseWheel(o))}),e.YNc(17,te,10,10,"mat-card",20),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(17),e.Q6J("ngForOf",t.selectedMonth)}}function ae(n,l){if(1&n&&(e.TgZ(0,"div",46),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.hour<10?"0"+t.hour:t.hour,":",t.munite<10?"0"+t.munite:t.munite," ")}}function le(n,l){1&n&&e._UZ(0,"mat-divider",47)}function oe(n,l){if(1&n&&(e.TgZ(0,"div",43),e.ALo(1,"number"),e.ALo(2,"number"),e.ALo(3,"number"),e.ALo(4,"number"),e.YNc(5,ae,2,2,"div",44),e.YNc(6,le,1,0,"mat-divider",45),e.qZA()),2&n){const t=l.$implicit,a=e.oxw(2);e.Q6J("id","h"+e.xi3(1,4,t.hour,"2.0")+"m"+e.xi3(2,7,t.munite,"2.0"))("matTooltip","desktop"===a.viewPortMode?e.xi3(3,10,t.hour,"2.0")+":"+e.xi3(4,13,t.munite,"2.0"):""),e.xp6(5),e.Q6J("ngIf",0===t.munite||23!==t.hour&&0===t.munite),e.xp6(1),e.Q6J("ngIf",0===t.munite||23!==t.hour&&0===t.munite)}}const ie=function(n,l){return{height:n,top:l}};function ue(n,l){if(1&n&&e._UZ(0,"div",48),2&n){const t=l.$implicit;e.Q6J("ngStyle",e.WLB(1,ie,(null==t?null:t.height)+"px",(null==t?null:t.position)+"px"))}}function re(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",51),e.NdJ("click",function(){const i=e.CHM(t).$implicit,u=e.oxw(3),s=e.MAs(14);return e.KtG(u.openEventSummaryDialog(u.selectedDate,i,s))}),e._uU(1),e.qZA()}if(2&n){const t=l.$implicit;e.Q6J("ngClass","yearly-monthly-daily"===(null==t||null==t.event?null:t.event.date)?"yearly-monthly-daily":"yearly-monthly-daily"!==(null==t||null==t.event?null:t.event.date)&&null!=t&&null!=t.event&&null!=t.event.date&&t.event.date.includes("yearly-monthly-")?"yearly-monthly-special":"yearly-monthly-daily"===(null==t||null==t.event?null:t.event.date)||null!=t&&null!=t.event&&null!=t.event.date&&t.event.date.includes("yearly-monthly-")||null==t||null==t.event||null==t.event.date||!t.event.date.includes("yearly-")?"":"yearly-special-special"),e.xp6(1),e.hij(" ",(null==t||null==t.event?null:t.event.name)||(null==t||null==t.event?null:t.event.eventName)," ")}}const $=function(n){return{top:n}};function se(n,l){if(1&n&&(e.TgZ(0,"div",49),e.YNc(1,re,2,2,"div",50),e.qZA()),2&n){const t=l.$implicit,a=e.oxw(2);e.Q6J("ngStyle",e.VKq(2,$,a.getPosition(null==t||null==t.timeZone?null:t.timeZone.start)+"px")),e.xp6(1),e.Q6J("ngForOf",t.event)}}function de(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",30),e.NdJ("touchstart",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.swipe(o,"start"))})("touchend",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.swipe(o,"end"))}),e.TgZ(1,"div",31)(2,"div",32)(3,"div",33)(4,"div",34),e._uU(5),e.qZA(),e.TgZ(6,"div",35),e._uU(7),e.qZA()()(),e._UZ(8,"mat-divider"),e.qZA(),e.TgZ(9,"div",36),e.YNc(10,oe,7,16,"div",37),e.TgZ(11,"div",38),e.ALo(12,"async"),e.ALo(13,"async"),e.TgZ(14,"div",39),e._uU(15),e.ALo(16,"date"),e.ALo(17,"async"),e.qZA(),e._UZ(18,"div",40),e.qZA(),e.YNc(19,ue,1,4,"div",41),e.YNc(20,se,2,4,"div",42),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(5),e.hij(" ",t.selectedDate.solar.getDate()," "),e.xp6(2),e.AsE(" ",t.selectedDate.lunar.convertSolar2Lunar.lunarDay,"/",t.selectedDate.lunar.convertSolar2Lunar.lunarMonth," "),e.xp6(3),e.Q6J("ngForOf",t.dateRange),e.xp6(1),e.Q6J("ngStyle",e.VKq(17,$,t.getPosition(e.lcZ(12,8,t.time.time))?t.getPosition(e.lcZ(13,10,t.time.time))+"px":"")),e.xp6(4),e.Oqu(e.xi3(16,12,e.lcZ(17,15,t.time.time),"HH:mm:ss")),e.xp6(4),e.Q6J("ngForOf",t.tuThoiZone),e.xp6(1),e.Q6J("ngForOf",t.dateEvents)}}function ce(n,l){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.Oqu(null==t?null:t.name)}}function he(n,l){if(1&n&&(e.TgZ(0,"div",54)(1,"mat-icon"),e._uU(2,"schedule"),e.qZA(),e.YNc(3,ce,2,1,"span",58),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.getTimes(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.time))}}function me(n,l){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.Oqu(null==t?null:t.name)}}function pe(n,l){if(1&n&&(e.TgZ(0,"div",54)(1,"mat-icon"),e._uU(2,"location_pin"),e.qZA(),e.YNc(3,me,2,1,"span",58),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.getLocationTypes(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.locationType))}}function ge(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",52)(1,"h2",53),e._uU(2),e.qZA(),e.TgZ(3,"mat-dialog-content")(4,"div",54)(5,"mat-icon"),e._uU(6,"event"),e.qZA(),e._uU(7),e.qZA(),e.YNc(8,he,4,1,"div",55),e.YNc(9,pe,4,1,"div",55),e.qZA(),e.TgZ(10,"mat-dialog-actions")(11,"button",56),e._uU(12,"\u0110\xf3ng"),e.qZA(),e.TgZ(13,"button",57),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onGetKinhFromSummaryEvent())}),e._uU(14," Xem kinh "),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Oqu(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.name),e.xp6(5),e.hij(" ","yearly-monthly-daily"===(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.date)?"M\u1ed7i ng\xe0y":"yearly-monthly-daily"!==(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.date)&&null!=t.shownDate&&null!=t.shownDate.event&&null!=t.shownDate.event.event&&null!=t.shownDate.event.event.date&&t.shownDate.event.event.date.includes("yearly-monthly-")?"Ng\xe0y "+(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.date.split("-")[2])+" m\u1ed7i th\xe1ng":"yearly-monthly-daily"===(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.date)||null!=t.shownDate&&null!=t.shownDate.event&&null!=t.shownDate.event.event&&null!=t.shownDate.event.event.date&&t.shownDate.event.event.date.includes("yearly-monthly-")||null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date||!t.shownDate.event.event.date.includes("yearly-")?"yearly-monthly-daily"===(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.date)||null!=t.shownDate&&null!=t.shownDate.event&&null!=t.shownDate.event.event&&null!=t.shownDate.event.event.date&&t.shownDate.event.event.date.includes("yearly-monthly-")||null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date||!t.shownDate.event.event.date.includes("yearly-")?null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event?null:t.shownDate.event.event.date:"Ng\xe0y "+(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date?null:t.shownDate.event.event.date.split("-")[2])+" th\xe1ng "+(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date?null:t.shownDate.event.event.date.split("-")[1])+" n\u0103m"+(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date?null:t.shownDate.event.event.date.split("-")[0]):"Ng\xe0y "+(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date?null:t.shownDate.event.event.date.split("-")[2])+" th\xe1ng "+(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.date?null:t.shownDate.event.event.date.split("-")[1])+" m\u1ed7i n\u0103m"," "),e.xp6(1),e.Q6J("ngIf",(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.time?null:t.shownDate.event.event.time.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.shownDate||null==t.shownDate.event||null==t.shownDate.event.event||null==t.shownDate.event.event.locationType?null:t.shownDate.event.event.locationType.length)>0),e.xp6(4),e.Q6J("color","primary")("mat-dialog-close",!0)}}let ve=(()=>{class n{constructor(t,a,o,i,u,s,h,p,d,c){this.calendarService=t,this.commonService=a,this.eventService=o,this.matDialog=i,this.router=u,this.route=s,this.breakpointObserver=h,this.titleService=p,this.changeDetector=d,this.datePipe=c,this.selectedDate=new _e,this.selectedMonth=[],this.currentDate={solar:new Date},this.dateRange=[],this.eventList=this.eventService.eventList,this.calendarMode="month",this.viewPortMode="desktop",this.commonDateTimeValue=this.commonService.commonDates,this.monthSelectValue=this.selectedDate.solar?.getMonth(),this.time=this.commonService.time,this.tuThoiZone=[],this.dateEvents=[]}ngOnInit(){this.titleService.setTitle(`L\u1ecbch | ${F.s.page.name}`),this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(t=>{this.viewPortMode=t.matches?"mobile":"desktop"}),this.route.queryParams.subscribe(t=>{this.calendarMode=t.m?t.m:"month",t.s?(this.selectedDate.solar=new Date(t.s),new Date(t.s)||(this.selectedDate.solar=new Date),this.selectedDate.lunar=this.calendarService.getConvertedFullDate(this.selectedDate.solar)):(this.selectedDate.solar=new Date,this.selectedDate.lunar=this.calendarService.getConvertedFullDate(this.selectedDate.solar)),this.calendarService.calendarViewMode=this.calendarMode,this.onChangeCalendarMode(this.calendarMode,this.selectedDate),this.getCalendarEvent(),(new Date).getHours()>22&&this.currentDate?.solar.setDate(this.currentDate?.solar.getDate()+1),this.monthSelectValue=this.selectedDate.solar?.getMonth()+1<10?"0"+(this.selectedDate.solar?.getMonth()+1):(this.selectedDate.solar?.getMonth()+1).toString()})}ngAfterViewInit(){this.getTuThoiTimes(),this.changeDetector.detectChanges()}getTuThoiTimes(){if("day"===this.calendarMode){this.tuThoiZone=[];const t=new Date((new Date).setHours(23,0,0)),a=new Date((new Date).setHours(0,59,59)),o=new Date((new Date).setHours(5,0,0)),i=new Date((new Date).setHours(6,59,59)),u=new Date((new Date).setHours(11,0,0)),s=new Date((new Date).setHours(12,59,59)),h=new Date((new Date).setHours(17,0,0)),p=new Date((new Date).setHours(18,59,59));this.tuThoiZone=[{startTime:t,position:this.getPosition(t),height:this.getPosition(a)-this.getPosition(t)},{startTime:o,position:this.getPosition(o),height:this.getPosition(i)-this.getPosition(o)},{startTime:u,position:this.getPosition(u),height:this.getPosition(s)-this.getPosition(u)},{startTime:h,position:this.getPosition(h),height:this.getPosition(p)-this.getPosition(h)}]}}onChangeSelectedCalendar(t,a){"month"===this.calendarMode&&("next"===t&&(this.selectedDate.solar=new Date(this.selectedDate.solar.setMonth(this.selectedDate.solar.getMonth()+1)),this.monthSelectValue=this.selectedDate.solar?.getMonth()+1<10?"0"+(this.selectedDate.solar?.getMonth()+1):(this.selectedDate.solar?.getMonth()+1).toString()),"before"===t&&(this.selectedDate.solar=new Date(this.selectedDate.solar.setMonth(this.selectedDate.solar.getMonth()-1)),this.monthSelectValue=this.selectedDate.solar?.getMonth()+1<10?"0"+(this.selectedDate.solar?.getMonth()+1):(this.selectedDate.solar?.getMonth()+1).toString()),parseInt(a)&&(this.selectedDate.solar=new Date(this.selectedDate.solar.setMonth(parseInt(a)-1)))),"day"===this.calendarMode&&(parseInt(a)&&(this.selectedDate.solar=new Date(this.selectedDate.solar.setMonth(parseInt(a)-1))),"next"===t&&(this.selectedDate.solar=new Date(this.selectedDate.solar.setDate(this.selectedDate.solar.getDate()+1))),"before"===t&&(this.selectedDate.solar=new Date(this.selectedDate.solar.setDate(this.selectedDate.solar.getDate()-1)))),"current"===t&&(this.selectedDate.solar=new Date),this.selectedMonth=this.calendarService.getSelectedMonthCalendar(this.selectedDate.solar.getMonth()+1,this.selectedDate.solar.getFullYear()),this.router.navigate([],{relativeTo:this.route,queryParams:{s:this.selectedDate.solar.toDateString()},queryParamsHandling:"merge"}),this.getCalendarEvent()}getCalendarEvent(){let t=[],a=[],o=[];this.eventList.forEach(u=>{u.event.forEach(s=>{"yearly-monthly-daily"===s.date&&s.key.includes("cung-thoi")&&t.push({mainEventKey:u.key,event:s}),"yearly-monthly-daily"!==s.date&&s.date?.includes("yearly-monthly-")&&a.push({mainEventKey:u.key,event:s}),"yearly-monthly-daily"!==s.date&&!s.date?.includes("yearly-monthly-")&&s.date?.includes("yearly-")&&o.push({mainEventKey:u.key,event:s})})});let i=new Date;if((new Date).getHours()>22&&(i=new Date((new Date).setDate((new Date).getDate()+1))),"month"===this.calendarMode&&this.selectedMonth.forEach(u=>{u.solar.getDate()===i.getDate()&&u.solar.getMonth()===i.getMonth()&&u.solar.getFullYear()===i.getFullYear()&&(u.event=t);let s=a.filter(c=>parseInt(c.event.date.split("-")[2])===u.lunar.convertSolar2Lunar.lunarDay&&"lunar"===c.event.dateType);s?.length>0&&(u.event=s);let h=a.filter(c=>parseInt(c.event.date.split("-")[2])===u.solar.getDate()&&"solar"===c.event.dateType);h?.length>0&&(u.event=h);let p=o.filter(c=>parseInt(c.event.date.split("-")[1])===u.lunar.convertSolar2Lunar.lunarMonth&&parseInt(c.event.date.split("-")[2])===u.lunar.convertSolar2Lunar.lunarDay&&"lunar"===c.event.dateType);p?.length>0&&(u.event=p);let d=o.filter(c=>parseInt(c.event.date.split("-")[1])===u.solar.getUTCMonth()+1&&parseInt(c.event.date.split("-")[2])===u.solar.getDate()&&"solar"===c.event.dateType);d?.length>0&&(u.event=d)}),"day"===this.calendarMode){this.dateEvents=[],this.selectedDate.event=[],this.selectedDate.solar.getDate()===i.getDate()&&this.selectedDate.solar.getMonth()===i.getMonth()&&this.selectedDate.solar.getFullYear()===i.getFullYear()&&(this.selectedDate.event=t);let u=a.filter(d=>parseInt(d.event.date.split("-")[2])===this.selectedDate.lunar.convertSolar2Lunar.lunarDay&&"lunar"===d.event.dateType);u?.length>0&&(this.selectedDate.event=u);let s=a.filter(d=>parseInt(d.event.date.split("-")[2])===this.selectedDate.solar.getDate()&&"solar"===d.event.dateType);s?.length>0&&(this.selectedDate.event=s);let h=o.filter(d=>parseInt(d.event.date.split("-")[1])===this.selectedDate.lunar.convertSolar2Lunar.lunarMonth&&parseInt(d.event.date.split("-")[2])===this.selectedDate.lunar.convertSolar2Lunar.lunarDay&&"lunar"===d.event.dateType);h?.length>0&&(this.selectedDate.event=h);let p=o.filter(d=>parseInt(d.event.date.split("-")[1])===this.selectedDate.solar.getUTCMonth()+1&&parseInt(d.event.date.split("-")[2])===this.selectedDate.solar.getDate()&&"solar"===d.event.dateType);p?.length>0&&(this.selectedDate.event=p),this.selectedDate.event?.forEach(d=>{let c=new Date;c.setHours(parseInt(d.event.time[0].split("-")[1].substring(0,2))),c.setMinutes(0);let M={timeZone:{key:d.event.time[0],start:c,end:d.event.time[0].split("-")[1].substring(2,2)},event:[d]},E=this.dateEvents.find(_=>_.timeZone.key===d.event.time[0]);E?E.event.push(d):this.dateEvents.push(M)})}this.mergeLocalStorageEvents(),console.log(this.dateEvents)}mergeLocalStorageEvents(){JSON.parse(localStorage.getItem("tuanCuu")||"[]")?.forEach(a=>{"month"===this.calendarMode&&this.selectedMonth.forEach(o=>{const i=a?.event.find(u=>new Date(u?.solar).getDate()==new Date(o?.solar).getDate()&&new Date(u?.solar).getMonth()==new Date(o?.solar).getMonth()&&new Date(u?.solar).getFullYear()==new Date(o?.solar).getFullYear());i&&(i.eventName=`C\u1ea7u si\xeau ${i.eventName} cho ${a?.details?.name}`,(!o.event||0==o.event?.length)&&(o.event=[]),o.event.push({event:i}))})})}openEventSummaryDialog(t,a,o){a?.event?.name||(a.event.name=a?.event?.eventName),a?.event?.date||(a.event.date=`${a?.event?.day} ng\xe0y ${a?.event?.lunar?.lunarDay} th\xe1ng ${a?.event?.lunar?.lunarMonth} n\u0103m ${a?.event?.lunar?.lunarYearName} (${this.datePipe.transform(a?.event?.solar,"dd/MM/YYYY")})`),this.shownDate={date:t,event:a},this.eventSummaryDialogRef=this.matDialog.open(o)}getTimes(t){return t?.map(a=>this.commonService.commonTimes.find(o=>o.key===a))}getLocationTypes(t){return t?.includes("all")&&(t=["all"]),t?.map(a=>this.commonService.commonLocationTypes.find(o=>o.key===a))}onGetKinhFromSummaryEvent(){this.router.navigate(["/trang-chu/kinh"],{queryParams:{me:this.shownDate.event.mainEventKey,e:this.shownDate.event.event.key}})}getCurrentDate(t){return t?.solar?.getDate()===this.currentDate?.solar?.getDate()&&t?.solar?.getMonth()===this.currentDate?.solar?.getMonth()&&t?.solar?.getFullYear()===this.currentDate?.solar?.getFullYear()}onChangeCalendarMode(t,a){if(this.calendarMode=t,"month"===this.calendarMode&&(this.selectedMonth=this.calendarService.getSelectedMonthCalendar(this.selectedDate.solar.getMonth()+1,this.selectedDate.solar.getFullYear()),this.calendarService.calendarViewMode=t),"day"===this.calendarMode){this.selectedDate=a,console.log(this.selectedDate);let o=new Date(this.selectedDate.solar);o.setDate(o.getDate()-1),o.setHours(23,0,0,0);let i=new Date(this.selectedDate.solar);i.setHours(22,59,59,999),this.dateRange=[];for(let u=o;u<=i;u.setMinutes(u.getMinutes()+1)){const s={year:u.getFullYear(),month:u.getMonth()+1,date:u.getDate(),hour:u.getHours(),munite:u.getMinutes()};this.dateRange.push(s)}this.calendarService.calendarViewMode=t,console.log(this.dateRange),setTimeout(()=>{this.getTuThoiTimes()},0)}this.router.navigate([],{relativeTo:this.route,queryParams:{m:t,s:this.selectedDate.solar.toDateString()},queryParamsHandling:"merge"})}swipe(t,a){const o=[t.changedTouches[0].clientX,t.changedTouches[0].clientY],i=(new Date).getTime();if("start"===a)this.swipeCoord=o,this.swipeTime=i;else if("end"===a){let s,u=[];this.swipeCoord&&(u=[o[0]-this.swipeCoord[0],o[1]-this.swipeCoord[1]]),this.swipeTime&&(s=i-this.swipeTime),s<1e3&&Math.abs(u[0])>30&&Math.abs(u[0])>Math.abs(3*u[1])&&this.onChangeSelectedCalendar(u[0]<0?"next":"before")}}getPosition(t){if(t){const a=`h${t?.getHours()<10?"0"+t?.getHours():t?.getHours()}m${t?.getMinutes()<10?"0"+t?.getMinutes():t?.getMinutes()}`,i=document.getElementById("dateRange")?.getBoundingClientRect();return document.getElementById(a)?.getBoundingClientRect().top-i?.top}return 0}onMouseWheel(t){"MAT-LIST-ITEM"!==t?.srcElement?.nodeName&&"MAT-LIST"!==t?.srcElement?.nodeName&&"SPAN"!==t?.srcElement?.nodeName&&(t.wheelDelta>0&&"month"===this.calendarMode&&this.onChangeSelectedCalendar("before"),t.wheelDelta<0&&"month"===this.calendarMode&&this.onChangeSelectedCalendar("next"))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(U.o),e.Y36(q.v),e.Y36(P.P),e.Y36(g.uw),e.Y36(T.F0),e.Y36(T.gz),e.Y36(R.Yg),e.Y36(Q.Dx),e.Y36(e.sBO),e.Y36(m.uU))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-lunar-calendar"]],decls:15,vars:8,consts:[[1,"wrapper-container","lunar-calendar-container"],[1,"lunar-calendar-toolbar","justify-content-between"],[1,"d-flex","align-items-center","w-100"],[1,"d-flex","align-items-center","justify-content-between",3,"ngClass"],[4,"ngIf"],["mat-stroked-button","",3,"matTooltip","click"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["class","selected-date",4,"ngIf"],["class","flex-1 h-100 wrapper-container selected-month-calendar",3,"touchstart","touchend",4,"ngIf"],["class","flex-1 h-100 wrapper-container selected-date-calendar",3,"touchstart","touchend",4,"ngIf"],["eventSummayDialog",""],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-icon-button","",3,"matTooltip","click"],[1,"selected-date"],[1,"flex-1","h-100","wrapper-container","selected-month-calendar",3,"touchstart","touchend"],[1,"days"],[1,"day","text-center"],[1,"flex-1","dates","h-100",3,"mousewheel"],["class","date wrapper-container align-items-center",3,"ngStyle",4,"ngFor","ngForOf"],[1,"date","wrapper-container","align-items-center",3,"ngStyle"],["mat-flat-button","",3,"ngClass","click"],[1,"solar-date"],[1,"lunar-date"],[3,"matTooltip",4,"ngIf"],[1,"flex-1","date-event","w-100"],["class","date-event-item","matRipple","",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"matTooltip"],["matRipple","",1,"date-event-item",3,"ngClass","click"],[1,"flex-1","h-100","wrapper-container","selected-date-calendar",3,"touchstart","touchend"],[1,"current-selected-date"],[1,"date-wraper"],[1,"date","text-center"],[1,"date-solar"],[1,"date-lunar"],["id","dateRange",1,"date-hours"],["class","munite d-flex",3,"id","matTooltip",4,"ngFor","ngForOf"],["id","now",1,"now-time",3,"ngStyle"],[1,"time-now"],[1,"clock"],["class","tu-thoi-zone",3,"ngStyle",4,"ngFor","ngForOf"],["class","selected-date-events",3,"ngStyle",4,"ngFor","ngForOf"],[1,"munite","d-flex",3,"id","matTooltip"],["class","start-time-hour",4,"ngIf"],["class","w-100",4,"ngIf"],[1,"start-time-hour"],[1,"w-100"],[1,"tu-thoi-zone",3,"ngStyle"],[1,"selected-date-events",3,"ngStyle"],["class","selected-date-event",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"selected-date-event",3,"ngClass","click"],[1,"event-summary-dialog"],["mat-dialog-title",""],[1,"d-flex","details-item"],["class","d-flex details-item",4,"ngIf"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"color","mat-dialog-close","click"],[4,"ngFor","ngForOf"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"div",3),e.YNc(4,z,3,2,"div",4),e.TgZ(5,"button",5),e.NdJ("click",function(){return a.onChangeSelectedCalendar("current")}),e._uU(6," H\xf4m nay "),e.qZA()(),e.YNc(7,G,3,1,"button",6),e.YNc(8,j,3,1,"button",6),e.YNc(9,V,2,2,"span",7),e.qZA()(),e._UZ(10,"mat-divider"),e.YNc(11,ne,18,1,"div",8),e.YNc(12,de,21,19,"div",9),e.qZA(),e.YNc(13,ge,15,6,"ng-template",null,10,e.W1O)),2&t&&(e.xp6(3),e.Q6J("ngClass","mobile"===a.viewPortMode?"w-100":""),e.xp6(1),e.Q6J("ngIf","mobile"===a.viewPortMode),e.xp6(1),e.Q6J("matTooltip",a.currentDate.solar.getDate()+" th\xe1ng "+a.currentDate.solar.getMonth()+" n\u0103m "+a.currentDate.solar.getFullYear()),e.xp6(2),e.Q6J("ngIf","desktop"===a.viewPortMode),e.xp6(1),e.Q6J("ngIf","desktop"===a.viewPortMode),e.xp6(1),e.Q6J("ngIf","desktop"===a.viewPortMode),e.xp6(2),e.Q6J("ngIf","month"===a.calendarMode),e.xp6(1),e.Q6J("ngIf","day"===a.calendarMode))},dependencies:[m.mk,m.sg,m.O5,m.PC,O.Ye,D.lW,D.RK,b.Hw,A.d,S.gD,x.ey,k.a8,C.i$,C.Tg,x.wG,I.gM,g.ZT,g.uh,g.xY,g.H8,f.JJ,f.On,m.Ov,m.JJ,m.uU],styles:[".lunar-calendar-container .date-event-item{background-color:#fbbc05;height:auto!important;margin-bottom:.25rem;border-radius:3px;padding:.25rem}  .lunar-calendar-container .date-event-item *{font:400 12px/14px Roboto,sans-serif;overflow:visible;white-space:normal}  .lunar-calendar-container .lunar-calendar-toolbar{background-color:#fff}  .lunar-calendar-container .yearly-monthly-daily{background-color:#dadce0}  .lunar-calendar-container .yearly-monthly-special{background-color:#4086f4;color:#fff}  .lunar-calendar-container .yearly-monthly-special *{color:#fff}  .lunar-calendar-container .yearly-special-special{background-color:#eb4132;color:#fff}  .lunar-calendar-container .yearly-special-special *{color:#fff}  .event-summary-dialog .details-item{margin-bottom:.5rem}  .event-summary-dialog .details-item mat-icon{margin-right:1rem}",".lunar-calendar-container .selected-date-calendar{background-color:#fff;overflow:auto}  .lunar-calendar-container .selected-date-calendar .current-selected-date{position:sticky;top:0;z-index:2;background-color:#fff}  .lunar-calendar-container .selected-date-calendar .current-selected-date .date-wrapper{width:-moz-fit-content;width:fit-content}  .lunar-calendar-container .selected-date-calendar .current-selected-date .date{margin:.5rem;background-color:#6750a4;color:#fff;padding:.25rem;font-size:16px;width:62px;height:45px;border-radius:12px}  .lunar-calendar-container .selected-date-calendar .current-selected-date .date-lunar{font-size:12px}",".lunar-calendar-container .selected-date-calendar .date-hours{position:relative;padding-top:.5rem;padding-left:3rem;z-index:1}  .lunar-calendar-container .selected-date-calendar .date-hours .munite{min-height:1px;height:1px;position:relative}  .lunar-calendar-container .selected-date-calendar .date-hours .munite .start-time{margin-left:1rem;margin-right:0;flex:0 50px;margin-top:-9px}  .lunar-calendar-container .selected-date-calendar .date-hours .munite .hour-details{height:-moz-fit-content;height:fit-content}  .lunar-calendar-container .selected-date-calendar .date-hours .munite .start-time-hour{position:absolute;font-size:12px;top:0;transform:translate(-2.5rem,-50%);background-color:#fff;border-radius:3px;padding:2px 5px}  .lunar-calendar-container .selected-date-calendar .date-hours .now-time{position:absolute;left:0;width:100%;height:2px;transform-origin:left center;background-color:#eb4132}  .lunar-calendar-container .selected-date-calendar .date-hours .now-time .clock{position:absolute;top:0;left:0;transform:translateY(-50%);height:10px;width:10px;border-radius:10px;background-color:#eb4132}  .lunar-calendar-container .selected-date-calendar .date-hours .now-time .time-now{position:absolute;bottom:100%;left:10px;font-size:12px}  .lunar-calendar-container .selected-date-calendar .date-hours .tu-thoi-zone{position:absolute;left:0;width:100%;background-color:#dadce0;z-index:-1}  .lunar-calendar-container .selected-date-calendar .date-hours .selected-date-events{position:absolute;left:5rem;width:-moz-fit-content;width:fit-content}  .lunar-calendar-container .selected-date-calendar .date-hours .selected-date-events .selected-date-event{padding:3px;border-radius:3px;margin:0 .5rem .5rem;display:inline-block}",".lunar-calendar-container .selected-month-calendar{background-color:#fff;overflow:hidden}  .lunar-calendar-container .selected-month-calendar .days{display:flex}  .lunar-calendar-container .selected-month-calendar .days .day{width:14.2857142857%;border-right:#dadce0 1px solid;border-bottom:#dadce0 1px solid;padding:.25rem}  .lunar-calendar-container .selected-month-calendar mat-card{padding:0;border-radius:0}",".lunar-calendar-container .selected-month-calendar .dates{display:flex;height:100%;flex-wrap:wrap}  .lunar-calendar-container .selected-month-calendar .dates .date{width:14.2857142857%;border-right:#dadce0 1px solid;border-bottom:#dadce0 1px solid;overflow:hidden}  .lunar-calendar-container .selected-month-calendar .dates .date button{padding:3px;line-height:1;min-width:0;width:62px;height:36px;border-radius:6px}@media only screen and (max-width: 600px){  .lunar-calendar-container .selected-month-calendar .dates .date button{width:32px;height:32px}}  .lunar-calendar-container .selected-month-calendar .dates .date .solar-date{font-size:14px}@media only screen and (max-width: 600px){  .lunar-calendar-container .selected-month-calendar .dates .date .solar-date{font-size:12px}}  .lunar-calendar-container .selected-month-calendar .dates .date .lunar-date{font-size:11px}@media only screen and (max-width: 600px){  .lunar-calendar-container .selected-month-calendar .dates .date .lunar-date{font-size:10px}}  .lunar-calendar-container .selected-month-calendar .dates .date .current-date{background-color:#6750a4;color:#fff}  .lunar-calendar-container .selected-month-calendar .dates .date .date-event{height:100%;overflow:auto}  .lunar-calendar-container .selected-month-calendar .dates .date .date-event .mat-mdc-list-base .mat-mdc-list-item,   .lunar-calendar-container .selected-month-calendar .dates .date .date-event .mat-mdc-list-base .mat-list-option{height:auto;padding:3px;border-radius:3px;margin-bottom:3px;font-size:12px}@media only screen and (max-width: 600px){  .lunar-calendar-container .selected-month-calendar .dates .date .date-event .mat-mdc-list-base .mat-mdc-list-item,   .lunar-calendar-container .selected-month-calendar .dates .date .date-event .mat-mdc-list-base .mat-list-option{font-size:10px}}"]}),n})();class _e{}var w=r(7206),fe=r(3175),N=r(9549),L=r(3848),v=r(671),H=r(4144),y=r(7084),Y=r(1948),Z=r(8255),Te=r(5667);const De=["expiriedEventDialog"];function Ce(n,l){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",null==t?null:t.solar),e.xp6(1),e.Oqu(null==t?null:t.solar)}}function ye(n,l){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function xe(n,l){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function we(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.saveTuanCuu())}),e._uU(1," L\u01b0u "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.calculatedTuanCuu.details.name)("color","primary")}}function Ze(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Tu\u1ea7n"),e.qZA())}function Me(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.Oqu(t.eventName)}}function Ee(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Th\u1ee9"),e.qZA())}function be(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.Oqu(t.day)}}function Ae(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Ng\xe0y \xe2m l\u1ecbch"),e.qZA())}function Se(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.ALo(2,"number"),e.ALo(3,"number"),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.HOy(" ",e.xi3(2,4,t.lunar.lunarDay,"2.0-0"),"-",e.xi3(3,7,t.lunar.lunarMonth,"2.0-0")," ",t.lunar.lunarLeap?"nhu\u1eadn":""," ",t.lunar.lunarYearName," ")}}function Ne(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Ng\xe0y d\u01b0\u01a1ng l\u1ecbch"),e.qZA())}function Le(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.solar,"dd-MM-yyyy")," ")}}function Ye(n,l){1&n&&e._UZ(0,"tr",32)}function Je(n,l){1&n&&e._UZ(0,"tr",33)}function Fe(n,l){if(1&n&&(e.TgZ(0,"div")(1,"table",21),e.ynx(2,22),e.YNc(3,Ze,2,0,"th",23),e.YNc(4,Me,2,1,"td",24),e.BQk(),e.ynx(5,25),e.YNc(6,Ee,2,0,"th",23),e.YNc(7,be,2,1,"td",24),e.BQk(),e.ynx(8,26),e.YNc(9,Ae,2,0,"th",23),e.YNc(10,Se,4,10,"td",24),e.BQk(),e.ynx(11,27),e.YNc(12,Ne,2,0,"th",23),e.YNc(13,Le,3,4,"td",24),e.BQk(),e.YNc(14,Ye,1,0,"tr",28),e.YNc(15,Je,1,0,"tr",29),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.tuanCuuEvents),e.xp6(13),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}function Ue(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Tu\u1ea7n"),e.qZA())}function qe(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.hij(" ",t.eventName," ")}}function Qe(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Th\u1ee9"),e.qZA())}function Oe(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.Oqu(t.day)}}function ke(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Ng\xe0y \xe2m l\u1ecbch"),e.qZA())}function Ie(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.ALo(2,"number"),e.ALo(3,"number"),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.HOy(" ",e.xi3(2,4,t.lunar.lunarDay,"2.0-0"),"-",e.xi3(3,7,t.lunar.lunarMonth,"2.0-0")," ",t.lunar.lunarLeap?"nhu\u1eadn":""," ",t.lunar.lunarYearName," ")}}function $e(n,l){1&n&&(e.TgZ(0,"th",30),e._uU(1,"Ng\xe0y d\u01b0\u01a1ng l\u1ecbch"),e.qZA())}function He(n,l){if(1&n&&(e.TgZ(0,"td",31),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.solar,"dd-MM-yyyy")," ")}}function Be(n,l){1&n&&e._UZ(0,"tr",32)}function Pe(n,l){1&n&&e._UZ(0,"tr",33)}function Re(n,l){if(1&n&&(e.TgZ(0,"div")(1,"table",21),e.ynx(2,22),e.YNc(3,Ue,2,0,"th",23),e.YNc(4,qe,2,1,"td",24),e.BQk(),e.ynx(5,25),e.YNc(6,Qe,2,0,"th",23),e.YNc(7,Oe,2,1,"td",24),e.BQk(),e.ynx(8,26),e.YNc(9,ke,2,0,"th",23),e.YNc(10,Ie,4,10,"td",24),e.BQk(),e.ynx(11,27),e.YNc(12,$e,2,0,"th",23),e.YNc(13,He,3,4,"td",24),e.BQk(),e.YNc(14,Be,1,0,"tr",28),e.YNc(15,Pe,1,0,"tr",29),e.qZA()()),2&n){const t=e.oxw().$implicit,a=e.oxw();e.xp6(1),e.Q6J("dataSource",null==t?null:t.event),e.xp6(13),e.Q6J("matHeaderRowDef",a.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns)}}function Ke(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"mat-tab",34)(1,"div",35)(2,"div",36)(3,"h3"),e._uU(4),e.qZA(),e.TgZ(5,"button",37)(6,"mat-icon"),e._uU(7,"more_vert"),e.qZA()(),e.TgZ(8,"mat-menu",null,38)(10,"button-share",39)(11,"button",40)(12,"mat-icon"),e._uU(13,"share"),e.qZA(),e._uU(14,"Chia s\u1ebb"),e.qZA()(),e.TgZ(15,"button",41),e.NdJ("click",function(){const i=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.deleteTuanCuu(i))}),e.TgZ(16,"mat-icon"),e._uU(17,"delete"),e.qZA(),e._uU(18,"X\xf3a "),e.qZA()()(),e.TgZ(19,"p"),e._uU(20),e.qZA(),e.YNc(21,Re,16,3,"div",17),e.qZA()()}if(2&n){const t=l.$implicit,a=e.MAs(9);e.Q6J("label",null==t?null:t.name),e.xp6(4),e.hij("L\u1ecbch c\xfang c\u1eedu cho ",null==t?null:t.name,""),e.xp6(1),e.Q6J("matMenuTriggerFor",a),e.xp6(5),e.Q6J("title",null==t?null:t.title)("url",null==t?null:t.location),e.xp6(10),e.lnq(" T\u1eeb tr\u1ea7n: ng\xe0y ",null==t||null==t.date?null:t.date.lunarDay," th\xe1ng ",null==t||null==t.date?null:t.date.lunarMonth," n\u0103m ",null==t||null==t.date?null:t.date.lunarYearName," "),e.xp6(1),e.Q6J("ngIf",(null==t||null==t.event?null:t.event.length)>0)}}function ze(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"mat-list-item")(1,"div",47)(2,"div",36)(3,"div"),e._uU(4),e._UZ(5,"br"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"button",48),e.NdJ("click",function(){const i=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.deleteTuanCuu(i))}),e._uU(9," X\xf3a "),e.qZA()(),e._UZ(10,"mat-divider"),e.qZA()()}if(2&n){const t=l.$implicit;e.xp6(4),e.AsE(" L\u1ecbch c\xfang c\u1eedu cho ",null==t||null==t.details?null:t.details.name," ",null==t||null==t.details?null:t.details.age," tu\u1ed5i "),e.xp6(2),e.hij(" \u0110\xe3 h\u1ebft h\u1ea1n l\xfac ",e.xi3(7,5,null==t||null==t.event[(null==t||null==t.event?null:t.event.length)-1]?null:t.event[(null==t||null==t.event?null:t.event.length)-1].solar,"dd/MM/YYYY")," "),e.xp6(2),e.Q6J("mat-dialog-close",!0)("color","primary")}}function Ge(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",42),e._uU(1,"S\u1ef1 ki\u1ec7n \u0111\xe3 h\u1ebft h\u1ea1n"),e.qZA(),e.TgZ(2,"mat-dialog-content",43)(3,"mat-list"),e.YNc(4,ze,11,8,"mat-list-item",44),e.qZA()(),e.TgZ(5,"mat-dialog-actions")(6,"button",45),e._uU(7,"\u0110\xf3ng"),e.qZA(),e.TgZ(8,"button",46),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteAllExpiriedEvent())}),e._uU(9," X\xf3a t\u1ea5t c\u1ea3 "),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.expiriedEvent),e.xp6(4),e.Q6J("color","primary")("mat-dialog-close",!0)}}let B=(()=>{class n{constructor(t,a,o,i,u,s,h,p){this.calendarService=t,this.datePipe=a,this.commonService=o,this.route=i,this.titleService=u,this.cd=s,this.router=h,this.dialog=p,this.selectedDate={year:0,month:0,date:0},this.yearOptions=[],this.monthOptions=[],this.dayOptions=[],this.tuanCuuEvents=[],this.tuanCuuList=[],this.displayedColumns=["eventName","day","lunar","solar"],this.calculatedTuanCuu={key:"",event:[],date:Object,details:{name:"",age:null,sex:null}},this.selectedIndex=0,this.expiriedEvent=[]}ngOnInit(){this.getYearOptions();const t=new Date;this.selectedDate.date=parseInt(this.datePipe.transform(t,"dd")||"0"),this.selectedDate.month=parseInt(this.datePipe.transform(t,"MM")||"0"),this.selectedDate.year=parseInt(this.datePipe.transform(t,"YYYY")||"0"),this.route.queryParams.subscribe(a=>{if(a.y&&(this.selectedDate.year=parseInt(a.y)),a.m&&(this.selectedDate.month=parseInt(a.m)),a.d&&(this.selectedDate.date=parseInt(a.d)),a.y&&a.m&&a.d&&(this.calculateTuanCuu(),a.details)){const i=(new fe.N0).decodeToken(a.details)?.split("+");this.selectedDate={date:parseInt(a.d),month:parseInt(a.m),year:parseInt(a.y)},this.calculatedTuanCuu.details={name:i[0],age:i[1],sex:i[2]},this.saveSharedEvent()}}),this.titleService.setTitle(`T\xednh Tu\u1ea7n C\u1eedu | ${F.s.page.name}`)}ngAfterViewInit(){this.getLocalStorageTuanCuu()}saveSharedEvent(){this.saveTuanCuu(),this.selectedIndex=this.tuanCuuList.length,location.search&&this.router.navigate([],{})}getLocalStorageTuanCuu(){this.tuanCuuList=JSON.parse(localStorage.getItem("tuanCuu")||"[]"),this.expiriedEvent=this.tuanCuuList.filter(t=>new Date(t?.event[t?.event?.length-1].solar)<new Date),this.expiriedEvent?.length>0&&(this.dialogRef=this.dialog.open(this.expiriedEventDialog)),this.tuanCuuList?.forEach(t=>{t.name=`${t?.details?.name} ${t?.details?.age?t?.details?.age+" tu\u1ed5i":""}`,this.generateShareInformation(t),t.title=`Chia s\u1ebb l\u1ecbch c\xfang c\u1eedu c\u1ee7a ${t.name}`;const a=this.calendarService.getConvertedFullDate(new Date(`${t?.date?.year}-${t?.date?.month<10?"0"+t?.date?.month:t?.date?.month}-${t?.date?.date<10?"0"+t?.date?.date:t?.date?.date}`)).convertSolar2Lunar;t.date.lunarMonth=`${a.lunarMonth} ${a.lunarLeap?"nhu\u1eadn":""}`,t.date.lunarDay=a.lunarDay,t.date.lunarYearName=a.lunarYearName})}getYearOptions(){for(let t=(new Date).getFullYear();t>(new Date).getFullYear()-5;t--){const a=this.calendarService.getConvertedFullDate(new Date((new Date).setFullYear(t)));this.yearOptions.push({solar:a.convertSolar2Lunar.lunarYear})}this.monthOptions=Array.from({length:12},(t,a)=>a+1),this.dayOptions=Array.from({length:30},(t,a)=>a+1)}calculateTuanCuu(){this.calendarService.getTuanCuuEvents(new Date(`${this.selectedDate.year}-${this.selectedDate.month<10?"0"+this.selectedDate.month:this.selectedDate.month}-${this.selectedDate.date<10?"0"+this.selectedDate.date:this.selectedDate.date}`)).subscribe(t=>{t&&(t.forEach(a=>{a.day=this.commonService.convertDay(this.datePipe?.transform(a.solar,"EEE"))}),this.tuanCuuEvents=t)})}saveTuanCuu(){this.calculatedTuanCuu.key=this.commonService.generatedSlug(`tuancuu-${this.selectedDate.year}${this.selectedDate.month}${this.selectedDate.date}-${this.calculatedTuanCuu.details.name}`),this.calculatedTuanCuu.event=this.tuanCuuEvents,this.calculatedTuanCuu.date=this.selectedDate,this.tuanCuuList?.find(t=>t?.key==this.calculatedTuanCuu.key)||(this.tuanCuuList.push(this.calculatedTuanCuu),this.storeTuanCuu())}storeTuanCuu(){localStorage.setItem("tuanCuu",JSON.stringify(this.tuanCuuList)),this.selectedDate={year:(new Date).getFullYear(),month:(new Date).getMonth(),date:(new Date).getDate()},this.calculatedTuanCuu={key:"",event:[],date:Object,details:{name:"",age:null,sex:null}},this.getLocalStorageTuanCuu()}deleteTuanCuu(t){if(1==this.tuanCuuList?.length)this.tuanCuuList=[];else{let a=this.tuanCuuList.indexOf(this.tuanCuuList.find(o=>o.key==t.key));this.tuanCuuList.splice(a,1)}this.storeTuanCuu()}generateShareInformation(t){const a=E=>{let _=w.enc.Base64.stringify(E);return _=_.replace(/=+$/,""),_=_.replace(/\+/g,"-"),_=_.replace(/\//g,"_"),_},u=a(w.enc.Utf8.parse(JSON.stringify({alg:"HS256",typ:"JWT"}))),p=a(w.enc.Utf8.parse(JSON.stringify(`${t?.details?.name}+${t?.details?.age}+${t?.details?.sex}`))),d=w.HmacSHA512("caodaiondata","caodaionkey").toString(),M=`${u}.${p}.${btoa(d)}`;t.token=M,t.location=`${location.href}?y=${t?.date?.year}&m=${t?.date?.month}&d=${t?.date?.date}&details=${M}`,this.cd.detectChanges()}deleteAllExpiriedEvent(){this.expiriedEvent.forEach(t=>{this.deleteTuanCuu(t),this.dialogRef.close()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(U.o),e.Y36(m.uU),e.Y36(q.v),e.Y36(T.gz),e.Y36(Q.Dx),e.Y36(e.sBO),e.Y36(T.F0),e.Y36(g.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tinh-tuan-cuu"]],viewQuery:function(t,a){if(1&t&&e.Gf(De,5),2&t){let o;e.iGM(o=e.CRH())&&(a.expiriedEventDialog=o.first)}},decls:62,vars:17,consts:[[1,"wrapper-container","tuan-cuu-container"],[1,"text-center","tuan-cuu-title"],[3,"selectedIndex"],["label","T\xednh Tu\u1ea7n C\u1eedu m\u1edbi"],[1,"form-group"],[1,"d-flex","flex-wrap"],["appearance","outline",1,"w-100"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multi","",1,"event-accordion"],[3,"expanded"],["type","text","matInput","","required","",3,"ngModel","ngModelChange"],["type","number","matInput","",3,"ngModel","ngModelChange"],[3,"value"],[1,"form-group","d-flex","justify-content-end","button-calc"],["mat-raised-button","",3,"disabled","color","click",4,"ngIf"],["mat-raised-button","",3,"color","click"],[4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],["expiriedEventDialog",""],["mat-raised-button","",3,"disabled","color","click"],["mat-table","",3,"dataSource"],["matColumnDef","eventName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","day"],["matColumnDef","lunar"],["matColumnDef","solar"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[3,"label"],[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],[3,"title","url"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-dialog-title",""],[1,"tuan-cuu"],[4,"ngFor","ngForOf"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"color","mat-dialog-close","click"],[1,"tuan-cuu-e"],["mat-flat-button","",3,"mat-dialog-close","color","click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"T\xednh tu\u1ea7n c\u1eedu"),e.qZA(),e.TgZ(3,"mat-tab-group",2)(4,"mat-tab",3)(5,"div",4)(6,"h3"),e._uU(7,"H\xe3y ch\u1ecdn ng\xe0y t\u1eeb tr\u1ea7n"),e.qZA()(),e.TgZ(8,"div",5)(9,"div",4)(10,"mat-form-field",6)(11,"mat-label"),e._uU(12,"Ch\u1ecdn N\u0103m"),e.qZA(),e.TgZ(13,"mat-select",7),e.NdJ("ngModelChange",function(i){return a.selectedDate.year=i}),e.YNc(14,Ce,2,2,"mat-option",8),e.qZA()()(),e.TgZ(15,"div",4)(16,"mat-form-field",6)(17,"mat-label"),e._uU(18,"Ch\u1ecdn Th\xe1ng"),e.qZA(),e.TgZ(19,"mat-select",7),e.NdJ("ngModelChange",function(i){return a.selectedDate.month=i}),e.YNc(20,ye,2,2,"mat-option",8),e.qZA()()(),e.TgZ(21,"div",4)(22,"mat-form-field",6)(23,"mat-label"),e._uU(24,"Ch\u1ecdn Ng\xe0y"),e.qZA(),e.TgZ(25,"mat-select",7),e.NdJ("ngModelChange",function(i){return a.selectedDate.date=i}),e.YNc(26,xe,2,2,"mat-option",8),e.qZA()()()(),e.TgZ(27,"mat-accordion",9)(28,"mat-expansion-panel",10)(29,"mat-expansion-panel-header")(30,"mat-panel-title"),e._uU(31," Th\xf4ng tin b\u1ed5 sung"),e.qZA()(),e.TgZ(32,"h3"),e._uU(33,"Th\xf4ng tin ng\u01b0\u1eddi v\u1eeba t\u1eeb tr\u1ea7n"),e.qZA(),e.TgZ(34,"div",5)(35,"div",4)(36,"mat-form-field",6)(37,"mat-label"),e._uU(38,"H\u1ecd v\xe0 t\xean"),e.qZA(),e.TgZ(39,"input",11),e.NdJ("ngModelChange",function(i){return a.calculatedTuanCuu.details.name=i}),e.qZA()()(),e.TgZ(40,"div",4)(41,"mat-form-field",6)(42,"mat-label"),e._uU(43,"Tu\u1ed5i"),e.qZA(),e.TgZ(44,"input",12),e.NdJ("ngModelChange",function(i){return a.calculatedTuanCuu.details.age=i}),e.qZA()()(),e.TgZ(45,"div",4)(46,"mat-label"),e._uU(47,"Gi\u1edbi t\xednh"),e.qZA(),e.TgZ(48,"div")(49,"mat-radio-group",7),e.NdJ("ngModelChange",function(i){return a.calculatedTuanCuu.details.sex=i}),e.TgZ(50,"mat-radio-button",13),e._uU(51,"Nam"),e.qZA(),e.TgZ(52,"mat-radio-button",13),e._uU(53,"N\u1eef"),e.qZA()()()()()()(),e.TgZ(54,"div",14),e.YNc(55,we,2,2,"button",15),e.TgZ(56,"button",16),e.NdJ("click",function(){return a.calculateTuanCuu()}),e._uU(57," T\xednh to\xe1n "),e.qZA()(),e.YNc(58,Fe,16,3,"div",17),e.qZA(),e.YNc(59,Ke,22,9,"mat-tab",18),e.qZA()(),e.YNc(60,Ge,10,3,"ng-template",null,19,e.W1O)),2&t&&(e.xp6(3),e.Q6J("selectedIndex",a.selectedIndex),e.xp6(10),e.Q6J("ngModel",a.selectedDate.year),e.xp6(1),e.Q6J("ngForOf",a.yearOptions),e.xp6(5),e.Q6J("ngModel",a.selectedDate.month),e.xp6(1),e.Q6J("ngForOf",a.monthOptions),e.xp6(5),e.Q6J("ngModel",a.selectedDate.date),e.xp6(1),e.Q6J("ngForOf",a.dayOptions),e.xp6(2),e.Q6J("expanded",!1),e.xp6(11),e.Q6J("ngModel",a.calculatedTuanCuu.details.name),e.xp6(5),e.Q6J("ngModel",a.calculatedTuanCuu.details.age),e.xp6(5),e.Q6J("ngModel",a.calculatedTuanCuu.details.sex),e.xp6(1),e.Q6J("value","Nam"),e.xp6(2),e.Q6J("value","N\u1eef"),e.xp6(3),e.Q6J("ngIf",a.tuanCuuEvents.length>0),e.xp6(1),e.Q6J("color","primary"),e.xp6(2),e.Q6J("ngIf",a.tuanCuuEvents.length>0),e.xp6(1),e.Q6J("ngForOf",a.tuanCuuList))},dependencies:[m.sg,m.O5,D.lW,D.RK,b.Hw,N.KE,N.hX,A.d,S.gD,x.ey,C.i$,C.Tg,g.ZT,g.uh,g.xY,g.H8,f.Fj,f.wV,f.JJ,f.Q7,f.On,L.uX,L.SP,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk,H.Nt,y.pp,y.ib,y.yz,y.yK,Y.VQ,Y.U0,Z.VK,Z.OP,Z.p6,Te.C,m.JJ,m.uU],styles:[".tuan-cuu-container .tuan-cuu-title{margin:2rem 0}  .tuan-cuu-container .mat-tab-body-content,   .tuan-cuu-container .mat-mdc-tab-body-content{padding:1rem .5rem}  .tuan-cuu-container .form-group{padding:0 1rem}@media only screen and (max-width: 600px){  .tuan-cuu-container .form-group{width:100%}}  .tuan-cuu-container .button-calc{margin:2rem 0}  .tuan-cuu-container .button-calc button{margin-left:1rem}  .qr-area{margin-bottom:1rem}  .tuan-cuu .mdc-list-item.mdc-list-item--with-one-line{height:auto}  .tuan-cuu-e{padding-bottom:1rem}  .tuan-cuu-e button{margin-left:1rem}  .tuan-cuu-e mat-divider{margin-top:1rem}"]}),n})();const je=[{path:"",children:[{path:"",component:ve},{path:"tinh-tuan-cuu",component:B},{path:"tinh-tuan-cuu/:token",component:B}]}];let Ve=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[T.Bz.forChild(je),T.Bz]}),n})();var Xe=r(782),We=r(7009),et=r(4614);let tt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[m.uU,m.JJ],imports:[m.ez,Ve,O.g0,D.ot,b.Ps,N.lN,A.t,S.LD,Xe.N6,k.QW,D.ot,C.ie,x.si,I.AV,g.Is,f.u5,L.Nh,v.p0,H.c,y.To,Y.Fk,Z.Tx,We.ZX,et.S]}),n})()}}]);